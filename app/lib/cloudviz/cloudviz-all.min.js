/*
 * ************************************************************************
 *
 *  ADOBE CONFIDENTIAL
 *  ___________________
 *
 *   (c) Copyright 2013 Adobe Systems, Inc.
 *   All Rights Reserved.
 *
 *  NOTICE:  All information contained herein is, and remains
 *  the property of Adobe Systems Incorporated and its suppliers,
 *  if any.  The intellectual and technical concepts contained
 *  herein are proprietary to Adobe Systems Incorporated and its
 *  suppliers and may be covered by U.S. and Foreign Patents,
 *  patents in process, and are protected by trade secret or copyright law.
 *  Dissemination of this information or reproduction of this material
 *  is strictly forbidden unless prior written permission is obtained
 *  from Adobe Systems Incorporated.
 * ************************************************************************
 */

/*
 * CloudViz - v2.5.3 - 2013-11-25
 * Copyright (c) 2013 Adobe Systems, Inc. All Rights Reserved.
 */

d3=function(){function t(t){return null!=t&&!isNaN(t)}function e(t){return t.length}function n(t){for(var e=1;t*e%1;)e*=10;return e}function i(t,e){try{for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}catch(i){t.prototype=e}}function r(){}function a(){}function o(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function s(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.substring(1);for(var n=0,i=hs.length;i>n;++n){var r=hs[n]+e;if(r in t)return r}}function l(){}function u(){}function c(t){function e(){for(var e,i=n,r=-1,a=i.length;a>++r;)(e=i[r].on)&&e.apply(this,arguments);return t}var n=[],i=new r;return e.on=function(e,r){var a,o=i.get(e);return 2>arguments.length?o&&o.on:(o&&(o.on=null,n=n.slice(0,a=n.indexOf(o)).concat(n.slice(a+1)),i.remove(e)),r&&n.push(i.set(e,{on:r})),t)},e}function h(){Xo.event.preventDefault()}function d(){for(var t,e=Xo.event;t=e.sourceEvent;)e=t;return e}function p(t){for(var e=new u,n=0,i=arguments.length;i>++n;)e[arguments[n]]=c(e);return e.of=function(n,i){return function(r){try{var a=r.sourceEvent=Xo.event;r.target=t,Xo.event=r,e[r.type].apply(n,i)}finally{Xo.event=a}}},e}function f(t){return ps(t,_s),t}function g(t){return"function"==typeof t?t:function(){return fs(t,this)}}function m(t){return"function"==typeof t?t:function(){return gs(t,this)}}function v(t,e){function n(){this.removeAttribute(t)}function i(){this.removeAttributeNS(t.space,t.local)}function r(){this.setAttribute(t,e)}function a(){this.setAttributeNS(t.space,t.local,e)}function o(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function s(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=Xo.ns.qualify(t),null==e?t.local?i:n:"function"==typeof e?t.local?s:o:t.local?a:r}function _(t){return t.trim().replace(/\s+/g," ")}function y(t){return RegExp("(?:^|\\s+)"+Xo.requote(t)+"(?:\\s+|$)","g")}function x(t,e){function n(){for(var n=-1;r>++n;)t[n](this,e)}function i(){for(var n=-1,i=e.apply(this,arguments);r>++n;)t[n](this,i)}t=t.trim().split(/\s+/).map(b);var r=t.length;return"function"==typeof e?i:n}function b(t){var e=y(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(r)||n.setAttribute("class",_(r+" "+t))):n.setAttribute("class",_(r.replace(e," ")))}}function A(t,e,n){function i(){this.style.removeProperty(t)}function r(){this.style.setProperty(t,e,n)}function a(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}return null==e?i:"function"==typeof e?a:r}function k(t,e){function n(){delete this[t]}function i(){this[t]=e}function r(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?r:i}function P(t){return"function"==typeof t?t:(t=Xo.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,t)}}function S(t){return{__data__:t}}function w(t){return function(){return vs(this,t)}}function M(t){return arguments.length||(t=Xo.ascending),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function T(t,e){for(var n=0,i=t.length;i>n;n++)for(var r,a=t[n],o=0,s=a.length;s>o;o++)(r=a[o])&&e(r,o,n);return t}function O(t){return ps(t,xs),t}function E(t){var e,n;return function(i,r,a){var o,s=t[a].update,l=s.length;for(a!=n&&(n=a,e=0),r>=e&&(e=r+1);!(o=s[e])&&l>++e;);return o}}function D(){var t=this.__transition__;t&&++t.active}function L(t,e,n){function i(){var e=this[o];e&&(this.removeEventListener(t,e,e.$),delete this[o])}function r(){var r=u(e,Zo(arguments));i.call(this),this.addEventListener(t,this[o]=r,r.$=n),r._=e}function a(){var e,n=RegExp("^__on([^.]+)"+Xo.requote(t)+"$");for(var i in this)if(e=i.match(n)){var r=this[i];this.removeEventListener(e[1],r,r.$),delete this[i]}}var o="__on"+t,s=t.indexOf("."),u=F;s>0&&(t=t.substring(0,s));var c=As.get(t);return c&&(t=c,u=z),s?e?r:i:e?l:a}function F(t,e){return function(n){var i=Xo.event;Xo.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{Xo.event=i}}}function z(t,e){var n=F(t,e);return function(t){var e=this,i=t.relatedTarget;i&&(i===e||8&i.compareDocumentPosition(e))||n.call(e,t)}}function V(){var t=".dragsuppress-"+ ++Ps,e="click"+t,n=Xo.select(Qo).on("touchmove"+t,h).on("dragstart"+t,h).on("selectstart"+t,h);if(ks){var i=$o.style,r=i[ks];i[ks]="none"}return function(a){function o(){n.on(e,null)}n.on(t,null),ks&&(i[ks]=r),a&&(n.on(e,function(){h(),o()},!0),setTimeout(o,0))}}function C(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();if(0>Ss&&(Qo.scrollX||Qo.scrollY)){n=Xo.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var r=n[0][0].getScreenCTM();Ss=!(r.f||r.e),n.remove()}return Ss?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}function N(t){return t>0?1:0>t?-1:0}function R(t){return t>1?0:-1>t?ws:Math.acos(t)}function I(t){return t>1?Ts:-1>t?-Ts:Math.asin(t)}function B(t){return((t=Math.exp(t))-1/t)/2}function G(t){return((t=Math.exp(t))+1/t)/2}function H(t){return((t=Math.exp(2*t))-1)/(t+1)}function j(t){return(t=Math.sin(t/2))*t}function q(){}function Y(t,e,n){return new W(t,e,n)}function W(t,e,n){this.h=t,this.s=e,this.l=n}function U(t,e,n){function i(t){return t>360?t-=360:0>t&&(t+=360),60>t?a+(o-a)*t/60:180>t?o:240>t?a+(o-a)*(240-t)/60:a}function r(t){return Math.round(255*i(t))}var a,o;return t=isNaN(t)?0:0>(t%=360)?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,n=0>n?0:n>1?1:n,o=.5>=n?n*(1+e):n+e-n*e,a=2*n-o,oe(r(t+120),r(t),r(t-120))}function X(t,e,n){return new J(t,e,n)}function J(t,e,n){this.h=t,this.c=e,this.l=n}function Z(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),K(n,Math.cos(t*=Ds)*e,Math.sin(t)*e)}function K(t,e,n){return new $(t,e,n)}function $(t,e,n){this.l=t,this.a=e,this.b=n}function Q(t,e,n){var i=(t+16)/116,r=i+e/500,a=i-n/200;return r=ee(r)*Hs,i=ee(i)*js,a=ee(a)*qs,oe(ie(3.2404542*r-1.5371385*i-.4985314*a),ie(-.969266*r+1.8760108*i+.041556*a),ie(.0556434*r-.2040259*i+1.0572252*a))}function te(t,e,n){return t>0?X(Math.atan2(n,e)*Ls,Math.sqrt(e*e+n*n),t):X(0/0,0/0,t)}function ee(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function ne(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function ie(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function re(t){return oe(t>>16,255&t>>8,255&t)}function ae(t){return re(t)+""}function oe(t,e,n){return new se(t,e,n)}function se(t,e,n){this.r=t,this.g=e,this.b=n}function le(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function ue(t,e,n){var i,r,a,o=0,s=0,l=0;if(i=/([a-z]+)\((.*)\)/i.exec(t))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(pe(r[0]),pe(r[1]),pe(r[2]))}return(a=Us.get(t))?e(a.r,a.g,a.b):(null!=t&&"#"===t.charAt(0)&&(4===t.length?(o=t.charAt(1),o+=o,s=t.charAt(2),s+=s,l=t.charAt(3),l+=l):7===t.length&&(o=t.substring(1,3),s=t.substring(3,5),l=t.substring(5,7)),o=parseInt(o,16),s=parseInt(s,16),l=parseInt(l,16)),e(o,s,l))}function ce(t,e,n){var i,r,a=Math.min(t/=255,e/=255,n/=255),o=Math.max(t,e,n),s=o-a,l=(o+a)/2;return s?(r=.5>l?s/(o+a):s/(2-o-a),i=t==o?(e-n)/s+(n>e?6:0):e==o?(n-t)/s+2:(t-e)/s+4,i*=60):(i=0/0,r=l>0&&1>l?0:i),Y(i,r,l)}function he(t,e,n){t=de(t),e=de(e),n=de(n);var i=ne((.4124564*t+.3575761*e+.1804375*n)/Hs),r=ne((.2126729*t+.7151522*e+.072175*n)/js),a=ne((.0193339*t+.119192*e+.9503041*n)/qs);return K(116*r-16,500*(i-r),200*(r-a))}function de(t){return.04045>=(t/=255)?t/12.92:Math.pow((t+.055)/1.055,2.4)}function pe(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function fe(t){return"function"==typeof t?t:function(){return t}}function ge(t){return t}function me(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),ve(e,n,t,i)}}function ve(t,e,n,i){function r(){var t,e=l.status;if(!e&&l.responseText||e>=200&&300>e||304===e){try{t=n.call(a,l)}catch(i){return o.error.call(a,i),void 0}o.load.call(a,t)}else o.error.call(a,l)}var a={},o=Xo.dispatch("beforesend","progress","load","error"),s={},l=new XMLHttpRequest,u=null;return!Qo.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(t)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=r:l.onreadystatechange=function(){l.readyState>3&&r()},l.onprogress=function(t){var e=Xo.event;Xo.event=t;try{o.progress.call(a,l)}finally{Xo.event=e}},a.header=function(t,e){return t=(t+"").toLowerCase(),2>arguments.length?s[t]:(null==e?delete s[t]:s[t]=e+"",a)},a.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",a):e},a.responseType=function(t){return arguments.length?(u=t,a):u},a.response=function(t){return n=t,a},["get","post"].forEach(function(t){a[t]=function(){return a.send.apply(a,[t].concat(Zo(arguments)))}}),a.send=function(n,i,r){if(2===arguments.length&&"function"==typeof i&&(r=i,i=null),l.open(n,t,!0),null==e||"accept"in s||(s.accept=e+",*/*"),l.setRequestHeader)for(var c in s)l.setRequestHeader(c,s[c]);return null!=e&&l.overrideMimeType&&l.overrideMimeType(e),null!=u&&(l.responseType=u),null!=r&&a.on("error",r).on("load",function(t){r(null,t)}),o.beforesend.call(a,l),l.send(null==i?null:i),a},a.abort=function(){return l.abort(),a},Xo.rebind(a,o,"on"),null==i?a:a.get(_e(i))}function _e(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function ye(){var t=xe(),e=be()-t;e>24?(isFinite(e)&&(clearTimeout(Ks),Ks=setTimeout(ye,e)),Zs=0):(Zs=1,Qs(ye))}function xe(){var t=Date.now();for($s=Xs;$s;)t>=$s.t&&($s.f=$s.c(t-$s.t)),$s=$s.n;return t}function be(){for(var t,e=Xs,n=1/0;e;)e.f?e=t?t.n=e.n:Xs=e.n:(n>e.t&&(n=e.t),e=(t=e).n);return Js=t,n}function Ae(t,e){var n=Math.pow(10,3*ls(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function ke(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function Pe(t){return t+""}function Se(){}function we(t,e,n){var i=n.s=t+e,r=i-t,a=i-r;n.t=t-a+(e-r)}function Me(t,e){t&&hl.hasOwnProperty(t.type)&&hl[t.type](t,e)}function Te(t,e,n){var i,r=-1,a=t.length-n;for(e.lineStart();a>++r;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function Oe(t,e){var n=-1,i=t.length;for(e.polygonStart();i>++n;)Te(t[n],e,1);e.polygonEnd()}function Ee(){function t(t,e){t*=Ds,e=e*Ds/2+ws/4;var n=t-i,o=Math.cos(e),s=Math.sin(e),l=a*s,u=r*o+l*Math.cos(n),c=l*Math.sin(n);pl.add(Math.atan2(c,u)),i=t,r=o,a=s}var e,n,i,r,a;fl.point=function(o,s){fl.point=t,i=(e=o)*Ds,r=Math.cos(s=(n=s)*Ds/2+ws/4),a=Math.sin(s)},fl.lineEnd=function(){t(e,n)}}function De(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function Le(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Fe(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ze(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ve(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Ce(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Ne(t){return[Math.atan2(t[1],t[0]),I(t[2])]}function Re(t,e){return Os>ls(t[0]-e[0])&&Os>ls(t[1]-e[1])}function Ie(t,e){t*=Ds;var n=Math.cos(e*=Ds);Be(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function Be(t,e,n){++gl,vl+=(t-vl)/gl,_l+=(e-_l)/gl,yl+=(n-yl)/gl}function Ge(){function t(t,r){t*=Ds;var a=Math.cos(r*=Ds),o=a*Math.cos(t),s=a*Math.sin(t),l=Math.sin(r),u=Math.atan2(Math.sqrt((u=n*l-i*s)*u+(u=i*o-e*l)*u+(u=e*s-n*o)*u),e*o+n*s+i*l);ml+=u,xl+=u*(e+(e=o)),bl+=u*(n+(n=s)),Al+=u*(i+(i=l)),Be(e,n,i)}var e,n,i;wl.point=function(r,a){r*=Ds;var o=Math.cos(a*=Ds);e=o*Math.cos(r),n=o*Math.sin(r),i=Math.sin(a),wl.point=t,Be(e,n,i)}}function He(){wl.point=Ie}function je(){function t(t,e){t*=Ds;var n=Math.cos(e*=Ds),o=n*Math.cos(t),s=n*Math.sin(t),l=Math.sin(e),u=r*l-a*s,c=a*o-i*l,h=i*s-r*o,d=Math.sqrt(u*u+c*c+h*h),p=i*o+r*s+a*l,f=d&&-R(p)/d,g=Math.atan2(d,p);kl+=f*u,Pl+=f*c,Sl+=f*h,ml+=g,xl+=g*(i+(i=o)),bl+=g*(r+(r=s)),Al+=g*(a+(a=l)),Be(i,r,a)}var e,n,i,r,a;wl.point=function(o,s){e=o,n=s,wl.point=t,o*=Ds;var l=Math.cos(s*=Ds);i=l*Math.cos(o),r=l*Math.sin(o),a=Math.sin(s),Be(i,r,a)},wl.lineEnd=function(){t(e,n),wl.lineEnd=He,wl.point=Ie}}function qe(){return!0}function Ye(t,e,n,i,r){var a=[],o=[];if(t.forEach(function(t){if(!(0>=(e=t.length-1))){var e,n=t[0],i=t[e];if(Re(n,i)){r.lineStart();for(var s=0;e>s;++s)r.point((n=t[s])[0],n[1]);return r.lineEnd(),void 0}var l=new Ue(n,t,null,!0),u=new Ue(n,null,l,!1);l.o=u,a.push(l),o.push(u),l=new Ue(i,t,null,!1),u=new Ue(i,null,l,!0),l.o=u,a.push(l),o.push(u)}}),o.sort(e),We(a),We(o),a.length){for(var s=0,l=n,u=o.length;u>s;++s)o[s].e=l=!l;for(var c,h,d=a[0];;){for(var p=d,f=!0;p.v;)if((p=p.n)===d)return;c=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(var s=0,u=c.length;u>s;++s)r.point((h=c[s])[0],h[1]);else i(p.x,p.n.x,1,r);p=p.n}else{if(f){c=p.p.z;for(var s=c.length-1;s>=0;--s)r.point((h=c[s])[0],h[1])}else i(p.x,p.p.x,-1,r);p=p.p}p=p.o,c=p.z,f=!f}while(!p.v);r.lineEnd()}}}function We(t){if(e=t.length){for(var e,n,i=0,r=t[0];e>++i;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function Ue(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Xe(t,e,n,i){return function(r,a){function o(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&a.point(e,n)}function s(t,e){var n=r(t,e);m.point(n[0],n[1])}function l(){_.point=s,m.lineStart()}function u(){_.point=o,m.lineEnd()}function c(t,e){g.push([t,e]);var n=r(t,e);x.point(n[0],n[1])}function h(){x.lineStart(),g=[]}function d(){c(g[0][0],g[0][1]),x.lineEnd();var t,e=x.clean(),n=y.buffer(),i=n.length;if(g.pop(),f.push(g),g=null,i){if(1&e){t=n[0];var r,i=t.length-1,o=-1;for(a.lineStart();i>++o;)a.point((r=t[o])[0],r[1]);return a.lineEnd(),void 0}i>1&&2&e&&n.push(n.pop().concat(n.shift())),p.push(n.filter(Je))}}var p,f,g,m=e(a),v=r.invert(i[0],i[1]),_={point:o,lineStart:l,lineEnd:u,polygonStart:function(){_.point=c,_.lineStart=h,_.lineEnd=d,p=[],f=[],a.polygonStart()},polygonEnd:function(){_.point=o,_.lineStart=l,_.lineEnd=u,p=Xo.merge(p);var t=$e(v,f);p.length?Ye(p,Ke,t,n,a):t&&(a.lineStart(),n(null,null,1,a),a.lineEnd()),a.polygonEnd(),p=f=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}},y=Ze(),x=e(y);return _}}function Je(t){return t.length>1}function Ze(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:l,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Ke(t,e){return(0>(t=t.x)[0]?t[1]-Ts-Os:Ts-t[1])-(0>(e=e.x)[0]?e[1]-Ts-Os:Ts-e[1])}function $e(t,e){var n=t[0],i=t[1],r=[Math.sin(n),-Math.cos(n),0],a=0,o=0;pl.reset();for(var s=0,l=e.length;l>s;++s){var u=e[s],c=u.length;if(c)for(var h=u[0],d=h[0],p=h[1]/2+ws/4,f=Math.sin(p),g=Math.cos(p),m=1;;){m===c&&(m=0),t=u[m];var v=t[0],_=t[1]/2+ws/4,y=Math.sin(_),x=Math.cos(_),b=v-d,A=ls(b)>ws,k=f*y;if(pl.add(Math.atan2(k*Math.sin(b),g*x+k*Math.cos(b))),a+=A?b+(b>=0?Ms:-Ms):b,A^d>=n^v>=n){var P=Fe(De(h),De(t));Ce(P);var S=Fe(r,P);Ce(S);var w=(A^b>=0?-1:1)*I(S[2]);(i>w||i===w&&(P[0]||P[1]))&&(o+=A^b>=0?1:-1)}if(!m++)break;d=v,f=y,g=x,h=t}}return(-Os>a||Os>a&&0>pl)^1&o}function Qe(t){var e,n=0/0,i=0/0,r=0/0;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?ws:-ws,l=ls(a-n);Os>ls(l-ws)?(t.point(n,i=(i+o)/2>0?Ts:-Ts),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),t.point(a,i),e=0):r!==s&&l>=ws&&(Os>ls(n-r)&&(n-=r*Os),Os>ls(a-s)&&(a-=s*Os),i=tn(n,i,a,o),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),e=0),t.point(n=a,i=o),r=s},lineEnd:function(){t.lineEnd(),n=i=0/0},clean:function(){return 2-e}}}function tn(t,e,n,i){var r,a,o=Math.sin(t-n);return ls(o)>Os?Math.atan((Math.sin(e)*(a=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*a*o)):(e+i)/2}function en(t,e,n,i){var r;if(null==t)r=n*Ts,i.point(-ws,r),i.point(0,r),i.point(ws,r),i.point(ws,0),i.point(ws,-r),i.point(0,-r),i.point(-ws,-r),i.point(-ws,0),i.point(-ws,r);else if(ls(t[0]-e[0])>Os){var a=t[0]<e[0]?ws:-ws;r=n*a/2,i.point(-a,r),i.point(0,r),i.point(a,r)}else i.point(e[0],e[1])}function nn(t){function e(t,e){return Math.cos(t)*Math.cos(e)>a}function n(t){var n,a,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,d){var p,f=[h,d],g=e(h,d),m=o?g?0:r(h,d):g?r(h+(0>h?ws:-ws),d):0;if(!n&&(u=l=g)&&t.lineStart(),g!==l&&(p=i(n,f),(Re(n,p)||Re(f,p))&&(f[0]+=Os,f[1]+=Os,g=e(f[0],f[1]))),g!==l)c=0,g?(t.lineStart(),p=i(f,n),t.point(p[0],p[1])):(p=i(n,f),t.point(p[0],p[1]),t.lineEnd()),n=p;else if(s&&n&&o^g){var v;m&a||!(v=i(f,n,!0))||(c=0,o?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!g||n&&Re(n,f)||t.point(f[0],f[1]),n=f,l=g,a=m},lineEnd:function(){l&&t.lineEnd(),n=null},clean:function(){return c|(u&&l)<<1}}}function i(t,e,n){var i=De(t),r=De(e),o=[1,0,0],s=Fe(i,r),l=Le(s,s),u=s[0],c=l-u*u;if(!c)return!n&&t;var h=a*l/c,d=-a*u/c,p=Fe(o,s),f=Ve(o,h),g=Ve(s,d);ze(f,g);var m=p,v=Le(f,m),_=Le(m,m),y=v*v-_*(Le(f,f)-1);if(!(0>y)){var x=Math.sqrt(y),b=Ve(m,(-v-x)/_);if(ze(b,f),b=Ne(b),!n)return b;var A,k=t[0],P=e[0],S=t[1],w=e[1];k>P&&(A=k,k=P,P=A);var M=P-k,T=Os>ls(M-ws),O=T||Os>M;if(!T&&S>w&&(A=S,S=w,w=A),O?T?S+w>0^b[1]<(Os>ls(b[0]-k)?S:w):b[1]>=S&&w>=b[1]:M>ws^(b[0]>=k&&P>=b[0])){var E=Ve(m,(-v+x)/_);return ze(E,f),[b,Ne(E)]}}}function r(e,n){var i=o?t:ws-t,r=0;return-i>e?r|=1:e>i&&(r|=2),-i>n?r|=4:n>i&&(r|=8),r}var a=Math.cos(t),o=a>0,s=ls(a)>Os,l=Dn(t,6*Ds);return Xe(e,n,l,o?[0,-t]:[-ws,t-ws])}function rn(t,e,n,i){return function(r){var a,o=r.a,s=r.b,l=o.x,u=o.y,c=s.x,h=s.y,d=0,p=1,f=c-l,g=h-u;if(a=t-l,f||!(a>0)){if(a/=f,0>f){if(d>a)return;p>a&&(p=a)}else if(f>0){if(a>p)return;a>d&&(d=a)}if(a=n-l,f||!(0>a)){if(a/=f,0>f){if(a>p)return;a>d&&(d=a)}else if(f>0){if(d>a)return;p>a&&(p=a)}if(a=e-u,g||!(a>0)){if(a/=g,0>g){if(d>a)return;p>a&&(p=a)}else if(g>0){if(a>p)return;a>d&&(d=a)}if(a=i-u,g||!(0>a)){if(a/=g,0>g){if(a>p)return;a>d&&(d=a)}else if(g>0){if(d>a)return;p>a&&(p=a)}return d>0&&(r.a={x:l+d*f,y:u+d*g}),1>p&&(r.b={x:l+p*f,y:u+p*g}),r}}}}}}function an(t,e,n,i){function r(i,r){return Os>ls(i[0]-t)?r>0?0:3:Os>ls(i[0]-n)?r>0?2:1:Os>ls(i[1]-e)?r>0?1:0:r>0?3:2}function a(t,e){return o(t.x,e.x)}function o(t,e){var n=r(t,1),i=r(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){function l(t){for(var e=0,n=v.length,i=t[1],r=0;n>r;++r)for(var a,o=1,s=v[r],l=s.length,c=s[0];l>o;++o)a=s[o],i>=c[1]?a[1]>i&&u(c,a,t)>0&&++e:i>=a[1]&&0>u(c,a,t)&&--e,c=a;return 0!==e}function u(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function c(a,s,l,u){var c=0,h=0;if(null==a||(c=r(a,l))!==(h=r(s,l))||0>o(a,s)^l>0){do u.point(0===c||3===c?t:n,c>1?i:e);while((c=(c+l+4)%4)!==h)}else u.point(s[0],s[1])}function h(r,a){return r>=t&&n>=r&&a>=e&&i>=a}function d(t,e){h(t,e)&&s.point(t,e)}function p(){E.point=g,v&&v.push(_=[]),S=!0,P=!1,A=k=0/0}function f(){m&&(g(y,x),b&&P&&T.rejoin(),m.push(T.buffer())),E.point=d,P&&s.lineEnd()}function g(t,e){t=Math.max(-Tl,Math.min(Tl,t)),e=Math.max(-Tl,Math.min(Tl,e));var n=h(t,e);if(v&&_.push([t,e]),S)y=t,x=e,b=n,S=!1,n&&(s.lineStart(),s.point(t,e));else if(n&&P)s.point(t,e);else{var i={a:{x:A,y:k},b:{x:t,y:e}};O(i)?(P||(s.lineStart(),s.point(i.a.x,i.a.y)),s.point(i.b.x,i.b.y),n||s.lineEnd(),w=!1):n&&(s.lineStart(),s.point(t,e),w=!1)}A=t,k=e,P=n}var m,v,_,y,x,b,A,k,P,S,w,M=s,T=Ze(),O=rn(t,e,n,i),E={point:d,lineStart:p,lineEnd:f,polygonStart:function(){s=T,m=[],v=[],w=!0},polygonEnd:function(){s=M,m=Xo.merge(m);var e=l([t,i]),n=w&&e,r=m.length;(n||r)&&(s.polygonStart(),n&&(s.lineStart(),c(null,null,1,s),s.lineEnd()),r&&Ye(m,a,e,c,s),s.polygonEnd()),m=v=_=null}};return E}}function on(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),n}function sn(t){var e=0,n=ws/3,i=kn(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*ws/180,n=t[1]*ws/180):[180*(e/ws),180*(n/ws)]},r}function ln(t,e){function n(t,e){var n=Math.sqrt(a-2*r*Math.sin(e))/r;return[n*Math.sin(t*=r),o-n*Math.cos(t)]}var i=Math.sin(t),r=(i+Math.sin(e))/2,a=1+i*(2*r-i),o=Math.sqrt(a)/r;return n.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/r,I((a-(t*t+n*n)*r*r)/(2*r))]},n}function un(){function t(t,e){El+=r*t-i*e,i=t,r=e}var e,n,i,r;Vl.point=function(a,o){Vl.point=t,e=i=a,n=r=o},Vl.lineEnd=function(){t(e,n)}}function cn(t,e){Dl>t&&(Dl=t),t>Fl&&(Fl=t),Ll>e&&(Ll=e),e>zl&&(zl=e)}function hn(){function t(t,e){o.push("M",t,",",e,a)}function e(t,e){o.push("M",t,",",e),s.point=n}function n(t,e){o.push("L",t,",",e)}function i(){s.point=t}function r(){o.push("Z")}var a=dn(4.5),o=[],s={point:t,lineStart:function(){s.point=e},lineEnd:i,polygonStart:function(){s.lineEnd=r},polygonEnd:function(){s.lineEnd=i,s.point=t},pointRadius:function(t){return a=dn(t),s},result:function(){if(o.length){var t=o.join("");return o=[],t}}};return s}function dn(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function pn(t,e){vl+=t,_l+=e,++yl}function fn(){function t(t,i){var r=t-e,a=i-n,o=Math.sqrt(r*r+a*a);xl+=o*(e+t)/2,bl+=o*(n+i)/2,Al+=o,pn(e=t,n=i)}var e,n;Nl.point=function(i,r){Nl.point=t,pn(e=i,n=r)}}function gn(){Nl.point=pn}function mn(){function t(t,e){var n=t-i,a=e-r,o=Math.sqrt(n*n+a*a);xl+=o*(i+t)/2,bl+=o*(r+e)/2,Al+=o,o=r*t-i*e,kl+=o*(i+t),Pl+=o*(r+e),Sl+=3*o,pn(i=t,r=e)}var e,n,i,r;Nl.point=function(a,o){Nl.point=t,pn(e=i=a,n=r=o)},Nl.lineEnd=function(){t(e,n)}}function vn(t){function e(e,n){t.moveTo(e,n),t.arc(e,n,o,0,Ms)}function n(e,n){t.moveTo(e,n),s.point=i}function i(e,n){t.lineTo(e,n)}function r(){s.point=e}function a(){t.closePath()}var o=4.5,s={point:e,lineStart:function(){s.point=n},lineEnd:r,polygonStart:function(){s.lineEnd=a},polygonEnd:function(){s.lineEnd=r,s.point=e},pointRadius:function(t){return o=t,s},result:l};return s}function _n(t){function e(t){return(s?i:n)(t)}function n(e){return bn(e,function(n,i){n=t(n,i),e.point(n[0],n[1])})}function i(e){function n(n,i){n=t(n,i),e.point(n[0],n[1])}function i(){y=0/0,P.point=a,e.lineStart()}function a(n,i){var a=De([n,i]),o=t(n,i);r(y,x,_,b,A,k,y=o[0],x=o[1],_=n,b=a[0],A=a[1],k=a[2],s,e),e.point(y,x)}function o(){P.point=n,e.lineEnd()}function l(){i(),P.point=u,P.lineEnd=c}function u(t,e){a(h=t,d=e),p=y,f=x,g=b,m=A,v=k,P.point=a}function c(){r(y,x,_,b,A,k,p,f,h,g,m,v,s,e),P.lineEnd=o,o()}var h,d,p,f,g,m,v,_,y,x,b,A,k,P={point:n,lineStart:i,lineEnd:o,polygonStart:function(){e.polygonStart(),P.lineStart=l},polygonEnd:function(){e.polygonEnd(),P.lineStart=i}};return P}function r(e,n,i,s,l,u,c,h,d,p,f,g,m,v){var _=c-e,y=h-n,x=_*_+y*y;if(x>4*a&&m--){var b=s+p,A=l+f,k=u+g,P=Math.sqrt(b*b+A*A+k*k),S=Math.asin(k/=P),w=Os>ls(ls(k)-1)?(i+d)/2:Math.atan2(A,b),M=t(w,S),T=M[0],O=M[1],E=T-e,D=O-n,L=y*E-_*D;(L*L/x>a||ls((_*E+y*D)/x-.5)>.3||o>s*p+l*f+u*g)&&(r(e,n,i,s,l,u,T,O,w,b/=P,A/=P,k,m,v),v.point(T,O),r(T,O,w,b,A,k,c,h,d,p,f,g,m,v))}}var a=.5,o=Math.cos(30*Ds),s=16;return e.precision=function(t){return arguments.length?(s=(a=t*t)>0&&16,e):Math.sqrt(a)},e}function yn(t){var e=_n(function(e,n){return t([e*Ls,n*Ls])});return function(t){return Pn(e(t))}}function xn(t){this.stream=t}function bn(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function An(t){return kn(function(){return t})()}function kn(t){function e(t){return t=s(t[0]*Ds,t[1]*Ds),[t[0]*d+l,u-t[1]*d]}function n(t){return t=s.invert((t[0]-l)/d,(u-t[1])/d),t&&[t[0]*Ls,t[1]*Ls]}function i(){s=on(o=Mn(v,_,y),a);var t=a(g,m);return l=p-t[0]*d,u=f+t[1]*d,r()}function r(){return c&&(c.valid=!1,c=null),e}var a,o,s,l,u,c,h=_n(function(t,e){return t=a(t,e),[t[0]*d+l,u-t[1]*d]}),d=150,p=480,f=250,g=0,m=0,v=0,_=0,y=0,x=Ml,b=ge,A=null,k=null;return e.stream=function(t){return c&&(c.valid=!1),c=Pn(x(o,h(b(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(x=null==t?(A=t,Ml):nn((A=+t)*Ds),r()):A},e.clipExtent=function(t){return arguments.length?(k=t,b=t?an(t[0][0],t[0][1],t[1][0],t[1][1]):ge,r()):k},e.scale=function(t){return arguments.length?(d=+t,i()):d},e.translate=function(t){return arguments.length?(p=+t[0],f=+t[1],i()):[p,f]},e.center=function(t){return arguments.length?(g=t[0]%360*Ds,m=t[1]%360*Ds,i()):[g*Ls,m*Ls]},e.rotate=function(t){return arguments.length?(v=t[0]%360*Ds,_=t[1]%360*Ds,y=t.length>2?t[2]%360*Ds:0,i()):[v*Ls,_*Ls,y*Ls]},Xo.rebind(e,h,"precision"),function(){return a=t.apply(this,arguments),e.invert=a.invert&&n,i()}}function Pn(t){return bn(t,function(e,n){t.point(e*Ds,n*Ds)})}function Sn(t,e){return[t,e]}function wn(t,e){return[t>ws?t-Ms:-ws>t?t+Ms:t,e]}function Mn(t,e,n){return t?e||n?on(On(t),En(e,n)):On(t):e||n?En(e,n):wn}function Tn(t){return function(e,n){return e+=t,[e>ws?e-Ms:-ws>e?e+Ms:e,n]}}function On(t){var e=Tn(t);return e.invert=Tn(-t),e}function En(t,e){function n(t,e){var n=Math.cos(e),s=Math.cos(t)*n,l=Math.sin(t)*n,u=Math.sin(e),c=u*i+s*r;return[Math.atan2(l*a-c*o,s*i-u*r),I(c*a+l*o)]}var i=Math.cos(t),r=Math.sin(t),a=Math.cos(e),o=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),s=Math.cos(t)*n,l=Math.sin(t)*n,u=Math.sin(e),c=u*a-l*o;return[Math.atan2(l*a+u*o,s*i+c*r),I(c*i-s*r)]},n}function Dn(t,e){var n=Math.cos(t),i=Math.sin(t);return function(r,a,o,s){var l=o*e;null!=r?(r=Ln(n,r),a=Ln(n,a),(o>0?a>r:r>a)&&(r+=o*Ms)):(r=t+o*Ms,a=t-.5*l);for(var u,c=r;o>0?c>a:a>c;c-=l)s.point((u=Ne([n,-i*Math.cos(c),-i*Math.sin(c)]))[0],u[1])}}function Ln(t,e){var n=De(e);n[0]-=t,Ce(n);var i=R(-n[1]);return((0>-n[2]?-i:i)+2*Math.PI-Os)%(2*Math.PI)}function Fn(t,e,n){var i=Xo.range(t,e-Os,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function zn(t,e,n){var i=Xo.range(t,e-Os,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function Vn(t){return t.source}function Cn(t){return t.target}function Nn(t,e,n,i){var r=Math.cos(e),a=Math.sin(e),o=Math.cos(i),s=Math.sin(i),l=r*Math.cos(t),u=r*Math.sin(t),c=o*Math.cos(n),h=o*Math.sin(n),d=2*Math.asin(Math.sqrt(j(i-e)+r*o*j(n-t))),p=1/Math.sin(d),f=d?function(t){var e=Math.sin(t*=d)*p,n=Math.sin(d-t)*p,i=n*l+e*c,r=n*u+e*h,o=n*a+e*s;return[Math.atan2(r,i)*Ls,Math.atan2(o,Math.sqrt(i*i+r*r))*Ls]}:function(){return[t*Ls,e*Ls]};return f.distance=d,f}function Rn(){function t(t,r){var a=Math.sin(r*=Ds),o=Math.cos(r),s=ls((t*=Ds)-e),l=Math.cos(s);Rl+=Math.atan2(Math.sqrt((s=o*Math.sin(s))*s+(s=i*a-n*o*l)*s),n*a+i*o*l),e=t,n=a,i=o}var e,n,i;Il.point=function(r,a){e=r*Ds,n=Math.sin(a*=Ds),i=Math.cos(a),Il.point=t},Il.lineEnd=function(){Il.point=Il.lineEnd=l}}function In(t,e){function n(e,n){var i=Math.cos(e),r=Math.cos(n),a=t(i*r);return[a*r*Math.sin(e),a*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),r=e(i),a=Math.sin(r),o=Math.cos(r);return[Math.atan2(t*a,i*o),Math.asin(i&&n*a/i)]},n}function Bn(t,e){function n(t,e){var n=Os>ls(ls(e)-Ts)?0:o/Math.pow(r(e),a);return[n*Math.sin(a*t),o-n*Math.cos(a*t)]}var i=Math.cos(t),r=function(t){return Math.tan(ws/4+t/2)},a=t===e?Math.sin(t):Math.log(i/Math.cos(e))/Math.log(r(e)/r(t)),o=i*Math.pow(r(t),a)/a;return a?(n.invert=function(t,e){var n=o-e,i=N(a)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/a,2*Math.atan(Math.pow(o/i,1/a))-Ts]},n):Hn}function Gn(t,e){function n(t,e){var n=a-e;return[n*Math.sin(r*t),a-n*Math.cos(r*t)]}var i=Math.cos(t),r=t===e?Math.sin(t):(i-Math.cos(e))/(e-t),a=i/r+t;return Os>ls(r)?Sn:(n.invert=function(t,e){var n=a-e;return[Math.atan2(t,n)/r,a-N(r)*Math.sqrt(t*t+n*n)]},n)}function Hn(t,e){return[t,Math.log(Math.tan(ws/4+e/2))]}function jn(t){var e,n=An(t),i=n.scale,r=n.translate,a=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var o=a.apply(n,arguments);if(o===n){if(e=null==t){var s=ws*i(),l=r();a([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else e&&(o=null);return o},n.clipExtent(null)}function qn(t,e){var n=Math.cos(e)*Math.sin(t);return[Math.log((1+n)/(1-n))/2,Math.atan2(Math.tan(e),Math.cos(t))]}function Yn(t){return t[0]}function Wn(t){return t[1]}function Un(t,e,n,i){var r,a,o,s,l,u,c;return r=i[t],a=r[0],o=r[1],r=i[e],s=r[0],l=r[1],r=i[n],u=r[0],c=r[1],(c-o)*(s-a)-(l-o)*(u-a)>0}function Xn(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function Jn(t,e,n,i){var r=t[0],a=n[0],o=e[0]-r,s=i[0]-a,l=t[1],u=n[1],c=e[1]-l,h=i[1]-u,d=(s*(l-u)-h*(r-a))/(h*o-s*c);return[r+d*o,l+d*c]}function Zn(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function Kn(){_i(this),this.edge=this.site=this.circle=null}function $n(t){var e=Kl.pop()||new Kn;return e.site=t,e}function Qn(t){ui(t),Xl.remove(t),Kl.push(t),_i(t)}function ti(t){var e=t.circle,n=e.x,i=e.cy,r={x:n,y:i},a=t.P,o=t.N,s=[t];Qn(t);for(var l=a;l.circle&&Os>ls(n-l.circle.x)&&Os>ls(i-l.circle.cy);)a=l.P,s.unshift(l),Qn(l),l=a;s.unshift(l),ui(l);for(var u=o;u.circle&&Os>ls(n-u.circle.x)&&Os>ls(i-u.circle.cy);)o=u.N,s.push(u),Qn(u),u=o;s.push(u),ui(u);var c,h=s.length;for(c=1;h>c;++c)u=s[c],l=s[c-1],gi(u.edge,l.site,u.site,r);l=s[0],u=s[h-1],u.edge=pi(l.site,u.site,null,r),li(l),li(u)}function ei(t){for(var e,n,i,r,a=t.x,o=t.y,s=Xl._;s;)if(i=ni(s,o)-a,i>Os)s=s.L;else{if(r=a-ii(s,o),!(r>Os)){i>-Os?(e=s.P,n=s):r>-Os?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}var l=$n(t);if(Xl.insert(e,l),e||n){if(e===n)return ui(e),n=$n(e.site),Xl.insert(l,n),l.edge=n.edge=pi(e.site,l.site),li(e),li(n),void 0;if(!n)return l.edge=pi(e.site,l.site),void 0;ui(e),ui(n);var u=e.site,c=u.x,h=u.y,d=t.x-c,p=t.y-h,f=n.site,g=f.x-c,m=f.y-h,v=2*(d*m-p*g),_=d*d+p*p,y=g*g+m*m,x={x:(m*_-p*y)/v+c,y:(d*y-g*_)/v+h};gi(n.edge,u,f,x),l.edge=pi(u,t,null,x),n.edge=pi(t,f,null,x),li(e),li(n)}}function ni(t,e){var n=t.site,i=n.x,r=n.y,a=r-e;if(!a)return i;var o=t.P;if(!o)return-1/0;n=o.site;var s=n.x,l=n.y,u=l-e;if(!u)return s;var c=s-i,h=1/a-1/u,d=c/u;return h?(-d+Math.sqrt(d*d-2*h*(c*c/(-2*u)-l+u/2+r-a/2)))/h+i:(i+s)/2}function ii(t,e){var n=t.N;if(n)return ni(n,e);var i=t.site;return i.y===e?i.x:1/0}function ri(t){this.site=t,this.edges=[]}function ai(t){for(var e,n,i,r,a,o,s,l,u,c,h=t[0][0],d=t[1][0],p=t[0][1],f=t[1][1],g=Ul,m=g.length;m--;)if(a=g[m],a&&a.prepare())for(s=a.edges,l=s.length,o=0;l>o;)c=s[o].end(),i=c.x,r=c.y,u=s[++o%l].start(),e=u.x,n=u.y,(ls(i-e)>Os||ls(r-n)>Os)&&(s.splice(o,0,new mi(fi(a.site,c,Os>ls(i-h)&&f-r>Os?{x:h,y:Os>ls(e-h)?n:f}:Os>ls(r-f)&&d-i>Os?{x:Os>ls(n-f)?e:d,y:f}:Os>ls(i-d)&&r-p>Os?{x:d,y:Os>ls(e-d)?n:p}:Os>ls(r-p)&&i-h>Os?{x:Os>ls(n-p)?e:h,y:p}:null),a.site,null)),++l)}function oi(t,e){return e.angle-t.angle}function si(){_i(this),this.x=this.y=this.arc=this.site=this.cy=null}function li(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,a=n.site;if(i!==a){var o=r.x,s=r.y,l=i.x-o,u=i.y-s,c=a.x-o,h=a.y-s,d=2*(l*h-u*c);if(!(d>=-Es)){var p=l*l+u*u,f=c*c+h*h,g=(h*p-u*f)/d,m=(l*f-c*p)/d,h=m+s,v=$l.pop()||new si;v.arc=t,v.site=r,v.x=g+o,v.y=h+Math.sqrt(g*g+m*m),v.cy=h,t.circle=v;for(var _=null,y=Zl._;y;)if(v.y<y.y||v.y===y.y&&v.x<=y.x){if(!y.L){_=y.P;break}y=y.L}else{if(!y.R){_=y;break}y=y.R}Zl.insert(_,v),_||(Jl=v)}}}}function ui(t){var e=t.circle;e&&(e.P||(Jl=e.N),Zl.remove(e),$l.push(e),_i(e),t.circle=null)}function ci(t){for(var e,n=Wl,i=rn(t[0][0],t[0][1],t[1][0],t[1][1]),r=n.length;r--;)e=n[r],(!hi(e,t)||!i(e)||Os>ls(e.a.x-e.b.x)&&Os>ls(e.a.y-e.b.y))&&(e.a=e.b=null,n.splice(r,1))}function hi(t,e){var n=t.b;if(n)return!0;var i,r,a=t.a,o=e[0][0],s=e[1][0],l=e[0][1],u=e[1][1],c=t.l,h=t.r,d=c.x,p=c.y,f=h.x,g=h.y,m=(d+f)/2,v=(p+g)/2;
if(g===p){if(o>m||m>=s)return;if(d>f){if(a){if(a.y>=u)return}else a={x:m,y:l};n={x:m,y:u}}else{if(a){if(l>a.y)return}else a={x:m,y:u};n={x:m,y:l}}}else if(i=(d-f)/(g-p),r=v-i*m,-1>i||i>1)if(d>f){if(a){if(a.y>=u)return}else a={x:(l-r)/i,y:l};n={x:(u-r)/i,y:u}}else{if(a){if(l>a.y)return}else a={x:(u-r)/i,y:u};n={x:(l-r)/i,y:l}}else if(g>p){if(a){if(a.x>=s)return}else a={x:o,y:i*o+r};n={x:s,y:i*s+r}}else{if(a){if(o>a.x)return}else a={x:s,y:i*s+r};n={x:o,y:i*o+r}}return t.a=a,t.b=n,!0}function di(t,e){this.l=t,this.r=e,this.a=this.b=null}function pi(t,e,n,i){var r=new di(t,e);return Wl.push(r),n&&gi(r,t,e,n),i&&gi(r,e,t,i),Ul[t.i].edges.push(new mi(r,t,e)),Ul[e.i].edges.push(new mi(r,e,t)),r}function fi(t,e,n){var i=new di(t,null);return i.a=e,i.b=n,Wl.push(i),i}function gi(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function mi(t,e,n){var i=t.a,r=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function vi(){this._=null}function _i(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function yi(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function xi(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function bi(t){for(;t.L;)t=t.L;return t}function Ai(t,e){var n,i,r,a=t.sort(ki).pop();for(Wl=[],Ul=Array(t.length),Xl=new vi,Zl=new vi;;)if(r=Jl,a&&(!r||a.y<r.y||a.y===r.y&&a.x<r.x))(a.x!==n||a.y!==i)&&(Ul[a.i]=new ri(a),ei(a),n=a.x,i=a.y),a=t.pop();else{if(!r)break;ti(r.arc)}e&&(ci(e),ai(e));var o={cells:Ul,edges:Wl};return Xl=Zl=Wl=Ul=null,o}function ki(t,e){return e.y-t.y||e.x-t.x}function Pi(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function Si(t){return t.x}function wi(t){return t.y}function Mi(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Ti(t,e,n,i,r,a){if(!t(e,n,i,r,a)){var o=.5*(n+r),s=.5*(i+a),l=e.nodes;l[0]&&Ti(t,l[0],n,i,o,s),l[1]&&Ti(t,l[1],o,i,r,s),l[2]&&Ti(t,l[2],n,s,o,a),l[3]&&Ti(t,l[3],o,s,r,a)}}function Oi(t,e){t=Xo.rgb(t),e=Xo.rgb(e);var n=t.r,i=t.g,r=t.b,a=e.r-n,o=e.g-i,s=e.b-r;return function(t){return"#"+le(Math.round(n+a*t))+le(Math.round(i+o*t))+le(Math.round(r+s*t))}}function Ei(t,e){var n,i={},r={};for(n in t)n in e?i[n]=Fi(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}}function Di(t,e){return e-=t=+t,function(n){return t+e*n}}function Li(t,e){var n,i,r,a,o,s=0,l=0,u=[],c=[];for(t+="",e+="",tu.lastIndex=0,i=0;n=tu.exec(e);++i)n.index&&u.push(e.substring(s,l=n.index)),c.push({i:u.length,x:n[0]}),u.push(null),s=tu.lastIndex;for(e.length>s&&u.push(e.substring(s)),i=0,a=c.length;(n=tu.exec(t))&&a>i;++i)if(o=c[i],o.x==n[0]){if(o.i)if(null==u[o.i+1])for(u[o.i-1]+=o.x,u.splice(o.i,1),r=i+1;a>r;++r)c[r].i--;else for(u[o.i-1]+=o.x+u[o.i+1],u.splice(o.i,2),r=i+1;a>r;++r)c[r].i-=2;else if(null==u[o.i+1])u[o.i]=o.x;else for(u[o.i]=o.x+u[o.i+1],u.splice(o.i+1,1),r=i+1;a>r;++r)c[r].i--;c.splice(i,1),a--,i--}else o.x=Di(parseFloat(n[0]),parseFloat(o.x));for(;a>i;)o=c.pop(),null==u[o.i+1]?u[o.i]=o.x:(u[o.i]=o.x+u[o.i+1],u.splice(o.i+1,1)),a--;return 1===u.length?null==u[0]?(o=c[0].x,function(t){return o(t)+""}):function(){return e}:function(t){for(i=0;a>i;++i)u[(o=c[i]).i]=o.x(t);return u.join("")}}function Fi(t,e){for(var n,i=Xo.interpolators.length;--i>=0&&!(n=Xo.interpolators[i](t,e)););return n}function zi(t,e){var n,i=[],r=[],a=t.length,o=e.length,s=Math.min(t.length,e.length);for(n=0;s>n;++n)i.push(Fi(t[n],e[n]));for(;a>n;++n)r[n]=t[n];for(;o>n;++n)r[n]=e[n];return function(t){for(n=0;s>n;++n)r[n]=i[n](t);return r}}function Vi(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function Ci(t){return function(e){return 1-t(1-e)}}function Ni(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function Ri(t){return t*t}function Ii(t){return t*t*t}function Bi(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)}function Gi(t){return function(e){return Math.pow(e,t)}}function Hi(t){return 1-Math.cos(t*Ts)}function ji(t){return Math.pow(2,10*(t-1))}function qi(t){return 1-Math.sqrt(1-t*t)}function Yi(t,e){var n;return 2>arguments.length&&(e=.45),arguments.length?n=e/Ms*Math.asin(1/t):(t=1,n=e/4),function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*Ms/e)}}function Wi(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Ui(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Xi(t,e){t=Xo.hcl(t),e=Xo.hcl(e);var n=t.h,i=t.c,r=t.l,a=e.h-n,o=e.c-i,s=e.l-r;return isNaN(o)&&(o=0,i=isNaN(i)?e.c:i),isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:-180>a&&(a+=360),function(t){return Z(n+a*t,i+o*t,r+s*t)+""}}function Ji(t,e){t=Xo.hsl(t),e=Xo.hsl(e);var n=t.h,i=t.s,r=t.l,a=e.h-n,o=e.s-i,s=e.l-r;return isNaN(o)&&(o=0,i=isNaN(i)?e.s:i),isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:-180>a&&(a+=360),function(t){return U(n+a*t,i+o*t,r+s*t)+""}}function Zi(t,e){t=Xo.lab(t),e=Xo.lab(e);var n=t.l,i=t.a,r=t.b,a=e.l-n,o=e.a-i,s=e.b-r;return function(t){return Q(n+a*t,i+o*t,r+s*t)+""}}function Ki(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function $i(t){var e=[t.a,t.b],n=[t.c,t.d],i=tr(e),r=Qi(e,n),a=tr(er(n,e,-r))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Ls,this.translate=[t.e,t.f],this.scale=[i,a],this.skew=a?Math.atan2(r,a)*Ls:0}function Qi(t,e){return t[0]*e[0]+t[1]*e[1]}function tr(t){var e=Math.sqrt(Qi(t,t));return e&&(t[0]/=e,t[1]/=e),e}function er(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function nr(t,e){var n,i=[],r=[],a=Xo.transform(t),o=Xo.transform(e),s=a.translate,l=o.translate,u=a.rotate,c=o.rotate,h=a.skew,d=o.skew,p=a.scale,f=o.scale;return s[0]!=l[0]||s[1]!=l[1]?(i.push("translate(",null,",",null,")"),r.push({i:1,x:Di(s[0],l[0])},{i:3,x:Di(s[1],l[1])})):l[0]||l[1]?i.push("translate("+l+")"):i.push(""),u!=c?(u-c>180?c+=360:c-u>180&&(u+=360),r.push({i:i.push(i.pop()+"rotate(",null,")")-2,x:Di(u,c)})):c&&i.push(i.pop()+"rotate("+c+")"),h!=d?r.push({i:i.push(i.pop()+"skewX(",null,")")-2,x:Di(h,d)}):d&&i.push(i.pop()+"skewX("+d+")"),p[0]!=f[0]||p[1]!=f[1]?(n=i.push(i.pop()+"scale(",null,",",null,")"),r.push({i:n-4,x:Di(p[0],f[0])},{i:n-2,x:Di(p[1],f[1])})):(1!=f[0]||1!=f[1])&&i.push(i.pop()+"scale("+f+")"),n=r.length,function(t){for(var e,a=-1;n>++a;)i[(e=r[a]).i]=e.x(t);return i.join("")}}function ir(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return(n-t)*e}}function rr(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return Math.max(0,Math.min(1,(n-t)*e))}}function ar(t){for(var e=t.source,n=t.target,i=sr(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var a=r.length;n!==i;)r.splice(a,0,n),n=n.parent;return r}function or(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function sr(t,e){if(t===e)return t;for(var n=or(t),i=or(e),r=n.pop(),a=i.pop(),o=null;r===a;)o=r,r=n.pop(),a=i.pop();return o}function lr(t){t.fixed|=2}function ur(t){t.fixed&=-7}function cr(t){t.fixed|=4,t.px=t.x,t.py=t.y}function hr(t){t.fixed&=-5}function dr(t,e,n){var i=0,r=0;if(t.charge=0,!t.leaf)for(var a,o=t.nodes,s=o.length,l=-1;s>++l;)a=o[l],null!=a&&(dr(a,e,n),t.charge+=a.charge,i+=a.charge*a.cx,r+=a.charge*a.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var u=e*n[t.point.index];t.charge+=t.pointCharge=u,i+=u*t.point.x,r+=u*t.point.y}t.cx=i/t.charge,t.cy=r/t.charge}function pr(t,e){return Xo.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=vr,t}function fr(t){return t.children}function gr(t){return t.value}function mr(t,e){return e.value-t.value}function vr(t){return Xo.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function _r(t){return t.x}function yr(t){return t.y}function xr(t,e,n){t.y0=e,t.y=n}function br(t){return Xo.range(t.length)}function Ar(t){for(var e=-1,n=t[0].length,i=[];n>++e;)i[e]=0;return i}function kr(t){for(var e,n=1,i=0,r=t[0][1],a=t.length;a>n;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function Pr(t){return t.reduce(Sr,0)}function Sr(t,e){return t+e[1]}function wr(t,e){return Mr(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function Mr(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,a=[];e>=++n;)a[n]=r*n+i;return a}function Tr(t){return[Xo.min(t),Xo.max(t)]}function Or(t,e){return t.parent==e.parent?1:2}function Er(t){var e=t.children;return e&&e.length?e[0]:t._tree.thread}function Dr(t){var e,n=t.children;return n&&(e=n.length)?n[e-1]:t._tree.thread}function Lr(t,e){var n=t.children;if(n&&(r=n.length))for(var i,r,a=-1;r>++a;)e(i=Lr(n[a],e),t)>0&&(t=i);return t}function Fr(t,e){return t.x-e.x}function zr(t,e){return e.x-t.x}function Vr(t,e){return t.depth-e.depth}function Cr(t,e){function n(t,i){var r=t.children;if(r&&(o=r.length))for(var a,o,s=null,l=-1;o>++l;)a=r[l],n(a,s),s=a;e(t,i)}n(t,null)}function Nr(t){for(var e,n=0,i=0,r=t.children,a=r.length;--a>=0;)e=r[a]._tree,e.prelim+=n,e.mod+=n,n+=e.shift+(i+=e.change)}function Rr(t,e,n){t=t._tree,e=e._tree;var i=n/(e.number-t.number);t.change+=i,e.change-=i,e.shift+=n,e.prelim+=n,e.mod+=n}function Ir(t,e,n){return t._tree.ancestor.parent==e.parent?t._tree.ancestor:n}function Br(t,e){return t.value-e.value}function Gr(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function Hr(t,e){t._pack_next=e,e._pack_prev=t}function jr(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return.999*r*r>n*n+i*i}function qr(t){function e(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),d=Math.min(t.y-t.r,d),p=Math.max(t.y+t.r,p)}if((n=t.children)&&(u=n.length)){var n,i,r,a,o,s,l,u,c=1/0,h=-1/0,d=1/0,p=-1/0;if(n.forEach(Yr),i=n[0],i.x=-i.r,i.y=0,e(i),u>1&&(r=n[1],r.x=r.r,r.y=0,e(r),u>2))for(a=n[2],Xr(i,r,a),e(a),Gr(i,a),i._pack_prev=a,Gr(a,r),r=i._pack_next,o=3;u>o;o++){Xr(i,r,a=n[o]);var f=0,g=1,m=1;for(s=r._pack_next;s!==r;s=s._pack_next,g++)if(jr(s,a)){f=1;break}if(1==f)for(l=i._pack_prev;l!==s._pack_prev&&!jr(l,a);l=l._pack_prev,m++);f?(m>g||g==m&&r.r<i.r?Hr(i,r=s):Hr(i=l,r),o--):(Gr(i,a),r=a,e(a))}var v=(c+h)/2,_=(d+p)/2,y=0;for(o=0;u>o;o++)a=n[o],a.x-=v,a.y-=_,y=Math.max(y,a.r+Math.sqrt(a.x*a.x+a.y*a.y));t.r=y,n.forEach(Wr)}}function Yr(t){t._pack_next=t._pack_prev=t}function Wr(t){delete t._pack_next,delete t._pack_prev}function Ur(t,e,n,i){var r=t.children;if(t.x=e+=i*t.x,t.y=n+=i*t.y,t.r*=i,r)for(var a=-1,o=r.length;o>++a;)Ur(r[a],e,n,i)}function Xr(t,e,n){var i=t.r+n.r,r=e.x-t.x,a=e.y-t.y;if(i&&(r||a)){var o=e.r+n.r,s=r*r+a*a;o*=o,i*=i;var l=.5+(i-o)/(2*s),u=Math.sqrt(Math.max(0,2*o*(i+s)-(i-=s)*i-o*o))/(2*s);n.x=t.x+l*r+u*a,n.y=t.y+l*a-u*r}else n.x=t.x+i,n.y=t.y}function Jr(t){return 1+Xo.max(t,function(t){return t.y})}function Zr(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Kr(t){var e=t.children;return e&&e.length?Kr(e[0]):t}function $r(t){var e,n=t.children;return n&&(e=n.length)?$r(n[e-1]):t}function Qr(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function ta(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],a=t.dy-e[0]-e[2];return 0>r&&(n+=r/2,r=0),0>a&&(i+=a/2,a=0),{x:n,y:i,dx:r,dy:a}}function ea(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function na(t){return t.rangeExtent?t.rangeExtent():ea(t.range())}function ia(t,e,n,i){var r=n(t[0],t[1]),a=i(e[0],e[1]);return function(t){return a(r(t))}}function ra(t,e){var n,i=0,r=t.length-1,a=t[i],o=t[r];return a>o&&(n=i,i=r,r=n,n=a,a=o,o=n),t[i]=e.floor(a),t[r]=e.ceil(o),t}function aa(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:cu}function oa(t,e,n,i){var r=[],a=[],o=0,s=Math.min(t.length,e.length)-1;for(t[s]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());s>=++o;)r.push(n(t[o-1],t[o])),a.push(i(e[o-1],e[o]));return function(e){var n=Xo.bisect(t,e,1,s)-1;return a[n](r[n](e))}}function sa(t,e,n,i){function r(){var r=Math.min(t.length,e.length)>2?oa:ia,l=i?rr:ir;return o=r(t,e,l,n),s=r(e,t,l,Fi),a}function a(t){return o(t)}var o,s;return a.invert=function(t){return s(t)},a.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},a.range=function(t){return arguments.length?(e=t,r()):e},a.rangeRound=function(t){return a.range(t).interpolate(Ki)},a.clamp=function(t){return arguments.length?(i=t,r()):i},a.interpolate=function(t){return arguments.length?(n=t,r()):n},a.ticks=function(e){return ha(t,e)},a.tickFormat=function(e,n){return da(t,e,n)},a.nice=function(e){return ua(t,e),r()},a.copy=function(){return sa(t,e,n,i)},r()}function la(t,e){return Xo.rebind(t,e,"range","rangeRound","interpolate","clamp")}function ua(t,e){return ra(t,aa(ca(t,e)[2]))}function ca(t,e){null==e&&(e=10);var n=ea(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),a=e/i*r;return.15>=a?r*=10:.35>=a?r*=5:.75>=a&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function ha(t,e){return Xo.range.apply(Xo,ca(t,e))}function da(t,e,n){var i=ca(t,e);return Xo.format(n?n.replace(al,function(t,e,n,r,a,o,s,l,u,c){return[e,n,r,a,o,s,l,u||"."+fa(c,i),c].join("")}):",."+pa(i[2])+"f")}function pa(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function fa(t,e){var n=pa(e[2]);return t in hu?Math.abs(n-pa(Math.max(Math.abs(e[0]),Math.abs(e[1]))))+ +("e"!==t):n-2*("%"===t)}function ga(t,e,n,i){function r(t){return(n?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function a(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function o(e){return t(r(e))}return o.invert=function(e){return a(t.invert(e))},o.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((i=e.map(Number)).map(r)),o):i},o.base=function(n){return arguments.length?(e=+n,t.domain(i.map(r)),o):e},o.nice=function(){var e=ra(i.map(r),n?Math:pu);return t.domain(e),i=e.map(a),o},o.ticks=function(){var t=ea(i),o=[],s=t[0],l=t[1],u=Math.floor(r(s)),c=Math.ceil(r(l)),h=e%1?2:e;if(isFinite(c-u)){if(n){for(;c>u;u++)for(var d=1;h>d;d++)o.push(a(u)*d);o.push(a(u))}else for(o.push(a(u));c>u++;)for(var d=h-1;d>0;d--)o.push(a(u)*d);for(u=0;s>o[u];u++);for(c=o.length;o[c-1]>l;c--);o=o.slice(u,c)}return o},o.tickFormat=function(t,e){if(!arguments.length)return du;2>arguments.length?e=du:"function"!=typeof e&&(e=Xo.format(e));var i,s=Math.max(.1,t/o.ticks().length),l=n?(i=1e-12,Math.ceil):(i=-1e-12,Math.floor);return function(t){return s>=t/a(l(r(t)+i))?e(t):""}},o.copy=function(){return ga(t.copy(),e,n,i)},la(o,t)}function ma(t,e,n){function i(e){return t(r(e))}var r=va(e),a=va(1/e);return i.invert=function(e){return a(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(r)),i):n},i.ticks=function(t){return ha(n,t)},i.tickFormat=function(t,e){return da(n,t,e)},i.nice=function(t){return i.domain(ua(n,t))},i.exponent=function(o){return arguments.length?(r=va(e=o),a=va(1/e),t.domain(n.map(r)),i):e},i.copy=function(){return ma(t.copy(),e,n)},la(i,t)}function va(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function _a(t,e){function n(n){return o[((a.get(n)||"range"===e.t&&a.set(n,t.push(n)))-1)%o.length]}function i(e,n){return Xo.range(t.length).map(function(t){return e+n*t})}var a,o,s;return n.domain=function(i){if(!arguments.length)return t;t=[],a=new r;for(var o,s=-1,l=i.length;l>++s;)a.has(o=i[s])||a.set(o,t.push(o));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(o=t,s=0,e={t:"range",a:arguments},n):o},n.rangePoints=function(r,a){2>arguments.length&&(a=0);var l=r[0],u=r[1],c=(u-l)/(Math.max(1,t.length-1)+a);return o=i(2>t.length?(l+u)/2:l+c*a/2,c),s=0,e={t:"rangePoints",a:arguments},n},n.rangeBands=function(r,a,l){2>arguments.length&&(a=0),3>arguments.length&&(l=a);var u=r[1]<r[0],c=r[u-0],h=r[1-u],d=(h-c)/(t.length-a+2*l);return o=i(c+d*l,d),u&&o.reverse(),s=d*(1-a),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(r,a,l){2>arguments.length&&(a=0),3>arguments.length&&(l=a);var u=r[1]<r[0],c=r[u-0],h=r[1-u],d=Math.floor((h-c)/(t.length-a+2*l)),p=h-c-(t.length-a)*d;return o=i(c+Math.round(p/2),d),u&&o.reverse(),s=Math.round(d*(1-a)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return s},n.rangeExtent=function(){return ea(e.a[0])},n.copy=function(){return _a(t,e)},n.domain(t)}function ya(t,e){function n(){var n=0,a=e.length;for(r=[];a>++n;)r[n-1]=Xo.quantile(t,n/a);return i}function i(t){return isNaN(t=+t)?void 0:e[Xo.bisect(r,t)]}var r;return i.domain=function(e){return arguments.length?(t=e.filter(function(t){return!isNaN(t)}).sort(Xo.ascending),n()):t},i.range=function(t){return arguments.length?(e=t,n()):e},i.quantiles=function(){return r},i.invertExtent=function(n){return n=e.indexOf(n),0>n?[0/0,0/0]:[n>0?r[n-1]:t[0],r.length>n?r[n]:t[t.length-1]]},i.copy=function(){return ya(t,e)},n()}function xa(t,e,n){function i(e){return n[Math.max(0,Math.min(o,Math.floor(a*(e-t))))]}function r(){return a=n.length/(e-t),o=n.length-1,i}var a,o;return i.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],r()):[t,e]},i.range=function(t){return arguments.length?(n=t,r()):n},i.invertExtent=function(e){return e=n.indexOf(e),e=0>e?0/0:e/a+t,[e,e+1/a]},i.copy=function(){return xa(t,e,n)},r()}function ba(t,e){function n(n){return n>=n?e[Xo.bisect(t,n)]:void 0}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return ba(t,e)},n}function Aa(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return ha(t,e)},e.tickFormat=function(e,n){return da(t,e,n)},e.copy=function(){return Aa(t)},e}function ka(t){return t.innerRadius}function Pa(t){return t.outerRadius}function Sa(t){return t.startAngle}function wa(t){return t.endAngle}function Ma(t){function e(e){function o(){u.push("M",a(t(c),s))}for(var l,u=[],c=[],h=-1,d=e.length,p=fe(n),f=fe(i);d>++h;)r.call(this,l=e[h],h)?c.push([+p.call(this,l,h),+f.call(this,l,h)]):c.length&&(o(),c=[]);return c.length&&o(),u.length?u.join(""):null}var n=Yn,i=Wn,r=qe,a=Ta,o=a.key,s=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(r=t,e):r},e.interpolate=function(t){return arguments.length?(o="function"==typeof t?a=t:(a=xu.get(t)||Ta).key,e):o},e.tension=function(t){return arguments.length?(s=t,e):s},e}function Ta(t){return t.join("L")}function Oa(t){return Ta(t)+"Z"}function Ea(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];n>++e;)r.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);return n>1&&r.push("H",i[0]),r.join("")}function Da(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];n>++e;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function La(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];n>++e;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function Fa(t,e){return 4>t.length?Ta(t):t[1]+Ca(t.slice(1,t.length-1),Na(t,e))}function za(t,e){return 3>t.length?Ta(t):t[0]+Ca((t.push(t[0]),t),Na([t[t.length-2]].concat(t,[t[1]]),e))}function Va(t,e){return 3>t.length?Ta(t):t[0]+Ca(t,Na(t,e))}function Ca(t,e){if(1>e.length||t.length!=e.length&&t.length!=e.length+2)return Ta(t);var n=t.length!=e.length,i="",r=t[0],a=t[1],o=e[0],s=o,l=1;if(n&&(i+="Q"+(a[0]-2*o[0]/3)+","+(a[1]-2*o[1]/3)+","+a[0]+","+a[1],r=t[1],l=2),e.length>1){s=e[1],a=t[l],l++,i+="C"+(r[0]+o[0])+","+(r[1]+o[1])+","+(a[0]-s[0])+","+(a[1]-s[1])+","+a[0]+","+a[1];for(var u=2;e.length>u;u++,l++)a=t[l],s=e[u],i+="S"+(a[0]-s[0])+","+(a[1]-s[1])+","+a[0]+","+a[1]}if(n){var c=t[l];i+="Q"+(a[0]+2*s[0]/3)+","+(a[1]+2*s[1]/3)+","+c[0]+","+c[1]}return i}function Na(t,e){for(var n,i=[],r=(1-e)/2,a=t[0],o=t[1],s=1,l=t.length;l>++s;)n=a,a=o,o=t[s],i.push([r*(o[0]-n[0]),r*(o[1]-n[1])]);return i}function Ra(t){if(3>t.length)return Ta(t);var e=1,n=t.length,i=t[0],r=i[0],a=i[1],o=[r,r,r,(i=t[1])[0]],s=[a,a,a,i[1]],l=[r,",",a,"L",Ha(ku,o),",",Ha(ku,s)];for(t.push(t[n-1]);n>=++e;)i=t[e],o.shift(),o.push(i[0]),s.shift(),s.push(i[1]),ja(l,o,s);return t.pop(),l.push("L",i),l.join("")}function Ia(t){if(4>t.length)return Ta(t);for(var e,n=[],i=-1,r=t.length,a=[0],o=[0];3>++i;)e=t[i],a.push(e[0]),o.push(e[1]);for(n.push(Ha(ku,a)+","+Ha(ku,o)),--i;r>++i;)e=t[i],a.shift(),a.push(e[0]),o.shift(),o.push(e[1]),ja(n,a,o);return n.join("")}function Ba(t){for(var e,n,i=-1,r=t.length,a=r+4,o=[],s=[];4>++i;)n=t[i%r],o.push(n[0]),s.push(n[1]);for(e=[Ha(ku,o),",",Ha(ku,s)],--i;a>++i;)n=t[i%r],o.shift(),o.push(n[0]),s.shift(),s.push(n[1]),ja(e,o,s);return e.join("")}function Ga(t,e){var n=t.length-1;if(n)for(var i,r,a=t[0][0],o=t[0][1],s=t[n][0]-a,l=t[n][1]-o,u=-1;n>=++u;)i=t[u],r=u/n,i[0]=e*i[0]+(1-e)*(a+r*s),i[1]=e*i[1]+(1-e)*(o+r*l);return Ra(t)}function Ha(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function ja(t,e,n){t.push("C",Ha(bu,e),",",Ha(bu,n),",",Ha(Au,e),",",Ha(Au,n),",",Ha(ku,e),",",Ha(ku,n))}function qa(t,e){return(e[1]-t[1])/(e[0]-t[0])}function Ya(t){for(var e=0,n=t.length-1,i=[],r=t[0],a=t[1],o=i[0]=qa(r,a);n>++e;)i[e]=(o+(o=qa(r=a,a=t[e+1])))/2;return i[e]=o,i}function Wa(t){for(var e,n,i,r,a=[],o=Ya(t),s=-1,l=t.length-1;l>++s;)e=qa(t[s],t[s+1]),Os>ls(e)?o[s]=o[s+1]=0:(n=o[s]/e,i=o[s+1]/e,r=n*n+i*i,r>9&&(r=3*e/Math.sqrt(r),o[s]=r*n,o[s+1]=r*i));for(s=-1;l>=++s;)r=(t[Math.min(l,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+o[s]*o[s])),a.push([r||0,o[s]*r||0]);return a}function Ua(t){return 3>t.length?Ta(t):t[0]+Ca(t,Wa(t))}function Xa(t){for(var e,n,i,r=-1,a=t.length;a>++r;)e=t[r],n=e[0],i=e[1]+_u,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function Ja(t){function e(e){function l(){g.push("M",s(t(v),h),c,u(t(m.reverse()),h),"Z")}for(var d,p,f,g=[],m=[],v=[],_=-1,y=e.length,x=fe(n),b=fe(r),A=n===i?function(){return p}:fe(i),k=r===a?function(){return f}:fe(a);y>++_;)o.call(this,d=e[_],_)?(m.push([p=+x.call(this,d,_),f=+b.call(this,d,_)]),v.push([+A.call(this,d,_),+k.call(this,d,_)])):m.length&&(l(),m=[],v=[]);return m.length&&l(),g.length?g.join(""):null}var n=Yn,i=Yn,r=0,a=Wn,o=qe,s=Ta,l=s.key,u=s,c="L",h=.7;return e.x=function(t){return arguments.length?(n=i=t,e):i},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(r=a=t,e):a},e.y0=function(t){return arguments.length?(r=t,e):r},e.y1=function(t){return arguments.length?(a=t,e):a},e.defined=function(t){return arguments.length?(o=t,e):o},e.interpolate=function(t){return arguments.length?(l="function"==typeof t?s=t:(s=xu.get(t)||Ta).key,u=s.reverse||s,c=s.closed?"M":"L",e):l},e.tension=function(t){return arguments.length?(h=t,e):h},e}function Za(t){return t.radius}function Ka(t){return[t.x,t.y]}function $a(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]+_u;return[n*Math.cos(i),n*Math.sin(i)]}}function Qa(){return 64}function to(){return"circle"}function eo(t){var e=Math.sqrt(t/ws);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function no(t,e){return ps(t,Ou),t.id=e,t}function io(t,e,n,i){var r=t.id;return T(t,"function"==typeof n?function(t,a,o){t.__transition__[r].tween.set(e,i(n.call(t,t.__data__,a,o)))}:(n=i(n),function(t){t.__transition__[r].tween.set(e,n)}))}function ro(t){return null==t&&(t=""),function(){this.textContent=t}}function ao(t,e,n,i){var a=t.__transition__||(t.__transition__={active:0,count:0}),o=a[n];if(!o){var s=i.time;o=a[n]={tween:new r,time:s,ease:i.ease,delay:i.delay,duration:i.duration},++a.count,Xo.timer(function(i){function r(i){return a.active>n?u():(a.active=n,o.event&&o.event.start.call(t,c,e),o.tween.forEach(function(n,i){(i=i.call(t,c,e))&&g.push(i)}),Xo.timer(function(){return f.c=l(i||1)?qe:l,1},0,s),void 0)}function l(i){if(a.active!==n)return u();for(var r=i/p,s=h(r),l=g.length;l>0;)g[--l].call(t,s);return r>=1?(o.event&&o.event.end.call(t,c,e),u()):void 0}function u(){return--a.count?delete a[n]:delete t.__transition__,1}var c=t.__data__,h=o.ease,d=o.delay,p=o.duration,f=$s,g=[];return f.t=d+s,i>=d?r(i-d):(f.c=r,void 0)},0,s)}}function oo(t,e){t.attr("transform",function(t){return"translate("+e(t)+",0)"})}function so(t,e){t.attr("transform",function(t){return"translate(0,"+e(t)+")"})}function lo(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function uo(t,e,n){function i(e){var n=t(e),i=a(n,1);return i-e>e-n?n:i}function r(n){return e(n=t(new Cu(n-1)),1),n}function a(t,n){return e(t=new Cu(+t),n),t}function o(t,i,a){var o=r(t),s=[];if(a>1)for(;i>o;)n(o)%a||s.push(new Date(+o)),e(o,1);else for(;i>o;)s.push(new Date(+o)),e(o,1);return s}function s(t,e,n){try{Cu=lo;var i=new lo;return i._=t,o(i,e,n)}finally{Cu=Date}}t.floor=t,t.round=i,t.ceil=r,t.offset=a,t.range=o;var l=t.utc=co(t);return l.floor=l,l.round=co(i),l.ceil=co(r),l.offset=co(a),l.range=s,t}function co(t){return function(e,n){try{Cu=lo;var i=new lo;return i._=e,t(i,n)._}finally{Cu=Date}}}function ho(t){function e(e){for(var i,r,a,o=[],s=-1,l=0;n>++s;)37===t.charCodeAt(s)&&(o.push(t.substring(l,s)),null!=(r=ec[i=t.charAt(++s)])&&(i=t.charAt(++s)),(a=nc[i])&&(i=a(e,null==r?"e"===i?" ":"0":r)),o.push(i),l=s+1);return o.push(t.substring(l,s)),o.join("")}var n=t.length;return e.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},i=po(n,t,e,0);if(i!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var r=null!=n.Z&&Cu!==lo,a=new(r?lo:Cu);return"j"in n?a.setFullYear(n.y,0,n.j):"w"in n&&("W"in n||"U"in n)?(a.setFullYear(n.y,0,1),a.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(a.getDay()+5)%7:n.w+7*n.U-(a.getDay()+6)%7)):a.setFullYear(n.y,n.m,n.d),a.setHours(n.H+Math.floor(n.Z/100),n.M+n.Z%100,n.S,n.L),r?a._:a},e.toString=function(){return t},e}function po(t,e,n,i){for(var r,a,o,s=0,l=e.length,u=n.length;l>s;){if(i>=u)return-1;if(r=e.charCodeAt(s++),37===r){if(o=e.charAt(s++),a=ic[o in ec?e.charAt(s++):o],!a||0>(i=a(t,n,i)))return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function fo(t){return RegExp("^(?:"+t.map(Xo.requote).join("|")+")","i")}function go(t){for(var e=new r,n=-1,i=t.length;i>++n;)e.set(t[n].toLowerCase(),n);return e}function mo(t,e,n){var i=0>t?"-":"",r=(i?-t:t)+"",a=r.length;return i+(n>a?Array(n-a+1).join(e)+r:r)}function vo(t,e,n){Xu.lastIndex=0;var i=Xu.exec(e.substring(n));return i?(t.w=Ju.get(i[0].toLowerCase()),n+i[0].length):-1}function _o(t,e,n){Wu.lastIndex=0;var i=Wu.exec(e.substring(n));return i?(t.w=Uu.get(i[0].toLowerCase()),n+i[0].length):-1}function yo(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function xo(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n));return i?(t.U=+i[0],n+i[0].length):-1}function bo(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n));return i?(t.W=+i[0],n+i[0].length):-1}function Ao(t,e,n){$u.lastIndex=0;var i=$u.exec(e.substring(n));return i?(t.m=Qu.get(i[0].toLowerCase()),n+i[0].length):-1}function ko(t,e,n){Zu.lastIndex=0;var i=Zu.exec(e.substring(n));return i?(t.m=Ku.get(i[0].toLowerCase()),n+i[0].length):-1}function Po(t,e,n){return po(t,""+nc.c,e,n)}function So(t,e,n){return po(t,""+nc.x,e,n)}function wo(t,e,n){return po(t,""+nc.X,e,n)}function Mo(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function To(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n,n+2));return i?(t.y=Eo(+i[0]),n+i[0].length):-1}function Oo(t,e,n){return/^[+-]\d{4}$/.test(e=e.substring(n,n+5))?(t.Z=+e,n+5):-1}function Eo(t){return t+(t>68?1900:2e3)}function Do(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function Lo(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function Fo(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1}function zo(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function Vo(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Co(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function No(t,e,n){rc.lastIndex=0;var i=rc.exec(e.substring(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Ro(t,e,n){var i=ac.get(e.substring(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)}function Io(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=~~(ls(e)/60),r=ls(e)%60;return n+mo(i,"0",2)+mo(r,"0",2)}function Bo(t,e,n){tc.lastIndex=0;var i=tc.exec(e.substring(n,n+1));return i?n+i[0].length:-1}function Go(t){function e(t){try{Cu=lo;var e=new Cu;return e._=t,n(e)}finally{Cu=Date}}var n=ho(t);return e.parse=function(t){try{Cu=lo;var e=n.parse(t);return e&&e._}finally{Cu=Date}},e.toString=n.toString,e}function Ho(t){return t.toISOString()}function jo(t,e,n){function i(e){return t(e)}function r(t,n){var i=t[1]-t[0],r=i/n,a=Xo.bisect(sc,r);return a==sc.length?[e.year,ca(t.map(function(t){return t/31536e6}),n)[2]]:a?e[r/sc[a-1]<sc[a]/r?a-1:a]:[hc,ca(t,n)[2]]}return i.invert=function(e){return qo(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(qo)},i.nice=function(t,e){function n(n){return!isNaN(n)&&!t.range(n,qo(+n+1),e).length}var a=i.domain(),o=ea(a),s=null==t?r(o,10):"number"==typeof t&&r(o,t);return s&&(t=s[0],e=s[1]),i.domain(ra(a,e>1?{floor:function(e){for(;n(e=t.floor(e));)e=qo(e-1);return e},ceil:function(e){for(;n(e=t.ceil(e));)e=qo(+e+1);return e}}:t))},i.ticks=function(t,e){var n=ea(i.domain()),a=null==t?r(n,10):"number"==typeof t?r(n,t):!t.range&&[{range:t},e];return a&&(t=a[0],e=a[1]),t.range(n[0],qo(+n[1]+1),1>e?1:e)},i.tickFormat=function(){return n},i.copy=function(){return jo(t.copy(),e,n)},la(i,t)}function qo(t){return new Date(t)}function Yo(t){return function(e){for(var n=t.length-1,i=t[n];!i[1](e);)i=t[--n];return i[0](e)}}function Wo(t){return JSON.parse(t.responseText)}function Uo(t){var e=Ko.createRange();return e.selectNode(Ko.body),e.createContextualFragment(t.responseText)}var Xo={version:"3.3.9"};Date.now||(Date.now=function(){return+new Date});var Jo=[].slice,Zo=function(t){return Jo.call(t)},Ko=document,$o=Ko.documentElement,Qo=window;try{Zo($o.childNodes)[0].nodeType}catch(ts){Zo=function(t){for(var e=t.length,n=Array(e);e--;)n[e]=t[e];return n}}try{Ko.createElement("div").style.setProperty("opacity",0,"")}catch(es){var ns=Qo.Element.prototype,is=ns.setAttribute,rs=ns.setAttributeNS,as=Qo.CSSStyleDeclaration.prototype,os=as.setProperty;ns.setAttribute=function(t,e){is.call(this,t,e+"")},ns.setAttributeNS=function(t,e,n){rs.call(this,t,e,n+"")},as.setProperty=function(t,e,n){os.call(this,t,e+"",n)}}Xo.ascending=function(t,e){return e>t?-1:t>e?1:t>=e?0:0/0},Xo.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:0/0},Xo.min=function(t,e){var n,i,r=-1,a=t.length;if(1===arguments.length){for(;a>++r&&!(null!=(n=t[r])&&n>=n);)n=void 0;for(;a>++r;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;a>++r&&!(null!=(n=e.call(t,t[r],r))&&n>=n);)n=void 0;for(;a>++r;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},Xo.max=function(t,e){var n,i,r=-1,a=t.length;if(1===arguments.length){for(;a>++r&&!(null!=(n=t[r])&&n>=n);)n=void 0;for(;a>++r;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;a>++r&&!(null!=(n=e.call(t,t[r],r))&&n>=n);)n=void 0;for(;a>++r;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},Xo.extent=function(t,e){var n,i,r,a=-1,o=t.length;if(1===arguments.length){for(;o>++a&&!(null!=(n=r=t[a])&&n>=n);)n=r=void 0;for(;o>++a;)null!=(i=t[a])&&(n>i&&(n=i),i>r&&(r=i))}else{for(;o>++a&&!(null!=(n=r=e.call(t,t[a],a))&&n>=n);)n=void 0;for(;o>++a;)null!=(i=e.call(t,t[a],a))&&(n>i&&(n=i),i>r&&(r=i))}return[n,r]},Xo.sum=function(t,e){var n,i=0,r=t.length,a=-1;if(1===arguments.length)for(;r>++a;)isNaN(n=+t[a])||(i+=n);else for(;r>++a;)isNaN(n=+e.call(t,t[a],a))||(i+=n);return i},Xo.mean=function(e,n){var i,r=e.length,a=0,o=-1,s=0;if(1===arguments.length)for(;r>++o;)t(i=e[o])&&(a+=(i-a)/++s);else for(;r>++o;)t(i=n.call(e,e[o],o))&&(a+=(i-a)/++s);return s?a:void 0},Xo.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],a=n-i;
return a?r+a*(t[i]-r):r},Xo.median=function(e,n){return arguments.length>1&&(e=e.map(n)),e=e.filter(t),e.length?Xo.quantile(e.sort(Xo.ascending),.5):void 0},Xo.bisector=function(t){return{left:function(e,n,i,r){for(3>arguments.length&&(i=0),4>arguments.length&&(r=e.length);r>i;){var a=i+r>>>1;n>t.call(e,e[a],a)?i=a+1:r=a}return i},right:function(e,n,i,r){for(3>arguments.length&&(i=0),4>arguments.length&&(r=e.length);r>i;){var a=i+r>>>1;t.call(e,e[a],a)>n?r=a:i=a+1}return i}}};var ss=Xo.bisector(function(t){return t});Xo.bisectLeft=ss.left,Xo.bisect=Xo.bisectRight=ss.right,Xo.shuffle=function(t){for(var e,n,i=t.length;i;)n=0|Math.random()*i--,e=t[i],t[i]=t[n],t[n]=e;return t},Xo.permute=function(t,e){for(var n=e.length,i=Array(n);n--;)i[n]=t[e[n]];return i},Xo.pairs=function(t){for(var e,n=0,i=t.length-1,r=t[0],a=Array(0>i?0:i);i>n;)a[n]=[e=r,r=t[++n]];return a},Xo.zip=function(){if(!(r=arguments.length))return[];for(var t=-1,n=Xo.min(arguments,e),i=Array(n);n>++t;)for(var r,a=-1,o=i[t]=Array(r);r>++a;)o[a]=arguments[a][t];return i},Xo.transpose=function(t){return Xo.zip.apply(Xo,t)},Xo.keys=function(t){var e=[];for(var n in t)e.push(n);return e},Xo.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},Xo.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},Xo.merge=function(t){for(var e,n,i,r=t.length,a=-1,o=0;r>++a;)o+=t[a].length;for(n=Array(o);--r>=0;)for(i=t[r],e=i.length;--e>=0;)n[--o]=i[e];return n};var ls=Math.abs;Xo.range=function(t,e,i){if(3>arguments.length&&(i=1,2>arguments.length&&(e=t,t=0)),1/0===(e-t)/i)throw Error("infinite range");var r,a=[],o=n(ls(i)),s=-1;if(t*=o,e*=o,i*=o,0>i)for(;(r=t+i*++s)>e;)a.push(r/o);else for(;e>(r=t+i*++s);)a.push(r/o);return a},Xo.map=function(t){var e=new r;if(t instanceof r)t.forEach(function(t,n){e.set(t,n)});else for(var n in t)e.set(n,t[n]);return e},i(r,{has:function(t){return us+t in this},get:function(t){return this[us+t]},set:function(t,e){return this[us+t]=e},remove:function(t){return t=us+t,t in this&&delete this[t]},keys:function(){var t=[];return this.forEach(function(e){t.push(e)}),t},values:function(){var t=[];return this.forEach(function(e,n){t.push(n)}),t},entries:function(){var t=[];return this.forEach(function(e,n){t.push({key:e,value:n})}),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===cs&&t.call(this,e.substring(1),this[e])}});var us="\0",cs=us.charCodeAt(0);Xo.nest=function(){function t(e,s,l){if(l>=o.length)return i?i.call(a,s):n?s.sort(n):s;for(var u,c,h,d,p=-1,f=s.length,g=o[l++],m=new r;f>++p;)(d=m.get(u=g(c=s[p])))?d.push(c):m.set(u,[c]);return e?(c=e(),h=function(n,i){c.set(n,t(e,i,l))}):(c={},h=function(n,i){c[n]=t(e,i,l)}),m.forEach(h),c}function e(t,n){if(n>=o.length)return t;var i=[],r=s[n++];return t.forEach(function(t,r){i.push({key:t,values:e(r,n)})}),r?i.sort(function(t,e){return r(t.key,e.key)}):i}var n,i,a={},o=[],s=[];return a.map=function(e,n){return t(n,e,0)},a.entries=function(n){return e(t(Xo.map,n,0),0)},a.key=function(t){return o.push(t),a},a.sortKeys=function(t){return s[o.length-1]=t,a},a.sortValues=function(t){return n=t,a},a.rollup=function(t){return i=t,a},a},Xo.set=function(t){var e=new a;if(t)for(var n=0,i=t.length;i>n;++n)e.add(t[n]);return e},i(a,{has:function(t){return us+t in this},add:function(t){return this[us+t]=!0,t},remove:function(t){return t=us+t,t in this&&delete this[t]},values:function(){var t=[];return this.forEach(function(e){t.push(e)}),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===cs&&t.call(this,e.substring(1))}}),Xo.behavior={},Xo.rebind=function(t,e){for(var n,i=1,r=arguments.length;r>++i;)t[n=arguments[i]]=o(t,e,e[n]);return t};var hs=["webkit","ms","moz","Moz","o","O"];Xo.dispatch=function(){for(var t=new u,e=-1,n=arguments.length;n>++e;)t[arguments[e]]=c(t);return t},u.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.substring(n+1),t=t.substring(0,n)),t)return 2>arguments.length?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},Xo.event=null,Xo.requote=function(t){return t.replace(ds,"\\$&")};var ds=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ps={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},fs=function(t,e){return e.querySelector(t)},gs=function(t,e){return e.querySelectorAll(t)},ms=$o[s($o,"matchesSelector")],vs=function(t,e){return ms.call(t,e)};"function"==typeof Sizzle&&(fs=function(t,e){return Sizzle(t,e)[0]||null},gs=function(t,e){return Sizzle.uniqueSort(Sizzle(t,e))},vs=Sizzle.matchesSelector),Xo.selection=function(){return bs};var _s=Xo.selection.prototype=[];_s.select=function(t){var e,n,i,r,a=[];t=g(t);for(var o=-1,s=this.length;s>++o;){a.push(e=[]),e.parentNode=(i=this[o]).parentNode;for(var l=-1,u=i.length;u>++l;)(r=i[l])?(e.push(n=t.call(r,r.__data__,l,o)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return f(a)},_s.selectAll=function(t){var e,n,i=[];t=m(t);for(var r=-1,a=this.length;a>++r;)for(var o=this[r],s=-1,l=o.length;l>++s;)(n=o[s])&&(i.push(e=Zo(t.call(n,n.__data__,s,r))),e.parentNode=n);return f(i)};var ys={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Xo.ns={prefix:ys,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.substring(0,e),t=t.substring(e+1)),ys.hasOwnProperty(n)?{space:ys[n],local:t}:t}},_s.attr=function(t,e){if(2>arguments.length){if("string"==typeof t){var n=this.node();return t=Xo.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(v(e,t[e]));return this}return this.each(v(t,e))},_s.classed=function(t,e){if(2>arguments.length){if("string"==typeof t){var n=this.node(),i=(t=t.trim().split(/^|\s+/g)).length,r=-1;if(e=n.classList){for(;i>++r;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");i>++r;)if(!y(t[r]).test(e))return!1;return!0}for(e in t)this.each(x(e,t[e]));return this}return this.each(x(t,e))},_s.style=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e="");for(n in t)this.each(A(n,t[n],e));return this}if(2>i)return Qo.getComputedStyle(this.node(),null).getPropertyValue(t);n=""}return this.each(A(t,e,n))},_s.property=function(t,e){if(2>arguments.length){if("string"==typeof t)return this.node()[t];for(e in t)this.each(k(e,t[e]));return this}return this.each(k(t,e))},_s.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},_s.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},_s.append=function(t){return t=P(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},_s.insert=function(t,e){return t=P(t),e=g(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},_s.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},_s.data=function(t,e){function n(t,n){var i,a,o,s=t.length,h=n.length,d=Math.min(s,h),p=Array(h),f=Array(h),g=Array(s);if(e){var m,v=new r,_=new r,y=[];for(i=-1;s>++i;)m=e.call(a=t[i],a.__data__,i),v.has(m)?g[i]=a:v.set(m,a),y.push(m);for(i=-1;h>++i;)m=e.call(n,o=n[i],i),(a=v.get(m))?(p[i]=a,a.__data__=o):_.has(m)||(f[i]=S(o)),_.set(m,o),v.remove(m);for(i=-1;s>++i;)v.has(y[i])&&(g[i]=t[i])}else{for(i=-1;d>++i;)a=t[i],o=n[i],a?(a.__data__=o,p[i]=a):f[i]=S(o);for(;h>i;++i)f[i]=S(n[i]);for(;s>i;++i)g[i]=t[i]}f.update=p,f.parentNode=p.parentNode=g.parentNode=t.parentNode,l.push(f),u.push(p),c.push(g)}var i,a,o=-1,s=this.length;if(!arguments.length){for(t=Array(s=(i=this[0]).length);s>++o;)(a=i[o])&&(t[o]=a.__data__);return t}var l=O([]),u=f([]),c=f([]);if("function"==typeof t)for(;s>++o;)n(i=this[o],t.call(i,i.parentNode.__data__,o));else for(;s>++o;)n(i=this[o],t);return u.enter=function(){return l},u.exit=function(){return c},u},_s.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},_s.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=w(t));for(var a=0,o=this.length;o>a;a++){r.push(e=[]),e.parentNode=(n=this[a]).parentNode;for(var s=0,l=n.length;l>s;s++)(i=n[s])&&t.call(i,i.__data__,s)&&e.push(i)}return f(r)},_s.order=function(){for(var t=-1,e=this.length;e>++t;)for(var n,i=this[t],r=i.length-1,a=i[r];--r>=0;)(n=i[r])&&(a&&a!==n.nextSibling&&a.parentNode.insertBefore(n,a),a=n);return this},_s.sort=function(t){t=M.apply(this,arguments);for(var e=-1,n=this.length;n>++e;)this[e].sort(t);return this.order()},_s.each=function(t){return T(this,function(e,n,i){t.call(e,e.__data__,n,i)})},_s.call=function(t){var e=Zo(arguments);return t.apply(e[0]=this,e),this},_s.empty=function(){return!this.node()},_s.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],i=0,r=n.length;r>i;i++){var a=n[i];if(a)return a}return null},_s.size=function(){var t=0;return this.each(function(){++t}),t};var xs=[];Xo.selection.enter=O,Xo.selection.enter.prototype=xs,xs.append=_s.append,xs.empty=_s.empty,xs.node=_s.node,xs.call=_s.call,xs.size=_s.size,xs.select=function(t){for(var e,n,i,r,a,o=[],s=-1,l=this.length;l>++s;){i=(r=this[s]).update,o.push(e=[]),e.parentNode=r.parentNode;for(var u=-1,c=r.length;c>++u;)(a=r[u])?(e.push(i[u]=n=t.call(r.parentNode,a.__data__,u,s)),n.__data__=a.__data__):e.push(null)}return f(o)},xs.insert=function(t,e){return 2>arguments.length&&(e=E(this)),_s.insert.call(this,t,e)},_s.transition=function(){for(var t,e,n=Su||++Eu,i=[],r=wu||{time:Date.now(),ease:Bi,delay:0,duration:250},a=-1,o=this.length;o>++a;){i.push(t=[]);for(var s=this[a],l=-1,u=s.length;u>++l;)(e=s[l])&&ao(e,l,n,r),t.push(e)}return no(i,n)},_s.interrupt=function(){return this.each(D)},Xo.select=function(t){var e=["string"==typeof t?fs(t,Ko):t];return e.parentNode=$o,f([e])},Xo.selectAll=function(t){var e=Zo("string"==typeof t?gs(t,Ko):t);return e.parentNode=$o,f([e])};var bs=Xo.select($o);_s.on=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e=!1);for(n in t)this.each(L(n,t[n],e));return this}if(2>i)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(L(t,e,n))};var As=Xo.map({mouseenter:"mouseover",mouseleave:"mouseout"});As.forEach(function(t){"on"+t in Ko&&As.remove(t)});var ks="onselectstart"in Ko?null:s($o.style,"userSelect"),Ps=0;Xo.mouse=function(t){return C(t,d())};var Ss=/WebKit/.test(Qo.navigator.userAgent)?-1:0;Xo.touches=function(t,e){return 2>arguments.length&&(e=d().touches),e?Zo(e).map(function(e){var n=C(t,e);return n.identifier=e.identifier,n}):[]},Xo.behavior.drag=function(){function t(){this.on("mousedown.drag",o).on("touchstart.drag",s)}function e(){return Xo.event.changedTouches[0].identifier}function n(t,e){return Xo.touches(t).filter(function(t){return t.identifier===e})[0]}function i(t,e,n,i){return function(){function o(){var t=e(c,p),n=t[0]-g[0],i=t[1]-g[1];m|=n|i,g=t,h({type:"drag",x:t[0]+l[0],y:t[1]+l[1],dx:n,dy:i})}function s(){v.on(n+"."+f,null).on(i+"."+f,null),_(m&&Xo.event.target===d),h({type:"dragend"})}var l,u=this,c=u.parentNode,h=r.of(u,arguments),d=Xo.event.target,p=t(),f=null==p?"drag":"drag-"+p,g=e(c,p),m=0,v=Xo.select(Qo).on(n+"."+f,o).on(i+"."+f,s),_=V();a?(l=a.apply(u,arguments),l=[l.x-g[0],l.y-g[1]]):l=[0,0],h({type:"dragstart"})}}var r=p(t,"drag","dragstart","dragend"),a=null,o=i(l,Xo.mouse,"mousemove","mouseup"),s=i(e,n,"touchmove","touchend");return t.origin=function(e){return arguments.length?(a=e,t):a},Xo.rebind(t,r,"on")};var ws=Math.PI,Ms=2*ws,Ts=ws/2,Os=1e-6,Es=Os*Os,Ds=ws/180,Ls=180/ws,Fs=Math.SQRT2,zs=2,Vs=4;Xo.interpolateZoom=function(t,e){function n(t){var e=t*_;if(v){var n=G(g),o=a/(zs*d)*(n*H(Fs*e+g)-B(g));return[i+o*u,r+o*c,a*n/G(Fs*e+g)]}return[i+t*u,r+t*c,a*Math.exp(Fs*e)]}var i=t[0],r=t[1],a=t[2],o=e[0],s=e[1],l=e[2],u=o-i,c=s-r,h=u*u+c*c,d=Math.sqrt(h),p=(l*l-a*a+Vs*h)/(2*a*zs*d),f=(l*l-a*a-Vs*h)/(2*l*zs*d),g=Math.log(Math.sqrt(p*p+1)-p),m=Math.log(Math.sqrt(f*f+1)-f),v=m-g,_=(v||Math.log(l/a))/Fs;return n.duration=1e3*_,n},Xo.behavior.zoom=function(){function t(t){t.on(M,u).on(Rs+".zoom",d).on(T,f).on("dblclick.zoom",g).on(E,c)}function e(t){return[(t[0]-P.x)/P.k,(t[1]-P.y)/P.k]}function n(t){return[t[0]*P.k+P.x,t[1]*P.k+P.y]}function i(t){P.k=Math.max(w[0],Math.min(w[1],t))}function r(t,e){e=n(e),P.x+=t[0]-e[0],P.y+=t[1]-e[1]}function a(){b&&b.domain(x.range().map(function(t){return(t-P.x)/P.k}).map(x.invert)),k&&k.domain(A.range().map(function(t){return(t-P.y)/P.k}).map(A.invert))}function o(t){t({type:"zoomstart"})}function s(t){a(),t({type:"zoom",scale:P.k,translate:[P.x,P.y]})}function l(t){t({type:"zoomend"})}function u(){function t(){c=1,r(Xo.mouse(i),d),s(a)}function n(){h.on(T,Qo===i?f:null).on(O,null),p(c&&Xo.event.target===u),l(a)}var i=this,a=L.of(i,arguments),u=Xo.event.target,c=0,h=Xo.select(Qo).on(T,t).on(O,n),d=e(Xo.mouse(i)),p=V();D.call(i),o(a)}function c(){function t(){var t=Xo.touches(f);return p=P.k,t.forEach(function(t){t.identifier in m&&(m[t.identifier]=e(t))}),t}function n(){for(var e=Xo.event.changedTouches,n=0,a=e.length;a>n;++n)m[e[n].identifier]=null;var o=t(),l=Date.now();if(1===o.length){if(500>l-y){var u=o[0],c=m[u.identifier];i(2*P.k),r(u,c),h(),s(g)}y=l}else if(o.length>1){var u=o[0],d=o[1],p=u[0]-d[0],f=u[1]-d[1];v=p*p+f*f}}function a(){for(var t,e,n,a,o=Xo.touches(f),l=0,u=o.length;u>l;++l,a=null)if(n=o[l],a=m[n.identifier]){if(e)break;t=n,e=a}if(a){var c=(c=n[0]-t[0])*c+(c=n[1]-t[1])*c,h=v&&Math.sqrt(c/v);t=[(t[0]+n[0])/2,(t[1]+n[1])/2],e=[(e[0]+a[0])/2,(e[1]+a[1])/2],i(h*p)}y=null,r(t,e),s(g)}function d(){if(Xo.event.touches.length){for(var e=Xo.event.changedTouches,n=0,i=e.length;i>n;++n)delete m[e[n].identifier];for(var r in m)return void t()}A.on(x,null).on(b,null),k.on(M,u).on(E,c),S(),l(g)}var p,f=this,g=L.of(f,arguments),m={},v=0,_=Xo.event.changedTouches[0].identifier,x="touchmove.zoom-"+_,b="touchend.zoom-"+_,A=Xo.select(Qo).on(x,a).on(b,d),k=Xo.select(f).on(M,null).on(E,n),S=V();D.call(f),n(),o(g)}function d(){var t=L.of(this,arguments);_?clearTimeout(_):(D.call(this),o(t)),_=setTimeout(function(){_=null,l(t)},50),h();var n=v||Xo.mouse(this);m||(m=e(n)),i(Math.pow(2,.002*Cs())*P.k),r(n,m),s(t)}function f(){m=null}function g(){var t=L.of(this,arguments),n=Xo.mouse(this),a=e(n),u=Math.log(P.k)/Math.LN2;o(t),i(Math.pow(2,Xo.event.shiftKey?Math.ceil(u)-1:Math.floor(u)+1)),r(n,a),s(t),l(t)}var m,v,_,y,x,b,A,k,P={x:0,y:0,k:1},S=[960,500],w=Ns,M="mousedown.zoom",T="mousemove.zoom",O="mouseup.zoom",E="touchstart.zoom",L=p(t,"zoomstart","zoom","zoomend");return t.event=function(t){t.each(function(){var t=L.of(this,arguments),e=P;Su?Xo.select(this).transition().each("start.zoom",function(){P=this.__chart__||{x:0,y:0,k:1},o(t)}).tween("zoom:zoom",function(){var n=S[0],i=S[1],r=n/2,a=i/2,o=Xo.interpolateZoom([(r-P.x)/P.k,(a-P.y)/P.k,n/P.k],[(r-e.x)/e.k,(a-e.y)/e.k,n/e.k]);return function(e){var i=o(e),l=n/i[2];this.__chart__=P={x:r-i[0]*l,y:a-i[1]*l,k:l},s(t)}}).each("end.zoom",function(){l(t)}):(this.__chart__=P,o(t),s(t),l(t))})},t.translate=function(e){return arguments.length?(P={x:+e[0],y:+e[1],k:P.k},a(),t):[P.x,P.y]},t.scale=function(e){return arguments.length?(P={x:P.x,y:P.y,k:+e},a(),t):P.k},t.scaleExtent=function(e){return arguments.length?(w=null==e?Ns:[+e[0],+e[1]],t):w},t.center=function(e){return arguments.length?(v=e&&[+e[0],+e[1]],t):v},t.size=function(e){return arguments.length?(S=e&&[+e[0],+e[1]],t):S},t.x=function(e){return arguments.length?(b=e,x=e.copy(),P={x:0,y:0,k:1},t):b},t.y=function(e){return arguments.length?(k=e,A=e.copy(),P={x:0,y:0,k:1},t):k},Xo.rebind(t,L,"on")};var Cs,Ns=[0,1/0],Rs="onwheel"in Ko?(Cs=function(){return-Xo.event.deltaY*(Xo.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Ko?(Cs=function(){return Xo.event.wheelDelta},"mousewheel"):(Cs=function(){return-Xo.event.detail},"MozMousePixelScroll");q.prototype.toString=function(){return this.rgb()+""},Xo.hsl=function(t,e,n){return 1===arguments.length?t instanceof W?Y(t.h,t.s,t.l):ue(""+t,ce,Y):Y(+t,+e,+n)};var Is=W.prototype=new q;Is.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),Y(this.h,this.s,this.l/t)},Is.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),Y(this.h,this.s,t*this.l)},Is.rgb=function(){return U(this.h,this.s,this.l)},Xo.hcl=function(t,e,n){return 1===arguments.length?t instanceof J?X(t.h,t.c,t.l):t instanceof $?te(t.l,t.a,t.b):te((t=he((t=Xo.rgb(t)).r,t.g,t.b)).l,t.a,t.b):X(+t,+e,+n)};var Bs=J.prototype=new q;Bs.brighter=function(t){return X(this.h,this.c,Math.min(100,this.l+Gs*(arguments.length?t:1)))},Bs.darker=function(t){return X(this.h,this.c,Math.max(0,this.l-Gs*(arguments.length?t:1)))},Bs.rgb=function(){return Z(this.h,this.c,this.l).rgb()},Xo.lab=function(t,e,n){return 1===arguments.length?t instanceof $?K(t.l,t.a,t.b):t instanceof J?Z(t.l,t.c,t.h):he((t=Xo.rgb(t)).r,t.g,t.b):K(+t,+e,+n)};var Gs=18,Hs=.95047,js=1,qs=1.08883,Ys=$.prototype=new q;Ys.brighter=function(t){return K(Math.min(100,this.l+Gs*(arguments.length?t:1)),this.a,this.b)},Ys.darker=function(t){return K(Math.max(0,this.l-Gs*(arguments.length?t:1)),this.a,this.b)},Ys.rgb=function(){return Q(this.l,this.a,this.b)},Xo.rgb=function(t,e,n){return 1===arguments.length?t instanceof se?oe(t.r,t.g,t.b):ue(""+t,oe,U):oe(~~t,~~e,~~n)};var Ws=se.prototype=new q;Ws.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&r>e&&(e=r),n&&r>n&&(n=r),i&&r>i&&(i=r),oe(Math.min(255,~~(e/t)),Math.min(255,~~(n/t)),Math.min(255,~~(i/t)))):oe(r,r,r)},Ws.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),oe(~~(t*this.r),~~(t*this.g),~~(t*this.b))},Ws.hsl=function(){return ce(this.r,this.g,this.b)},Ws.toString=function(){return"#"+le(this.r)+le(this.g)+le(this.b)};var Us=Xo.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Us.forEach(function(t,e){Us.set(t,re(e))}),Xo.functor=fe,Xo.xhr=me(ge),Xo.dsv=function(t,e){function n(t,n,a){3>arguments.length&&(a=n,n=null);var o=Xo.xhr(t,e,a);return o.row=function(t){return arguments.length?o.response(null==(n=t)?i:r(t)):n},o.row(n)}function i(t){return n.parse(t.responseText)}function r(t){return function(e){return n.parse(e.responseText,t)}}function o(e){return e.map(s).join(t)}function s(t){return l.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var l=RegExp('["'+t+"\n]"),u=t.charCodeAt(0);return n.parse=function(t,e){var i;return n.parseRows(t,function(t,n){if(i)return i(t,n-1);var r=Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");i=e?function(t,n){return e(r(t),n)}:r})},n.parseRows=function(t,e){function n(){if(c>=l)return o;if(r)return r=!1,a;var e=c;if(34===t.charCodeAt(e)){for(var n=e;l>n++;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}c=n+2;var i=t.charCodeAt(n+1);return 13===i?(r=!0,10===t.charCodeAt(n+2)&&++c):10===i&&(r=!0),t.substring(e+1,n).replace(/""/g,'"')}for(;l>c;){var i=t.charCodeAt(c++),s=1;if(10===i)r=!0;else if(13===i)r=!0,10===t.charCodeAt(c)&&(++c,++s);else if(i!==u)continue;return t.substring(e,c-s)}return t.substring(e)}for(var i,r,a={},o={},s=[],l=t.length,c=0,h=0;(i=n())!==o;){for(var d=[];i!==a&&i!==o;)d.push(i),i=n();(!e||(d=e(d,h++)))&&s.push(d)}return s},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var i=new a,r=[];return e.forEach(function(t){for(var e in t)i.has(e)||r.push(i.add(e))}),[r.map(s).join(t)].concat(e.map(function(e){return r.map(function(t){return s(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(o).join("\n")},n},Xo.csv=Xo.dsv(",","text/csv"),Xo.tsv=Xo.dsv("	","text/tab-separated-values");var Xs,Js,Zs,Ks,$s,Qs=Qo[s(Qo,"requestAnimationFrame")]||function(t){setTimeout(t,17)};Xo.timer=function(t,e,n){var i=arguments.length;2>i&&(e=0),3>i&&(n=Date.now());var r=n+e,a={c:t,t:r,f:!1,n:null};Js?Js.n=a:Xs=a,Js=a,Zs||(Ks=clearTimeout(Ks),Zs=1,Qs(ye))},Xo.timer.flush=function(){xe(),be()};var tl=".",el=",",nl=[3,3],il="$",rl=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(Ae);Xo.formatPrefix=function(t,e){var n=0;return t&&(0>t&&(t*=-1),e&&(t=Xo.round(t,ke(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((0>=n?n+1:n-1)/3)))),rl[8+n/3]},Xo.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},Xo.format=function(t){var e=al.exec(t),n=e[1]||" ",i=e[2]||">",r=e[3]||"",a=e[4]||"",o=e[5],s=+e[6],l=e[7],u=e[8],c=e[9],h=1,d="",p=!1;switch(u&&(u=+u.substring(1)),(o||"0"===n&&"="===i)&&(o=n="0",i="=",l&&(s-=Math.floor((s-1)/4))),c){case"n":l=!0,c="g";break;case"%":h=100,d="%",c="f";break;case"p":h=100,d="%",c="r";break;case"b":case"o":case"x":case"X":"#"===a&&(a="0"+c.toLowerCase());case"c":case"d":p=!0,u=0;break;case"s":h=-1,c="r"}"#"===a?a="":"$"===a&&(a=il),"r"!=c||u||(c="g"),null!=u&&("g"==c?u=Math.max(1,Math.min(21,u)):("e"==c||"f"==c)&&(u=Math.max(0,Math.min(20,u)))),c=ol.get(c)||Pe;var f=o&&l;return function(t){if(p&&t%1)return"";var e=0>t||0===t&&0>1/t?(t=-t,"-"):r;if(0>h){var g=Xo.formatPrefix(t,u);t=g.scale(t),d=g.symbol}else t*=h;t=c(t,u);var m=t.lastIndexOf("."),v=0>m?t:t.substring(0,m),_=0>m?"":tl+t.substring(m+1);!o&&l&&(v=sl(v));var y=a.length+v.length+_.length+(f?0:e.length),x=s>y?Array(y=s-y+1).join(n):"";return f&&(v=sl(x+v)),e+=a,t=v+_,("<"===i?e+t+x:">"===i?x+e+t:"^"===i?x.substring(0,y>>=1)+e+t+x.substring(y):e+(f?t:x+t))+d}};var al=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ol=Xo.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=Xo.round(t,ke(t,e))).toFixed(Math.max(0,Math.min(20,ke(t*(1+1e-15),e))))}}),sl=ge;if(nl){var ll=nl.length;sl=function(t){for(var e=t.length,n=[],i=0,r=nl[0];e>0&&r>0;)n.push(t.substring(e-=r,e+r)),r=nl[i=(i+1)%ll];return n.reverse().join(el)}}Xo.geo={},Se.prototype={s:0,t:0,add:function(t){we(t,this.t,ul),we(ul.s,this.s,this),this.s?this.t+=ul.t:this.s=ul.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ul=new Se;Xo.geo.stream=function(t,e){t&&cl.hasOwnProperty(t.type)?cl[t.type](t,e):Me(t,e)};var cl={Feature:function(t,e){Me(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;r>++i;)Me(n[i].geometry,e)}},hl={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;r>++i;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Te(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;r>++i;)Te(n[i],e,0)},Polygon:function(t,e){Oe(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;r>++i;)Oe(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;r>++i;)Me(n[i],e)}};Xo.geo.area=function(t){return dl=0,Xo.geo.stream(t,fl),dl};var dl,pl=new Se,fl={sphere:function(){dl+=4*ws},point:l,lineStart:l,lineEnd:l,polygonStart:function(){pl.reset(),fl.lineStart=Ee},polygonEnd:function(){var t=2*pl;dl+=0>t?4*ws+t:t,fl.lineStart=fl.lineEnd=fl.point=l}};Xo.geo.bounds=function(){function t(t,e){y.push(x=[c=t,d=t]),h>e&&(h=e),e>p&&(p=e)}function e(e,n){var i=De([e*Ds,n*Ds]);if(v){var r=Fe(v,i),a=[r[1],-r[0],0],o=Fe(a,r);Ce(o),o=Ne(o);var l=e-f,u=l>0?1:-1,g=o[0]*Ls*u,m=ls(l)>180;if(m^(g>u*f&&u*e>g)){var _=o[1]*Ls;_>p&&(p=_)}else if(g=(g+360)%360-180,m^(g>u*f&&u*e>g)){var _=-o[1]*Ls;h>_&&(h=_)}else h>n&&(h=n),n>p&&(p=n);m?f>e?s(c,e)>s(c,d)&&(d=e):s(e,d)>s(c,d)&&(c=e):d>=c?(c>e&&(c=e),e>d&&(d=e)):e>f?s(c,e)>s(c,d)&&(d=e):s(e,d)>s(c,d)&&(c=e)}else t(e,n);v=i,f=e}function n(){b.point=e}function i(){x[0]=c,x[1]=d,b.point=t,v=null}function r(t,n){if(v){var i=t-f;_+=ls(i)>180?i+(i>0?360:-360):i}else g=t,m=n;fl.point(t,n),e(t,n)}function a(){fl.lineStart()}function o(){r(g,m),fl.lineEnd(),ls(_)>Os&&(c=-(d=180)),x[0]=c,x[1]=d,v=null}function s(t,e){return 0>(e-=t)?e+360:e}function l(t,e){return t[0]-e[0]}function u(t,e){return e[0]<=e[1]?t>=e[0]&&e[1]>=t:e[0]>t||t>e[1]}var c,h,d,p,f,g,m,v,_,y,x,b={point:t,lineStart:n,lineEnd:i,polygonStart:function(){b.point=r,b.lineStart=a,b.lineEnd=o,_=0,fl.polygonStart()},polygonEnd:function(){fl.polygonEnd(),b.point=t,b.lineStart=n,b.lineEnd=i,0>pl?(c=-(d=180),h=-(p=90)):_>Os?p=90:-Os>_&&(h=-90),x[0]=c,x[1]=d}};return function(t){p=d=-(c=h=1/0),y=[],Xo.geo.stream(t,b);var e=y.length;if(e){y.sort(l);for(var n,i=1,r=y[0],a=[r];e>i;++i)n=y[i],u(n[0],r)||u(n[1],r)?(s(r[0],n[1])>s(r[0],r[1])&&(r[1]=n[1]),s(n[0],r[1])>s(r[0],r[1])&&(r[0]=n[0])):a.push(r=n);for(var o,n,f=-1/0,e=a.length-1,i=0,r=a[e];e>=i;r=n,++i)n=a[i],(o=s(r[1],n[0]))>f&&(f=o,c=n[0],d=r[1])}return y=x=null,1/0===c||1/0===h?[[0/0,0/0],[0/0,0/0]]:[[c,h],[d,p]]}}(),Xo.geo.centroid=function(t){gl=ml=vl=_l=yl=xl=bl=Al=kl=Pl=Sl=0,Xo.geo.stream(t,wl);var e=kl,n=Pl,i=Sl,r=e*e+n*n+i*i;return Es>r&&(e=xl,n=bl,i=Al,Os>ml&&(e=vl,n=_l,i=yl),r=e*e+n*n+i*i,Es>r)?[0/0,0/0]:[Math.atan2(n,e)*Ls,I(i/Math.sqrt(r))*Ls]};var gl,ml,vl,_l,yl,xl,bl,Al,kl,Pl,Sl,wl={sphere:l,point:Ie,lineStart:Ge,lineEnd:He,polygonStart:function(){wl.lineStart=je},polygonEnd:function(){wl.lineStart=Ge}},Ml=Xe(qe,Qe,en,[-ws,-ws/2]),Tl=1e9;Xo.geo.clipExtent=function(){var t,e,n,i,r,a,o={stream:function(t){return r&&(r.valid=!1),r=a(t),r.valid=!0,r},extent:function(s){return arguments.length?(a=an(t=+s[0][0],e=+s[0][1],n=+s[1][0],i=+s[1][1]),r&&(r.valid=!1,r=null),o):[[t,e],[n,i]]}};return o.extent([[0,0],[960,500]])},(Xo.geo.conicEqualArea=function(){return sn(ln)}).raw=ln,Xo.geo.albers=function(){return Xo.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Xo.geo.albersUsa=function(){function t(t){var a=t[0],o=t[1];return e=null,n(a,o),e||(i(a,o),e)||r(a,o),e}var e,n,i,r,a=Xo.geo.albers(),o=Xo.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=Xo.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=a.scale(),n=a.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&.234>r&&i>=-.425&&-.214>i?o:r>=.166&&.234>r&&i>=-.214&&-.115>i?s:a).invert(t)},t.stream=function(t){var e=a.stream(t),n=o.stream(t),i=s.stream(t);return{point:function(t,r){e.point(t,r),n.point(t,r),i.point(t,r)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},t.precision=function(e){return arguments.length?(a.precision(e),o.precision(e),s.precision(e),t):a.precision()},t.scale=function(e){return arguments.length?(a.scale(e),o.scale(.35*e),s.scale(e),t.translate(a.translate())):a.scale()},t.translate=function(e){if(!arguments.length)return a.translate();var u=a.scale(),c=+e[0],h=+e[1];return n=a.translate(e).clipExtent([[c-.455*u,h-.238*u],[c+.455*u,h+.238*u]]).stream(l).point,i=o.translate([c-.307*u,h+.201*u]).clipExtent([[c-.425*u+Os,h+.12*u+Os],[c-.214*u-Os,h+.234*u-Os]]).stream(l).point,r=s.translate([c-.205*u,h+.212*u]).clipExtent([[c-.214*u+Os,h+.166*u+Os],[c-.115*u-Os,h+.234*u-Os]]).stream(l).point,t},t.scale(1070)};var Ol,El,Dl,Ll,Fl,zl,Vl={point:l,lineStart:l,lineEnd:l,polygonStart:function(){El=0,Vl.lineStart=un},polygonEnd:function(){Vl.lineStart=Vl.lineEnd=Vl.point=l,Ol+=ls(El/2)}},Cl={point:cn,lineStart:l,lineEnd:l,polygonStart:l,polygonEnd:l},Nl={point:pn,lineStart:fn,lineEnd:gn,polygonStart:function(){Nl.lineStart=mn},polygonEnd:function(){Nl.point=pn,Nl.lineStart=fn,Nl.lineEnd=gn}};Xo.geo.path=function(){function t(t){return t&&("function"==typeof s&&a.pointRadius(+s.apply(this,arguments)),o&&o.valid||(o=r(a)),Xo.geo.stream(t,o)),a.result()}function e(){return o=null,t}var n,i,r,a,o,s=4.5;return t.area=function(t){return Ol=0,Xo.geo.stream(t,r(Vl)),Ol},t.centroid=function(t){return vl=_l=yl=xl=bl=Al=kl=Pl=Sl=0,Xo.geo.stream(t,r(Nl)),Sl?[kl/Sl,Pl/Sl]:Al?[xl/Al,bl/Al]:yl?[vl/yl,_l/yl]:[0/0,0/0]},t.bounds=function(t){return Fl=zl=-(Dl=Ll=1/0),Xo.geo.stream(t,r(Cl)),[[Dl,Ll],[Fl,zl]]},t.projection=function(t){return arguments.length?(r=(n=t)?t.stream||yn(t):ge,e()):n},t.context=function(t){return arguments.length?(a=null==(i=t)?new hn:new vn(t),"function"!=typeof s&&a.pointRadius(s),e()):i},t.pointRadius=function(e){return arguments.length?(s="function"==typeof e?e:(a.pointRadius(+e),+e),t):s},t.projection(Xo.geo.albersUsa()).context(null)},Xo.geo.transform=function(t){return{stream:function(e){var n=new xn(e);for(var i in t)n[i]=t[i];return n}}},xn.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()
},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Xo.geo.projection=An,Xo.geo.projectionMutator=kn,(Xo.geo.equirectangular=function(){return An(Sn)}).raw=Sn.invert=Sn,Xo.geo.rotation=function(t){function e(e){return e=t(e[0]*Ds,e[1]*Ds),e[0]*=Ls,e[1]*=Ls,e}return t=Mn(t[0]%360*Ds,t[1]*Ds,t.length>2?t[2]*Ds:0),e.invert=function(e){return e=t.invert(e[0]*Ds,e[1]*Ds),e[0]*=Ls,e[1]*=Ls,e},e},wn.invert=Sn,Xo.geo.circle=function(){function t(){var t="function"==typeof i?i.apply(this,arguments):i,e=Mn(-t[0]*Ds,-t[1]*Ds,0).invert,r=[];return n(null,null,1,{point:function(t,n){r.push(t=e(t,n)),t[0]*=Ls,t[1]*=Ls}}),{type:"Polygon",coordinates:[r]}}var e,n,i=[0,0],r=6;return t.origin=function(e){return arguments.length?(i=e,t):i},t.angle=function(i){return arguments.length?(n=Dn((e=+i)*Ds,r*Ds),t):e},t.precision=function(i){return arguments.length?(n=Dn(e*Ds,(r=+i)*Ds),t):r},t.angle(90)},Xo.geo.distance=function(t,e){var n,i=(e[0]-t[0])*Ds,r=t[1]*Ds,a=e[1]*Ds,o=Math.sin(i),s=Math.cos(i),l=Math.sin(r),u=Math.cos(r),c=Math.sin(a),h=Math.cos(a);return Math.atan2(Math.sqrt((n=h*o)*n+(n=u*c-l*h*s)*n),l*c+u*h*s)},Xo.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return Xo.range(Math.ceil(a/m)*m,r,m).map(d).concat(Xo.range(Math.ceil(u/v)*v,l,v).map(p)).concat(Xo.range(Math.ceil(i/f)*f,n,f).filter(function(t){return ls(t%m)>Os}).map(c)).concat(Xo.range(Math.ceil(s/g)*g,o,g).filter(function(t){return ls(t%v)>Os}).map(h))}var n,i,r,a,o,s,l,u,c,h,d,p,f=10,g=f,m=90,v=360,_=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[d(a).concat(p(l).slice(1),d(r).reverse().slice(1),p(u).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(a=+e[0][0],r=+e[1][0],u=+e[0][1],l=+e[1][1],a>r&&(e=a,a=r,r=e),u>l&&(e=u,u=l,l=e),t.precision(_)):[[a,u],[r,l]]},t.minorExtent=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],s=+e[0][1],o=+e[1][1],i>n&&(e=i,i=n,n=e),s>o&&(e=s,s=o,o=e),t.precision(_)):[[i,s],[n,o]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(m=+e[0],v=+e[1],t):[m,v]},t.minorStep=function(e){return arguments.length?(f=+e[0],g=+e[1],t):[f,g]},t.precision=function(e){return arguments.length?(_=+e,c=Fn(s,o,90),h=zn(i,n,_),d=Fn(u,l,90),p=zn(a,r,_),t):_},t.majorExtent([[-180,-90+Os],[180,90-Os]]).minorExtent([[-180,-80-Os],[180,80+Os]])},Xo.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||i.apply(this,arguments),n||r.apply(this,arguments)]}}var e,n,i=Vn,r=Cn;return t.distance=function(){return Xo.geo.distance(e||i.apply(this,arguments),n||r.apply(this,arguments))},t.source=function(n){return arguments.length?(i=n,e="function"==typeof n?null:n,t):i},t.target=function(e){return arguments.length?(r=e,n="function"==typeof e?null:e,t):r},t.precision=function(){return arguments.length?t:0},t},Xo.geo.interpolate=function(t,e){return Nn(t[0]*Ds,t[1]*Ds,e[0]*Ds,e[1]*Ds)},Xo.geo.length=function(t){return Rl=0,Xo.geo.stream(t,Il),Rl};var Rl,Il={sphere:l,point:l,lineStart:Rn,lineEnd:l,polygonStart:l,polygonEnd:l},Bl=In(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(Xo.geo.azimuthalEqualArea=function(){return An(Bl)}).raw=Bl;var Gl=In(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},ge);(Xo.geo.azimuthalEquidistant=function(){return An(Gl)}).raw=Gl,(Xo.geo.conicConformal=function(){return sn(Bn)}).raw=Bn,(Xo.geo.conicEquidistant=function(){return sn(Gn)}).raw=Gn;var Hl=In(function(t){return 1/t},Math.atan);(Xo.geo.gnomonic=function(){return An(Hl)}).raw=Hl,Hn.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Ts]},(Xo.geo.mercator=function(){return jn(Hn)}).raw=Hn;var jl=In(function(){return 1},Math.asin);(Xo.geo.orthographic=function(){return An(jl)}).raw=jl;var ql=In(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(Xo.geo.stereographic=function(){return An(ql)}).raw=ql,qn.invert=function(t,e){return[Math.atan2(B(t),Math.cos(e)),I(Math.sin(e)/G(t))]},(Xo.geo.transverseMercator=function(){return jn(qn)}).raw=qn,Xo.geom={},Xo.geom.hull=function(t){function e(t){if(3>t.length)return[];var e,r,a,o,s,l,u,c,h,d,p,f,g=fe(n),m=fe(i),v=t.length,_=v-1,y=[],x=[],b=0;if(g===Yn&&i===Wn)e=t;else for(a=0,e=[];v>a;++a)e.push([+g.call(this,r=t[a],a),+m.call(this,r,a)]);for(a=1;v>a;++a)(e[a][1]<e[b][1]||e[a][1]==e[b][1]&&e[a][0]<e[b][0])&&(b=a);for(a=0;v>a;++a)a!==b&&(l=e[a][1]-e[b][1],s=e[a][0]-e[b][0],y.push({angle:Math.atan2(l,s),index:a}));for(y.sort(function(t,e){return t.angle-e.angle}),p=y[0].angle,d=y[0].index,h=0,a=1;_>a;++a){if(o=y[a].index,p==y[a].angle){if(s=e[d][0]-e[b][0],l=e[d][1]-e[b][1],u=e[o][0]-e[b][0],c=e[o][1]-e[b][1],s*s+l*l>=u*u+c*c){y[a].index=-1;continue}y[h].index=-1}p=y[a].angle,h=a,d=o}for(x.push(b),a=0,o=0;2>a;++o)y[o].index>-1&&(x.push(y[o].index),a++);for(f=x.length;_>o;++o)if(!(0>y[o].index)){for(;!Un(x[f-2],x[f-1],y[o].index,e);)--f;x[f++]=y[o].index}var A=[];for(a=f-1;a>=0;--a)A.push(t[x[a]]);return A}var n=Yn,i=Wn;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e)},Xo.geom.polygon=function(t){return ps(t,Yl),t};var Yl=Xo.geom.polygon.prototype=[];Yl.area=function(){for(var t,e=-1,n=this.length,i=this[n-1],r=0;n>++e;)t=i,i=this[e],r+=t[1]*i[0]-t[0]*i[1];return.5*r},Yl.centroid=function(t){var e,n,i=-1,r=this.length,a=0,o=0,s=this[r-1];for(arguments.length||(t=-1/(6*this.area()));r>++i;)e=s,s=this[i],n=e[0]*s[1]-s[0]*e[1],a+=(e[0]+s[0])*n,o+=(e[1]+s[1])*n;return[a*t,o*t]},Yl.clip=function(t){for(var e,n,i,r,a,o,s=Zn(t),l=-1,u=this.length-Zn(this),c=this[u-1];u>++l;){for(e=t.slice(),t.length=0,r=this[l],a=e[(i=e.length-s)-1],n=-1;i>++n;)o=e[n],Xn(o,c,r)?(Xn(a,c,r)||t.push(Jn(a,o,c,r)),t.push(o)):Xn(a,c,r)&&t.push(Jn(a,o,c,r)),a=o;s&&t.push(t[0]),c=r}return t};var Wl,Ul,Xl,Jl,Zl,Kl=[],$l=[];ri.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)t=e[n].edge,t.b&&t.a||e.splice(n,1);return e.sort(oi),e.length},mi.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},vi.prototype={insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=bi(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)i=n.U,n===i.L?(r=i.R,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(yi(this,n),t=n,n=t.U),n.C=!1,i.C=!0,xi(this,i))):(r=i.L,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(xi(this,n),t=n,n=t.U),n.C=!1,i.C=!0,yi(this,i))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,a=t.L,o=t.R;if(n=a?o?bi(o):a:o,r?r.L===t?r.L=n:r.R=n:this._=n,a&&o?(i=n.C,n.C=t.C,n.L=a,a.U=n,n!==o?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=o,o.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i){if(t&&t.C)return t.C=!1,void 0;do{if(t===this._)break;if(t===r.L){if(e=r.R,e.C&&(e.C=!1,r.C=!0,yi(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,xi(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,yi(this,r),t=this._;break}}else if(e=r.L,e.C&&(e.C=!1,r.C=!0,xi(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,yi(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,xi(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},Xo.geom.voronoi=function(t){function e(t){var e=Array(t.length),i=s[0][0],r=s[0][1],a=s[1][0],o=s[1][1];return Ai(n(t),s).cells.forEach(function(n,s){var l=n.edges,u=n.site,c=e[s]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=i&&a>=u.x&&u.y>=r&&o>=u.y?[[i,o],[a,o],[a,r],[i,r]]:[];c.point=t[s]}),e}function n(t){return t.map(function(t,e){return{x:Math.round(a(t,e)/Os)*Os,y:Math.round(o(t,e)/Os)*Os,i:e}})}var i=Yn,r=Wn,a=i,o=r,s=Ql;return t?e(t):(e.links=function(t){return Ai(n(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return Ai(n(t)).cells.forEach(function(n,i){for(var r,a,o=n.site,s=n.edges.sort(oi),l=-1,u=s.length,c=s[u-1].edge,h=c.l===o?c.r:c.l;u>++l;)r=c,a=h,c=s[l].edge,h=c.l===o?c.r:c.l,a.i>i&&h.i>i&&0>Pi(o,a,h)&&e.push([t[i],t[a.i],t[h.i]])}),e},e.x=function(t){return arguments.length?(a=fe(i=t),e):i},e.y=function(t){return arguments.length?(o=fe(r=t),e):r},e.clipExtent=function(t){return arguments.length?(s=null==t?Ql:t,e):s===Ql?null:s},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):s===Ql?null:s&&s[1]},e)};var Ql=[[-1e6,-1e6],[1e6,1e6]];Xo.geom.delaunay=function(t){return Xo.geom.voronoi().triangles(t)},Xo.geom.quadtree=function(t,e,n,i,r){function a(t){function a(t,e,n,i,r,a,o,s){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var l=t.x,c=t.y;if(null!=l)if(.01>ls(l-n)+ls(c-i))u(t,e,n,i,r,a,o,s);else{var h=t.point;t.x=t.y=t.point=null,u(t,h,l,c,r,a,o,s),u(t,e,n,i,r,a,o,s)}else t.x=n,t.y=i,t.point=e}else u(t,e,n,i,r,a,o,s)}function u(t,e,n,i,r,o,s,l){var u=.5*(r+s),c=.5*(o+l),h=n>=u,d=i>=c,p=(d<<1)+h;t.leaf=!1,t=t.nodes[p]||(t.nodes[p]=Mi()),h?r=u:s=u,d?o=c:l=c,a(t,e,n,i,r,o,s,l)}var c,h,d,p,f,g,m,v,_,y=fe(s),x=fe(l);if(null!=e)g=e,m=n,v=i,_=r;else if(v=_=-(g=m=1/0),h=[],d=[],f=t.length,o)for(p=0;f>p;++p)c=t[p],g>c.x&&(g=c.x),m>c.y&&(m=c.y),c.x>v&&(v=c.x),c.y>_&&(_=c.y),h.push(c.x),d.push(c.y);else for(p=0;f>p;++p){var b=+y(c=t[p],p),A=+x(c,p);g>b&&(g=b),m>A&&(m=A),b>v&&(v=b),A>_&&(_=A),h.push(b),d.push(A)}var k=v-g,P=_-m;k>P?_=m+k:v=g+P;var S=Mi();if(S.add=function(t){a(S,t,+y(t,++p),+x(t,p),g,m,v,_)},S.visit=function(t){Ti(t,S,g,m,v,_)},p=-1,null==e){for(;f>++p;)a(S,t[p],h[p],d[p],g,m,v,_);--p}else t.forEach(S.add);return h=d=t=c=null,S}var o,s=Yn,l=Wn;return(o=arguments.length)?(s=Si,l=wi,3===o&&(r=n,i=e,n=e=0),a(t)):(a.x=function(t){return arguments.length?(s=t,a):s},a.y=function(t){return arguments.length?(l=t,a):l},a.extent=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),a):null==e?null:[[e,n],[i,r]]},a.size=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=n=0,i=+t[0],r=+t[1]),a):null==e?null:[i-e,r-n]},a)},Xo.interpolateRgb=Oi,Xo.interpolateObject=Ei,Xo.interpolateNumber=Di,Xo.interpolateString=Li;var tu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;Xo.interpolate=Fi,Xo.interpolators=[function(t,e){var n=typeof e;return("string"===n?Us.has(e)||/^(#|rgb\(|hsl\()/.test(e)?Oi:Li:e instanceof q?Oi:"object"===n?Array.isArray(e)?zi:Ei:Di)(t,e)}],Xo.interpolateArray=zi;var eu=function(){return ge},nu=Xo.map({linear:eu,poly:Gi,quad:function(){return Ri},cubic:function(){return Ii},sin:function(){return Hi},exp:function(){return ji},circle:function(){return qi},elastic:Yi,back:Wi,bounce:function(){return Ui}}),iu=Xo.map({"in":ge,out:Ci,"in-out":Ni,"out-in":function(t){return Ni(Ci(t))}});Xo.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.substring(0,e):t,i=e>=0?t.substring(e+1):"in";return n=nu.get(n)||eu,i=iu.get(i)||ge,Vi(i(n.apply(null,Jo.call(arguments,1))))},Xo.interpolateHcl=Xi,Xo.interpolateHsl=Ji,Xo.interpolateLab=Zi,Xo.interpolateRound=Ki,Xo.transform=function(t){var e=Ko.createElementNS(Xo.ns.prefix.svg,"g");return(Xo.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new $i(n?n.matrix:ru)})(t)},$i.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ru={a:1,b:0,c:0,d:1,e:0,f:0};Xo.interpolateTransform=nr,Xo.layout={},Xo.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;i>++n;)e.push(ar(t[n]));return e}},Xo.layout.chord=function(){function t(){var t,u,h,d,p,f={},g=[],m=Xo.range(a),v=[];for(n=[],i=[],t=0,d=-1;a>++d;){for(u=0,p=-1;a>++p;)u+=r[d][p];g.push(u),v.push(Xo.range(a)),t+=u}for(o&&m.sort(function(t,e){return o(g[t],g[e])}),s&&v.forEach(function(t,e){t.sort(function(t,n){return s(r[e][t],r[e][n])})}),t=(Ms-c*a)/t,u=0,d=-1;a>++d;){for(h=u,p=-1;a>++p;){var _=m[d],y=v[_][p],x=r[_][y],b=u,A=u+=x*t;f[_+"-"+y]={index:_,subindex:y,startAngle:b,endAngle:A,value:x}}i[_]={index:_,startAngle:h,endAngle:u,value:(u-h)/t},u+=c}for(d=-1;a>++d;)for(p=d-1;a>++p;){var k=f[d+"-"+p],P=f[p+"-"+d];(k.value||P.value)&&n.push(k.value<P.value?{source:P,target:k}:{source:k,target:P})}l&&e()}function e(){n.sort(function(t,e){return l((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,i,r,a,o,s,l,u={},c=0;return u.matrix=function(t){return arguments.length?(a=(r=t)&&r.length,n=i=null,u):r},u.padding=function(t){return arguments.length?(c=t,n=i=null,u):c},u.sortGroups=function(t){return arguments.length?(o=t,n=i=null,u):o},u.sortSubgroups=function(t){return arguments.length?(s=t,n=null,u):s},u.sortChords=function(t){return arguments.length?(l=t,n&&e(),u):l},u.chords=function(){return n||t(),n},u.groups=function(){return i||t(),i},u},Xo.layout.force=function(){function t(t){return function(e,n,i,r){if(e.point!==t){var a=e.cx-t.x,o=e.cy-t.y,s=1/Math.sqrt(a*a+o*o);if(g>(r-n)*s){var l=e.charge*s*s;return t.px-=a*l,t.py-=o*l,!0}if(e.point&&isFinite(s)){var l=e.pointCharge*s*s;t.px-=a*l,t.py-=o*l}}return!e.charge}}function e(t){t.px=Xo.event.x,t.py=Xo.event.y,s.resume()}var n,i,r,a,o,s={},l=Xo.dispatch("start","tick","end"),u=[1,1],c=.9,h=au,d=ou,p=-30,f=.1,g=.8,m=[],v=[];return s.tick=function(){if(.005>(i*=.99))return l.end({type:"end",alpha:i=0}),!0;var e,n,s,h,d,g,_,y,x,b=m.length,A=v.length;for(n=0;A>n;++n)s=v[n],h=s.source,d=s.target,y=d.x-h.x,x=d.y-h.y,(g=y*y+x*x)&&(g=i*a[n]*((g=Math.sqrt(g))-r[n])/g,y*=g,x*=g,d.x-=y*(_=h.weight/(d.weight+h.weight)),d.y-=x*_,h.x+=y*(_=1-_),h.y+=x*_);if((_=i*f)&&(y=u[0]/2,x=u[1]/2,n=-1,_))for(;b>++n;)s=m[n],s.x+=(y-s.x)*_,s.y+=(x-s.y)*_;if(p)for(dr(e=Xo.geom.quadtree(m),i,o),n=-1;b>++n;)(s=m[n]).fixed||e.visit(t(s));for(n=-1;b>++n;)s=m[n],s.fixed?(s.x=s.px,s.y=s.py):(s.x-=(s.px-(s.px=s.x))*c,s.y-=(s.py-(s.py=s.y))*c);l.tick({type:"tick",alpha:i})},s.nodes=function(t){return arguments.length?(m=t,s):m},s.links=function(t){return arguments.length?(v=t,s):v},s.size=function(t){return arguments.length?(u=t,s):u},s.linkDistance=function(t){return arguments.length?(h="function"==typeof t?t:+t,s):h},s.distance=s.linkDistance,s.linkStrength=function(t){return arguments.length?(d="function"==typeof t?t:+t,s):d},s.friction=function(t){return arguments.length?(c=+t,s):c},s.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,s):p},s.gravity=function(t){return arguments.length?(f=+t,s):f},s.theta=function(t){return arguments.length?(g=+t,s):g},s.alpha=function(t){return arguments.length?(t=+t,i?i=t>0?t:0:t>0&&(l.start({type:"start",alpha:i=t}),Xo.timer(s.tick)),s):i},s.start=function(){function t(t,i){if(!n){for(n=Array(l),s=0;l>s;++s)n[s]=[];for(s=0;u>s;++s){var r=v[s];n[r.source.index].push(r.target),n[r.target.index].push(r.source)}}for(var a,o=n[e],s=-1,u=o.length;u>++s;)if(!isNaN(a=o[s][t]))return a;return Math.random()*i}var e,n,i,l=m.length,c=v.length,f=u[0],g=u[1];for(e=0;l>e;++e)(i=m[e]).index=e,i.weight=0;for(e=0;c>e;++e)i=v[e],"number"==typeof i.source&&(i.source=m[i.source]),"number"==typeof i.target&&(i.target=m[i.target]),++i.source.weight,++i.target.weight;for(e=0;l>e;++e)i=m[e],isNaN(i.x)&&(i.x=t("x",f)),isNaN(i.y)&&(i.y=t("y",g)),isNaN(i.px)&&(i.px=i.x),isNaN(i.py)&&(i.py=i.y);if(r=[],"function"==typeof h)for(e=0;c>e;++e)r[e]=+h.call(this,v[e],e);else for(e=0;c>e;++e)r[e]=h;if(a=[],"function"==typeof d)for(e=0;c>e;++e)a[e]=+d.call(this,v[e],e);else for(e=0;c>e;++e)a[e]=d;if(o=[],"function"==typeof p)for(e=0;l>e;++e)o[e]=+p.call(this,m[e],e);else for(e=0;l>e;++e)o[e]=p;return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){return n||(n=Xo.behavior.drag().origin(ge).on("dragstart.force",lr).on("drag.force",e).on("dragend.force",ur)),arguments.length?(this.on("mouseover.force",cr).on("mouseout.force",hr).call(n),void 0):n},Xo.rebind(s,l,"on")};var au=20,ou=1;Xo.layout.hierarchy=function(){function t(e,o,s){var l=r.call(n,e,o);if(e.depth=o,s.push(e),l&&(u=l.length)){for(var u,c,h=-1,d=e.children=Array(u),p=0,f=o+1;u>++h;)c=d[h]=t(l[h],f,s),c.parent=e,p+=c.value;i&&d.sort(i),a&&(e.value=p)}else delete e.children,a&&(e.value=+a.call(n,e,o)||0);return e}function e(t,i){var r=t.children,o=0;if(r&&(s=r.length))for(var s,l=-1,u=i+1;s>++l;)o+=e(r[l],u);else a&&(o=+a.call(n,t,i)||0);return a&&(t.value=o),o}function n(e){var n=[];return t(e,0,n),n}var i=mr,r=fr,a=gr;return n.sort=function(t){return arguments.length?(i=t,n):i},n.children=function(t){return arguments.length?(r=t,n):r},n.value=function(t){return arguments.length?(a=t,n):a},n.revalue=function(t){return e(t,0),t},n},Xo.layout.partition=function(){function t(e,n,i,r){var a=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,a&&(o=a.length)){var o,s,l,u=-1;for(i=e.value?i/e.value:0;o>++u;)t(s=a[u],n,l=s.value*i,r),n+=l}}function e(t){var n=t.children,i=0;if(n&&(r=n.length))for(var r,a=-1;r>++a;)i=Math.max(i,e(n[a]));return 1+i}function n(n,a){var o=i.call(this,n,a);return t(o[0],0,r[0],r[1]/e(o[0])),o}var i=Xo.layout.hierarchy(),r=[1,1];return n.size=function(t){return arguments.length?(r=t,n):r},pr(n,i)},Xo.layout.pie=function(){function t(a){var o=a.map(function(n,i){return+e.call(t,n,i)}),s=+("function"==typeof i?i.apply(this,arguments):i),l=(("function"==typeof r?r.apply(this,arguments):r)-s)/Xo.sum(o),u=Xo.range(a.length);null!=n&&u.sort(n===su?function(t,e){return o[e]-o[t]}:function(t,e){return n(a[t],a[e])});var c=[];return u.forEach(function(t){var e;c[t]={data:a[t],value:e=o[t],startAngle:s,endAngle:s+=e*l}}),c}var e=Number,n=su,i=0,r=Ms;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(i=e,t):i},t.endAngle=function(e){return arguments.length?(r=e,t):r},t};var su={};Xo.layout.stack=function(){function t(s,l){var u=s.map(function(n,i){return e.call(t,n,i)}),c=u.map(function(e){return e.map(function(e,n){return[a.call(t,e,n),o.call(t,e,n)]})}),h=n.call(t,c,l);u=Xo.permute(u,h),c=Xo.permute(c,h);var d,p,f,g=i.call(t,c,l),m=u.length,v=u[0].length;for(p=0;v>p;++p)for(r.call(t,u[0][p],f=g[p],c[0][p][1]),d=1;m>d;++d)r.call(t,u[d][p],f+=c[d-1][p][1],c[d][p][1]);return s}var e=ge,n=br,i=Ar,r=xr,a=_r,o=yr;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:lu.get(e)||br,t):n},t.offset=function(e){return arguments.length?(i="function"==typeof e?e:uu.get(e)||Ar,t):i},t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(o=e,t):o},t.out=function(e){return arguments.length?(r=e,t):r},t};var lu=Xo.map({"inside-out":function(t){var e,n,i=t.length,r=t.map(kr),a=t.map(Pr),o=Xo.range(i).sort(function(t,e){return r[t]-r[e]}),s=0,l=0,u=[],c=[];for(e=0;i>e;++e)n=o[e],l>s?(s+=a[n],u.push(n)):(l+=a[n],c.push(n));return c.reverse().concat(u)},reverse:function(t){return Xo.range(t.length).reverse()},"default":br}),uu=Xo.map({silhouette:function(t){var e,n,i,r=t.length,a=t[0].length,o=[],s=0,l=[];for(n=0;a>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];i>s&&(s=i),o.push(i)}for(n=0;a>n;++n)l[n]=(s-o[n])/2;return l},wiggle:function(t){var e,n,i,r,a,o,s,l,u,c=t.length,h=t[0],d=h.length,p=[];for(p[0]=l=u=0,n=1;d>n;++n){for(e=0,r=0;c>e;++e)r+=t[e][n][1];for(e=0,a=0,s=h[n][0]-h[n-1][0];c>e;++e){for(i=0,o=(t[e][n][1]-t[e][n-1][1])/(2*s);e>i;++i)o+=(t[i][n][1]-t[i][n-1][1])/s;a+=o*t[e][n][1]}p[n]=l-=r?a/r*s:0,u>l&&(u=l)}for(n=0;d>n;++n)p[n]-=u;return p},expand:function(t){var e,n,i,r=t.length,a=t[0].length,o=1/r,s=[];for(n=0;a>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];if(i)for(e=0;r>e;e++)t[e][n][1]/=i;else for(e=0;r>e;e++)t[e][n][1]=o}for(n=0;a>n;++n)s[n]=0;return s},zero:Ar});Xo.layout.histogram=function(){function t(t,a){for(var o,s,l=[],u=t.map(n,this),c=i.call(this,u,a),h=r.call(this,c,u,a),a=-1,d=u.length,p=h.length-1,f=e?1:1/d;p>++a;)o=l[a]=[],o.dx=h[a+1]-(o.x=h[a]),o.y=0;if(p>0)for(a=-1;d>++a;)s=u[a],s>=c[0]&&c[1]>=s&&(o=l[Xo.bisect(h,s,1,p)-1],o.y+=f,o.push(t[a]));return l}var e=!0,n=Number,i=Tr,r=wr;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(i=fe(e),t):i},t.bins=function(e){return arguments.length?(r="number"==typeof e?function(t){return Mr(t,e)}:fe(e),t):r},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},Xo.layout.tree=function(){function t(t,a){function o(t,e){var i=t.children,r=t._tree;if(i&&(a=i.length)){for(var a,s,u,c=i[0],h=c,d=-1;a>++d;)u=i[d],o(u,s),h=l(u,s,h),s=u;Nr(t);var p=.5*(c._tree.prelim+u._tree.prelim);e?(r.prelim=e._tree.prelim+n(t,e),r.mod=r.prelim-p):r.prelim=p}else e&&(r.prelim=e._tree.prelim+n(t,e))}function s(t,e){t.x=t._tree.prelim+e;var n=t.children;if(n&&(i=n.length)){var i,r=-1;for(e+=t._tree.mod;i>++r;)s(n[r],e)}}function l(t,e,i){if(e){for(var r,a=t,o=t,s=e,l=t.parent.children[0],u=a._tree.mod,c=o._tree.mod,h=s._tree.mod,d=l._tree.mod;s=Dr(s),a=Er(a),s&&a;)l=Er(l),o=Dr(o),o._tree.ancestor=t,r=s._tree.prelim+h-a._tree.prelim-u+n(s,a),r>0&&(Rr(Ir(s,t,i),t,r),u+=r,c+=r),h+=s._tree.mod,u+=a._tree.mod,d+=l._tree.mod,c+=o._tree.mod;s&&!Dr(o)&&(o._tree.thread=s,o._tree.mod+=h-c),a&&!Er(l)&&(l._tree.thread=a,l._tree.mod+=u-d,i=t)}return i}var u=e.call(this,t,a),c=u[0];Cr(c,function(t,e){t._tree={ancestor:t,prelim:0,mod:0,change:0,shift:0,number:e?e._tree.number+1:0}}),o(c),s(c,-c._tree.prelim);var h=Lr(c,zr),d=Lr(c,Fr),p=Lr(c,Vr),f=h.x-n(h,d)/2,g=d.x+n(d,h)/2,m=p.depth||1;return Cr(c,r?function(t){t.x*=i[0],t.y=t.depth*i[1],delete t._tree}:function(t){t.x=(t.x-f)/(g-f)*i[0],t.y=t.depth/m*i[1],delete t._tree}),u}var e=Xo.layout.hierarchy().sort(null).value(null),n=Or,i=[1,1],r=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(r=null==(i=e),t):r?null:i},t.nodeSize=function(e){return arguments.length?(r=null!=(i=e),t):r?i:null},pr(t,e)},Xo.layout.pack=function(){function t(t,a){var o=n.call(this,t,a),s=o[0],l=r[0],u=r[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(s.x=s.y=0,Cr(s,function(t){t.r=+c(t.value)}),Cr(s,qr),i){var h=i*(e?1:Math.max(2*s.r/l,2*s.r/u))/2;Cr(s,function(t){t.r+=h}),Cr(s,qr),Cr(s,function(t){t.r-=h})}return Ur(s,l/2,u/2,e?1:1/Math.max(2*s.r/l,2*s.r/u)),o}var e,n=Xo.layout.hierarchy().sort(Br),i=0,r=[1,1];return t.size=function(e){return arguments.length?(r=e,t):r},t.radius=function(n){return arguments.length?(e=null==n||"function"==typeof n?n:+n,t):e},t.padding=function(e){return arguments.length?(i=+e,t):i},pr(t,n)},Xo.layout.cluster=function(){function t(t,a){var o,s=e.call(this,t,a),l=s[0],u=0;Cr(l,function(t){var e=t.children;e&&e.length?(t.x=Zr(e),t.y=Jr(e)):(t.x=o?u+=n(t,o):0,t.y=0,o=t)});var c=Kr(l),h=$r(l),d=c.x-n(c,h)/2,p=h.x+n(h,c)/2;return Cr(l,r?function(t){t.x=(t.x-l.x)*i[0],t.y=(l.y-t.y)*i[1]}:function(t){t.x=(t.x-d)/(p-d)*i[0],t.y=(1-(l.y?t.y/l.y:1))*i[1]}),s}var e=Xo.layout.hierarchy().sort(null).value(null),n=Or,i=[1,1],r=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(r=null==(i=e),t):r?null:i},t.nodeSize=function(e){return arguments.length?(r=null!=(i=e),t):r?i:null},pr(t,e)},Xo.layout.treemap=function(){function t(t,e){for(var n,i,r=-1,a=t.length;a>++r;)i=(n=t[r]).value*(0>e?0:e),n.area=isNaN(i)||0>=i?0:i}function e(n){var a=n.children;if(a&&a.length){var o,s,l,u=h(n),c=[],d=a.slice(),f=1/0,g="slice"===p?u.dx:"dice"===p?u.dy:"slice-dice"===p?1&n.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(t(d,u.dx*u.dy/n.value),c.area=0;(l=d.length)>0;)c.push(o=d[l-1]),c.area+=o.area,"squarify"!==p||f>=(s=i(c,g))?(d.pop(),f=s):(c.area-=c.pop().area,r(c,g,u,!1),g=Math.min(u.dx,u.dy),c.length=c.area=0,f=1/0);c.length&&(r(c,g,u,!0),c.length=c.area=0),a.forEach(e)}}function n(e){var i=e.children;if(i&&i.length){var a,o=h(e),s=i.slice(),l=[];for(t(s,o.dx*o.dy/e.value),l.area=0;a=s.pop();)l.push(a),l.area+=a.area,null!=a.z&&(r(l,a.z?o.dx:o.dy,o,!s.length),l.length=l.area=0);i.forEach(n)}}function i(t,e){for(var n,i=t.area,r=0,a=1/0,o=-1,s=t.length;s>++o;)(n=t[o].area)&&(a>n&&(a=n),n>r&&(r=n));return i*=i,e*=e,i?Math.max(e*r*f/i,i/(e*a*f)):1/0}function r(t,e,n,i){var r,a=-1,o=t.length,s=n.x,u=n.y,c=e?l(t.area/e):0;if(e==n.dx){for((i||c>n.dy)&&(c=n.dy);o>++a;)r=t[a],r.x=s,r.y=u,r.dy=c,s+=r.dx=Math.min(n.x+n.dx-s,c?l(r.area/c):0);r.z=!0,r.dx+=n.x+n.dx-s,n.y+=c,n.dy-=c}else{for((i||c>n.dx)&&(c=n.dx);o>++a;)r=t[a],r.x=s,r.y=u,r.dx=c,u+=r.dy=Math.min(n.y+n.dy-u,c?l(r.area/c):0);r.z=!1,r.dy+=n.y+n.dy-u,n.x+=c,n.dx-=c}}function a(i){var r=o||s(i),a=r[0];return a.x=0,a.y=0,a.dx=u[0],a.dy=u[1],o&&s.revalue(a),t([a],a.dx*a.dy/a.value),(o?n:e)(a),d&&(o=r),r}var o,s=Xo.layout.hierarchy(),l=Math.round,u=[1,1],c=null,h=Qr,d=!1,p="squarify",f=.5*(1+Math.sqrt(5));return a.size=function(t){return arguments.length?(u=t,a):u},a.padding=function(t){function e(e){var n=t.call(a,e,e.depth);return null==n?Qr(e):ta(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return ta(e,t)}if(!arguments.length)return c;var i;return h=null==(c=t)?Qr:"function"==(i=typeof t)?e:"number"===i?(t=[t,t,t,t],n):n,a},a.round=function(t){return arguments.length?(l=t?Math.round:Number,a):l!=Number},a.sticky=function(t){return arguments.length?(d=t,o=null,a):d},a.ratio=function(t){return arguments.length?(f=t,a):f},a.mode=function(t){return arguments.length?(p=t+"",a):p},pr(a,s)},Xo.random={normal:function(t,e){var n=arguments.length;return 2>n&&(e=1),1>n&&(t=0),function(){var n,i,r;do n=2*Math.random()-1,i=2*Math.random()-1,r=n*n+i*i;while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=Xo.random.normal.apply(Xo,arguments);return function(){return Math.exp(t())}},irwinHall:function(t){return function(){for(var e=0,n=0;t>n;n++)e+=Math.random();return e/t}}},Xo.scale={};var cu={floor:ge,ceil:ge};Xo.scale.linear=function(){return sa([0,1],[0,1],Fi,!1)};var hu={s:1,g:1,p:1,r:1,e:1};Xo.scale.log=function(){return ga(Xo.scale.linear().domain([0,1]),10,!0,[1,10])};var du=Xo.format(".0e"),pu={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};Xo.scale.pow=function(){return ma(Xo.scale.linear(),1,[0,1])},Xo.scale.sqrt=function(){return Xo.scale.pow().exponent(.5)},Xo.scale.ordinal=function(){return _a([],{t:"range",a:[[]]})},Xo.scale.category10=function(){return Xo.scale.ordinal().range(fu)},Xo.scale.category20=function(){return Xo.scale.ordinal().range(gu)},Xo.scale.category20b=function(){return Xo.scale.ordinal().range(mu)},Xo.scale.category20c=function(){return Xo.scale.ordinal().range(vu)};var fu=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ae),gu=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ae),mu=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ae),vu=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ae);Xo.scale.quantile=function(){return ya([],[])},Xo.scale.quantize=function(){return xa(0,1,[0,1])},Xo.scale.threshold=function(){return ba([.5],[0,1])},Xo.scale.identity=function(){return Aa([0,1])},Xo.svg={},Xo.svg.arc=function(){function t(){var t=e.apply(this,arguments),a=n.apply(this,arguments),o=i.apply(this,arguments)+_u,s=r.apply(this,arguments)+_u,l=(o>s&&(l=o,o=s,s=l),s-o),u=ws>l?"0":"1",c=Math.cos(o),h=Math.sin(o),d=Math.cos(s),p=Math.sin(s);return l>=yu?t?"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+-a+"A"+a+","+a+" 0 1,1 0,"+a+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+-a+"A"+a+","+a+" 0 1,1 0,"+a+"Z":t?"M"+a*c+","+a*h+"A"+a+","+a+" 0 "+u+",1 "+a*d+","+a*p+"L"+t*d+","+t*p+"A"+t+","+t+" 0 "+u+",0 "+t*c+","+t*h+"Z":"M"+a*c+","+a*h+"A"+a+","+a+" 0 "+u+",1 "+a*d+","+a*p+"L0,0"+"Z"}var e=ka,n=Pa,i=Sa,r=wa;return t.innerRadius=function(n){return arguments.length?(e=fe(n),t):e},t.outerRadius=function(e){return arguments.length?(n=fe(e),t):n},t.startAngle=function(e){return arguments.length?(i=fe(e),t):i},t.endAngle=function(e){return arguments.length?(r=fe(e),t):r},t.centroid=function(){var t=(e.apply(this,arguments)+n.apply(this,arguments))/2,a=(i.apply(this,arguments)+r.apply(this,arguments))/2+_u;return[Math.cos(a)*t,Math.sin(a)*t]},t};var _u=-Ts,yu=Ms-Os;Xo.svg.line=function(){return Ma(ge)};var xu=Xo.map({linear:Ta,"linear-closed":Oa,step:Ea,"step-before":Da,"step-after":La,basis:Ra,"basis-open":Ia,"basis-closed":Ba,bundle:Ga,cardinal:Va,"cardinal-open":Fa,"cardinal-closed":za,monotone:Ua});xu.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var bu=[0,2/3,1/3,0],Au=[0,1/3,2/3,0],ku=[0,1/6,2/3,1/6];Xo.svg.line.radial=function(){var t=Ma(Xa);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},Da.reverse=La,La.reverse=Da,Xo.svg.area=function(){return Ja(ge)},Xo.svg.area.radial=function(){var t=Ja(Xa);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},Xo.svg.chord=function(){function t(t,s){var l=e(this,a,t,s),u=e(this,o,t,s);return"M"+l.p0+i(l.r,l.p1,l.a1-l.a0)+(n(l,u)?r(l.r,l.p1,l.r,l.p0):r(l.r,l.p1,u.r,u.p0)+i(u.r,u.p1,u.a1-u.a0)+r(u.r,u.p1,l.r,l.p0))+"Z"}function e(t,e,n,i){var r=e.call(t,n,i),a=s.call(t,r,i),o=l.call(t,r,i)+_u,c=u.call(t,r,i)+_u;return{r:a,a0:o,a1:c,p0:[a*Math.cos(o),a*Math.sin(o)],p1:[a*Math.cos(c),a*Math.sin(c)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function i(t,e,n){return"A"+t+","+t+" 0 "+ +(n>ws)+",1 "+e}function r(t,e,n,i){return"Q 0,0 "+i}var a=Vn,o=Cn,s=Za,l=Sa,u=wa;return t.radius=function(e){return arguments.length?(s=fe(e),t):s},t.source=function(e){return arguments.length?(a=fe(e),t):a},t.target=function(e){return arguments.length?(o=fe(e),t):o},t.startAngle=function(e){return arguments.length?(l=fe(e),t):l},t.endAngle=function(e){return arguments.length?(u=fe(e),t):u},t},Xo.svg.diagonal=function(){function t(t,r){var a=e.call(this,t,r),o=n.call(this,t,r),s=(a.y+o.y)/2,l=[a,{x:a.x,y:s},{x:o.x,y:s},o];return l=l.map(i),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var e=Vn,n=Cn,i=Ka;return t.source=function(n){return arguments.length?(e=fe(n),t):e},t.target=function(e){return arguments.length?(n=fe(e),t):n},t.projection=function(e){return arguments.length?(i=e,t):i},t},Xo.svg.diagonal.radial=function(){var t=Xo.svg.diagonal(),e=Ka,n=t.projection;return t.projection=function(t){return arguments.length?n($a(e=t)):e},t},Xo.svg.symbol=function(){function t(t,i){return(Pu.get(e.call(this,t,i))||eo)(n.call(this,t,i))}var e=to,n=Qa;return t.type=function(n){return arguments.length?(e=fe(n),t):e},t.size=function(e){return arguments.length?(n=fe(e),t):n},t};var Pu=Xo.map({circle:eo,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Tu)),n=e*Tu;return"M0,"+-e+"L"+n+",0"+" 0,"+e+" "+-n+",0"+"Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Mu),n=e*Mu/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Mu),n=e*Mu/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});Xo.svg.symbolTypes=Pu.keys();var Su,wu,Mu=Math.sqrt(3),Tu=Math.tan(30*Ds),Ou=[],Eu=0;Ou.call=_s.call,Ou.empty=_s.empty,Ou.node=_s.node,Ou.size=_s.size,Xo.transition=function(t){return arguments.length?Su?t.transition():t:bs.transition()
},Xo.transition.prototype=Ou,Ou.select=function(t){var e,n,i,r=this.id,a=[];t=g(t);for(var o=-1,s=this.length;s>++o;){a.push(e=[]);for(var l=this[o],u=-1,c=l.length;c>++u;)(i=l[u])&&(n=t.call(i,i.__data__,u,o))?("__data__"in i&&(n.__data__=i.__data__),ao(n,u,r,i.__transition__[r]),e.push(n)):e.push(null)}return no(a,r)},Ou.selectAll=function(t){var e,n,i,r,a,o=this.id,s=[];t=m(t);for(var l=-1,u=this.length;u>++l;)for(var c=this[l],h=-1,d=c.length;d>++h;)if(i=c[h]){a=i.__transition__[o],n=t.call(i,i.__data__,h,l),s.push(e=[]);for(var p=-1,f=n.length;f>++p;)(r=n[p])&&ao(r,p,o,a),e.push(r)}return no(s,o)},Ou.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=w(t));for(var a=0,o=this.length;o>a;a++){r.push(e=[]);for(var n=this[a],s=0,l=n.length;l>s;s++)(i=n[s])&&t.call(i,i.__data__,s)&&e.push(i)}return no(r,this.id)},Ou.tween=function(t,e){var n=this.id;return 2>arguments.length?this.node().__transition__[n].tween.get(t):T(this,null==e?function(e){e.__transition__[n].tween.remove(t)}:function(i){i.__transition__[n].tween.set(t,e)})},Ou.attr=function(t,e){function n(){this.removeAttribute(s)}function i(){this.removeAttributeNS(s.space,s.local)}function r(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(s);return n!==t&&(e=o(n,t),function(t){this.setAttribute(s,e(t))})})}function a(t){return null==t?i:(t+="",function(){var e,n=this.getAttributeNS(s.space,s.local);return n!==t&&(e=o(n,t),function(t){this.setAttributeNS(s.space,s.local,e(t))})})}if(2>arguments.length){for(e in t)this.attr(e,t[e]);return this}var o="transform"==t?nr:Fi,s=Xo.ns.qualify(t);return io(this,"attr."+t,e,s.local?a:r)},Ou.attrTween=function(t,e){function n(t,n){var i=e.call(this,t,n,this.getAttribute(r));return i&&function(t){this.setAttribute(r,i(t))}}function i(t,n){var i=e.call(this,t,n,this.getAttributeNS(r.space,r.local));return i&&function(t){this.setAttributeNS(r.space,r.local,i(t))}}var r=Xo.ns.qualify(t);return this.tween("attr."+t,r.local?i:n)},Ou.style=function(t,e,n){function i(){this.style.removeProperty(t)}function r(e){return null==e?i:(e+="",function(){var i,r=Qo.getComputedStyle(this,null).getPropertyValue(t);return r!==e&&(i=Fi(r,e),function(e){this.style.setProperty(t,i(e),n)})})}var a=arguments.length;if(3>a){if("string"!=typeof t){2>a&&(e="");for(n in t)this.style(n,t[n],e);return this}n=""}return io(this,"style."+t,e,r)},Ou.styleTween=function(t,e,n){function i(i,r){var a=e.call(this,i,r,Qo.getComputedStyle(this,null).getPropertyValue(t));return a&&function(e){this.style.setProperty(t,a(e),n)}}return 3>arguments.length&&(n=""),this.tween("style."+t,i)},Ou.text=function(t){return io(this,"text",t,ro)},Ou.remove=function(){return this.each("end.transition",function(){var t;2>this.__transition__.count&&(t=this.parentNode)&&t.removeChild(this)})},Ou.ease=function(t){var e=this.id;return 1>arguments.length?this.node().__transition__[e].ease:("function"!=typeof t&&(t=Xo.ease.apply(Xo,arguments)),T(this,function(n){n.__transition__[e].ease=t}))},Ou.delay=function(t){var e=this.id;return T(this,"function"==typeof t?function(n,i,r){n.__transition__[e].delay=+t.call(n,n.__data__,i,r)}:(t=+t,function(n){n.__transition__[e].delay=t}))},Ou.duration=function(t){var e=this.id;return T(this,"function"==typeof t?function(n,i,r){n.__transition__[e].duration=Math.max(1,t.call(n,n.__data__,i,r))}:(t=Math.max(1,t),function(n){n.__transition__[e].duration=t}))},Ou.each=function(t,e){var n=this.id;if(2>arguments.length){var i=wu,r=Su;Su=n,T(this,function(e,i,r){wu=e.__transition__[n],t.call(e,e.__data__,i,r)}),wu=i,Su=r}else T(this,function(i){var r=i.__transition__[n];(r.event||(r.event=Xo.dispatch("start","end"))).on(t,e)});return this},Ou.transition=function(){for(var t,e,n,i,r=this.id,a=++Eu,o=[],s=0,l=this.length;l>s;s++){o.push(t=[]);for(var e=this[s],u=0,c=e.length;c>u;u++)(n=e[u])&&(i=Object.create(n.__transition__[r]),i.delay+=i.duration,ao(n,u,a,i)),t.push(n)}return no(o,a)},Xo.svg.axis=function(){function t(t){t.each(function(){var t,u=Xo.select(this),c=this.__chart__||n,h=this.__chart__=n.copy(),d=null==l?h.ticks?h.ticks.apply(h,s):h.domain():l,p=null==e?h.tickFormat?h.tickFormat.apply(h,s):ge:e,f=u.selectAll(".tick").data(d,h),g=f.enter().insert("g",".domain").attr("class","tick").style("opacity",Os),m=Xo.transition(f.exit()).style("opacity",Os).remove(),v=Xo.transition(f).style("opacity",1),_=na(h),y=u.selectAll(".domain").data([0]),x=(y.enter().append("path").attr("class","domain"),Xo.transition(y));g.append("line"),g.append("text");var b=g.select("line"),A=v.select("line"),k=f.select("text").text(p),P=g.select("text"),S=v.select("text");switch(i){case"bottom":t=oo,b.attr("y2",r),P.attr("y",Math.max(r,0)+o),A.attr("x2",0).attr("y2",r),S.attr("x",0).attr("y",Math.max(r,0)+o),k.attr("dy",".71em").style("text-anchor","middle"),x.attr("d","M"+_[0]+","+a+"V0H"+_[1]+"V"+a);break;case"top":t=oo,b.attr("y2",-r),P.attr("y",-(Math.max(r,0)+o)),A.attr("x2",0).attr("y2",-r),S.attr("x",0).attr("y",-(Math.max(r,0)+o)),k.attr("dy","0em").style("text-anchor","middle"),x.attr("d","M"+_[0]+","+-a+"V0H"+_[1]+"V"+-a);break;case"left":t=so,b.attr("x2",-r),P.attr("x",-(Math.max(r,0)+o)),A.attr("x2",-r).attr("y2",0),S.attr("x",-(Math.max(r,0)+o)).attr("y",0),k.attr("dy",".32em").style("text-anchor","end"),x.attr("d","M"+-a+","+_[0]+"H0V"+_[1]+"H"+-a);break;case"right":t=so,b.attr("x2",r),P.attr("x",Math.max(r,0)+o),A.attr("x2",r).attr("y2",0),S.attr("x",Math.max(r,0)+o).attr("y",0),k.attr("dy",".32em").style("text-anchor","start"),x.attr("d","M"+a+","+_[0]+"H0V"+_[1]+"H"+a)}if(h.rangeBand){var w=h.rangeBand()/2,M=function(t){return h(t)+w};g.call(t,M),v.call(t,M)}else g.call(t,c),v.call(t,h),m.call(t,h)})}var e,n=Xo.scale.linear(),i=Du,r=6,a=6,o=3,s=[10],l=null;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(i=e in Lu?e+"":Du,t):i},t.ticks=function(){return arguments.length?(s=arguments,t):s},t.tickValues=function(e){return arguments.length?(l=e,t):l},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e){var n=arguments.length;return n?(r=+e,a=+arguments[n-1],t):r},t.innerTickSize=function(e){return arguments.length?(r=+e,t):r},t.outerTickSize=function(e){return arguments.length?(a=+e,t):a},t.tickPadding=function(e){return arguments.length?(o=+e,t):o},t.tickSubdivide=function(){return arguments.length&&t},t};var Du="bottom",Lu={top:1,right:1,bottom:1,left:1};Xo.svg.brush=function(){function t(a){a.each(function(){var a=Xo.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",r).on("touchstart.brush",r),o=a.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),a.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var s=a.selectAll(".resize").data(m,ge);s.exit().remove(),s.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Fu[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),s.style("display",t.empty()?"none":null);var c,h=Xo.transition(a),d=Xo.transition(o);l&&(c=na(l),d.attr("x",c[0]).attr("width",c[1]-c[0]),n(h)),u&&(c=na(u),d.attr("y",c[0]).attr("height",c[1]-c[0]),i(h)),e(h)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+c[+/e$/.test(t)]+","+d[+/^s/.test(t)]+")"})}function n(t){t.select(".extent").attr("x",c[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1]-c[0])}function i(t){t.select(".extent").attr("y",d[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",d[1]-d[0])}function r(){function r(){32==Xo.event.keyCode&&(T||(y=null,E[0]-=c[1],E[1]-=d[1],T=2),h())}function p(){32==Xo.event.keyCode&&2==T&&(E[0]+=c[1],E[1]+=d[1],T=0,h())}function m(){var t=Xo.mouse(b),r=!1;x&&(t[0]+=x[0],t[1]+=x[1]),T||(Xo.event.altKey?(y||(y=[(c[0]+c[1])/2,(d[0]+d[1])/2]),E[0]=c[+(t[0]<y[0])],E[1]=d[+(t[1]<y[1])]):y=null),w&&v(t,l,0)&&(n(P),r=!0),M&&v(t,u,1)&&(i(P),r=!0),r&&(e(P),k({type:"brush",mode:T?"move":"resize"}))}function v(t,e,n){var i,r,s=na(e),l=s[0],u=s[1],h=E[n],p=n?d:c,m=p[1]-p[0];return T&&(l-=h,u-=m+h),i=(n?g:f)?Math.max(l,Math.min(u,t[n])):t[n],T?r=(i+=h)+m:(y&&(h=Math.max(l,Math.min(u,2*y[n]-i))),i>h?(r=i,i=h):r=h),p[0]!=i||p[1]!=r?(n?o=null:a=null,p[0]=i,p[1]=r,!0):void 0}function _(){m(),P.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),Xo.select("body").style("cursor",null),D.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),O(),k({type:"brushend"})}var y,x,b=this,A=Xo.select(Xo.event.target),k=s.of(b,arguments),P=Xo.select(b),S=A.datum(),w=!/^(n|s)$/.test(S)&&l,M=!/^(e|w)$/.test(S)&&u,T=A.classed("extent"),O=V(),E=Xo.mouse(b),D=Xo.select(Qo).on("keydown.brush",r).on("keyup.brush",p);if(Xo.event.changedTouches?D.on("touchmove.brush",m).on("touchend.brush",_):D.on("mousemove.brush",m).on("mouseup.brush",_),P.interrupt().selectAll("*").interrupt(),T)E[0]=c[0]-E[0],E[1]=d[0]-E[1];else if(S){var L=+/w$/.test(S),F=+/^n/.test(S);x=[c[1-L]-E[0],d[1-F]-E[1]],E[0]=c[L],E[1]=d[F]}else Xo.event.altKey&&(y=E.slice());P.style("pointer-events","none").selectAll(".resize").style("display",null),Xo.select("body").style("cursor",A.style("cursor")),k({type:"brushstart"}),m()}var a,o,s=p(t,"brushstart","brush","brushend"),l=null,u=null,c=[0,0],d=[0,0],f=!0,g=!0,m=zu[0];return t.event=function(t){t.each(function(){var t=s.of(this,arguments),e={x:c,y:d,i:a,j:o},n=this.__chart__||e;this.__chart__=e,Su?Xo.select(this).transition().each("start.brush",function(){a=n.i,o=n.j,c=n.x,d=n.y,t({type:"brushstart"})}).tween("brush:brush",function(){var n=zi(c,e.x),i=zi(d,e.y);return a=o=null,function(r){c=e.x=n(r),d=e.y=i(r),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){a=e.i,o=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(l=e,m=zu[!l<<1|!u],t):l},t.y=function(e){return arguments.length?(u=e,m=zu[!l<<1|!u],t):u},t.clamp=function(e){return arguments.length?(l&&u?(f=!!e[0],g=!!e[1]):l?f=!!e:u&&(g=!!e),t):l&&u?[f,g]:l?f:u?g:null},t.extent=function(e){var n,i,r,s,h;return arguments.length?(l&&(n=e[0],i=e[1],u&&(n=n[0],i=i[0]),a=[n,i],l.invert&&(n=l(n),i=l(i)),n>i&&(h=n,n=i,i=h),(n!=c[0]||i!=c[1])&&(c=[n,i])),u&&(r=e[0],s=e[1],l&&(r=r[1],s=s[1]),o=[r,s],u.invert&&(r=u(r),s=u(s)),r>s&&(h=r,r=s,s=h),(r!=d[0]||s!=d[1])&&(d=[r,s])),t):(l&&(a?(n=a[0],i=a[1]):(n=c[0],i=c[1],l.invert&&(n=l.invert(n),i=l.invert(i)),n>i&&(h=n,n=i,i=h))),u&&(o?(r=o[0],s=o[1]):(r=d[0],s=d[1],u.invert&&(r=u.invert(r),s=u.invert(s)),r>s&&(h=r,r=s,s=h))),l&&u?[[n,r],[i,s]]:l?[n,i]:u&&[r,s])},t.clear=function(){return t.empty()||(c=[0,0],d=[0,0],a=o=null),t},t.empty=function(){return!!l&&c[0]==c[1]||!!u&&d[0]==d[1]},Xo.rebind(t,s,"on")};var Fu={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},zu=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Vu=Xo.time={},Cu=Date,Nu=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];lo.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Ru.setUTCDate.apply(this._,arguments)},setDay:function(){Ru.setUTCDay.apply(this._,arguments)},setFullYear:function(){Ru.setUTCFullYear.apply(this._,arguments)},setHours:function(){Ru.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Ru.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Ru.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Ru.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Ru.setUTCSeconds.apply(this._,arguments)},setTime:function(){Ru.setTime.apply(this._,arguments)}};var Ru=Date.prototype,Iu="%a %b %e %X %Y",Bu="%m/%d/%Y",Gu="%H:%M:%S",Hu=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ju=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],qu=["January","February","March","April","May","June","July","August","September","October","November","December"],Yu=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];Vu.year=uo(function(t){return t=Vu.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),Vu.years=Vu.year.range,Vu.years.utc=Vu.year.utc.range,Vu.day=uo(function(t){var e=new Cu(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),Vu.days=Vu.day.range,Vu.days.utc=Vu.day.utc.range,Vu.dayOfYear=function(t){var e=Vu.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},Nu.forEach(function(t,e){t=t.toLowerCase(),e=7-e;var n=Vu[t]=uo(function(t){return(t=Vu.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=Vu.year(t).getDay();return Math.floor((Vu.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});Vu[t+"s"]=n.range,Vu[t+"s"].utc=n.utc.range,Vu[t+"OfYear"]=function(t){var n=Vu.year(t).getDay();return Math.floor((Vu.dayOfYear(t)+(n+e)%7)/7)}}),Vu.week=Vu.sunday,Vu.weeks=Vu.sunday.range,Vu.weeks.utc=Vu.sunday.utc.range,Vu.weekOfYear=Vu.sundayOfYear,Vu.format=ho;var Wu=fo(Hu),Uu=go(Hu),Xu=fo(ju),Ju=go(ju),Zu=fo(qu),Ku=go(qu),$u=fo(Yu),Qu=go(Yu),tc=/^%/,ec={"-":"",_:" ",0:"0"},nc={a:function(t){return ju[t.getDay()]},A:function(t){return Hu[t.getDay()]},b:function(t){return Yu[t.getMonth()]},B:function(t){return qu[t.getMonth()]},c:ho(Iu),d:function(t,e){return mo(t.getDate(),e,2)},e:function(t,e){return mo(t.getDate(),e,2)},H:function(t,e){return mo(t.getHours(),e,2)},I:function(t,e){return mo(t.getHours()%12||12,e,2)},j:function(t,e){return mo(1+Vu.dayOfYear(t),e,3)},L:function(t,e){return mo(t.getMilliseconds(),e,3)},m:function(t,e){return mo(t.getMonth()+1,e,2)},M:function(t,e){return mo(t.getMinutes(),e,2)},p:function(t){return t.getHours()>=12?"PM":"AM"},S:function(t,e){return mo(t.getSeconds(),e,2)},U:function(t,e){return mo(Vu.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return mo(Vu.mondayOfYear(t),e,2)},x:ho(Bu),X:ho(Gu),y:function(t,e){return mo(t.getFullYear()%100,e,2)},Y:function(t,e){return mo(t.getFullYear()%1e4,e,4)},Z:Io,"%":function(){return"%"}},ic={a:vo,A:_o,b:Ao,B:ko,c:Po,d:Lo,e:Lo,H:zo,I:zo,j:Fo,L:No,m:Do,M:Vo,p:Ro,S:Co,U:xo,w:yo,W:bo,x:So,X:wo,y:To,Y:Mo,Z:Oo,"%":Bo},rc=/^\s*\d+/,ac=Xo.map({am:0,pm:1});ho.utc=Go;var oc=Go("%Y-%m-%dT%H:%M:%S.%LZ");ho.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Ho:oc,Ho.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Ho.toString=oc.toString,Vu.second=uo(function(t){return new Cu(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),Vu.seconds=Vu.second.range,Vu.seconds.utc=Vu.second.utc.range,Vu.minute=uo(function(t){return new Cu(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),Vu.minutes=Vu.minute.range,Vu.minutes.utc=Vu.minute.utc.range,Vu.hour=uo(function(t){var e=t.getTimezoneOffset()/60;return new Cu(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),Vu.hours=Vu.hour.range,Vu.hours.utc=Vu.hour.utc.range,Vu.month=uo(function(t){return t=Vu.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),Vu.months=Vu.month.range,Vu.months.utc=Vu.month.utc.range;var sc=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],lc=[[Vu.second,1],[Vu.second,5],[Vu.second,15],[Vu.second,30],[Vu.minute,1],[Vu.minute,5],[Vu.minute,15],[Vu.minute,30],[Vu.hour,1],[Vu.hour,3],[Vu.hour,6],[Vu.hour,12],[Vu.day,1],[Vu.day,2],[Vu.week,1],[Vu.month,1],[Vu.month,3],[Vu.year,1]],uc=[[ho("%Y"),qe],[ho("%B"),function(t){return t.getMonth()}],[ho("%b %d"),function(t){return 1!=t.getDate()}],[ho("%a %d"),function(t){return t.getDay()&&1!=t.getDate()}],[ho("%I %p"),function(t){return t.getHours()}],[ho("%I:%M"),function(t){return t.getMinutes()}],[ho(":%S"),function(t){return t.getSeconds()}],[ho(".%L"),function(t){return t.getMilliseconds()}]],cc=Yo(uc);lc.year=Vu.year,Vu.scale=function(){return jo(Xo.scale.linear(),lc,cc)};var hc={range:function(t,e,n){return Xo.range(+t,+e,n).map(qo)}},dc=lc.map(function(t){return[t[0].utc,t[1]]}),pc=[[Go("%Y"),qe],[Go("%B"),function(t){return t.getUTCMonth()}],[Go("%b %d"),function(t){return 1!=t.getUTCDate()}],[Go("%a %d"),function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],[Go("%I %p"),function(t){return t.getUTCHours()}],[Go("%I:%M"),function(t){return t.getUTCMinutes()}],[Go(":%S"),function(t){return t.getUTCSeconds()}],[Go(".%L"),function(t){return t.getUTCMilliseconds()}]],fc=Yo(pc);return dc.year=Vu.year.utc,Vu.scale.utc=function(){return jo(Xo.scale.linear(),dc,fc)},Xo.text=me(function(t){return t.responseText}),Xo.json=function(t,e){return ve(t,"application/json",Wo,e)},Xo.html=function(t,e){return ve(t,"text/html",Uo,e)},Xo.xml=me(function(t){return t.responseXML}),Xo}(),function(){function t(t){return t[0]}function e(t){return t[1]}function n(t){return t[2]}function i(){return!0}function r(){return 0}function a(t){return t[0]}function o(t){return t[1]}function s(t){return t[2]}function l(t){return t[3]}function u(){return!0}function c(t,e,n,i){return"M"+t+","+n+"L"+e+","+n+"L"+e+","+i+"L"+t+","+i+"Z"}function h(){return 64}function d(){return"circle"}function p(t){return t[0]}function f(t){return t[1]}function g(){return!0}function m(t){return t[0]}function v(t){return t[1]}function _(t){return t[2]}function b(t){return t[3]}function A(){return!0}function k(t,e,n,i){var r=t+(e-t)/2;return"M"+t+","+n+"L"+e+","+n+"M"+r+","+n+"L"+r+","+i+"M"+t+","+i+"L"+e+","+i}function P(){return!0}function S(t){return t[0]}function w(t){return t[1]}function M(t,e){for(var n=d3.max([t.length,e.length]),i="M",r=0;n>r;r++)r>0&&(i+="L"),i+=t.length>r?t[r]:"0",i+=",",i+=e.length>r?e[r]:"0";return i+="Z"}function T(){}function O(t){function e(){for(var e,i=n,r=-1,a=i.length;a>++r;)(e=i[r].on)&&e.apply(this,arguments);return t}var n=[],i=new d3.map;return e.on=function(e,r){var a,o=i.get(e);return 2>arguments.length?o&&o.on:(o&&(o.on=null,n=n.slice(0,a=n.indexOf(o)).concat(n.slice(a+1)),i.remove(e)),r&&n.push(i.set(e,{on:r})),t)},e}function E(t){for(var e=new T,n=0,i=arguments.length;i>++n;)e[arguments[n]]=O(e);return e.of=function(n,i){return function(r){var a;try{a=r.sourceEvent=d3.event,r.target=t,d3.event=r,e[r.type].apply(n,i)}finally{d3.event=a}}},e}function D(){d3.event.stopPropagation(),d3.event.preventDefault()}dv=function(){},dv.version="2.4.2",dv.ANIMATION=!0;var L=!1,F=/xyz/.test(function(){})?/\b_super\b/:/.*/;dv.extend=function(t){function e(){if(!L){L=!0;var t=new arguments.callee;return L=!1,t.init.apply(t,arguments),t}}var n=this.prototype;L=!0;var i=new this;t=t(),t.init=t,L=!1;for(var r in t)i[r]="function"==typeof t[r]&&"function"==typeof n[r]&&F.test(t[r])?function(t,e){return function(){var i=this._super;this._super=n[t];var r=e.apply(this,arguments);return this._super=i,r}}(r,t[r]):t[r];return e.prototype=i,e.mixin=function(t,e){dv.util.isObject(t)?dv.util.each(t,function(t,n){i[n]=e}):i[t]=e},e.extend=arguments.callee,e},dv.DEFAULT_COLORS=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],dv.DEFAULT_CATEGORICAL_AES=["color","fill","stroke","shape","size","linetype"],dv.absoluteCoordinates=function(t,e,n){if(t.coord()instanceof dv.coord.polar){var i=dv.util.scaleRangeNoReverse(n.xOuterScale()),r=dv.util.scaleRangeNoReverse(n.yOuterScale());e[0]+=(i[0]+i[1])/2,e[1]+=(r[0]+r[1])/2}return e},dv.showTooltip=function(t,e,n,i,r,a){var o=a.selectAll(".dv-tooltip").data([t]);t.cx=t.cx||t.x+t.width/2,t.cy=t.cy||t.y+t.height/2,t.dx=t.dx||t.x+t.width,t.dy=t.dy||t.y+t.height,e.dx=e.dy||e.x+e.width,e.dy=e.dy||e.y+e.height;var s=o.enter().append("div").classed("dv-tooltip",!0).style("top",0).style("left",0);s.append("div").classed("content",!0),s.append("b").classed("notch",!0),o.select(".content").html(n);var l=o.select(".notch"),u=o.node(),c=u.offsetWidth,h=u.offsetHeight,d=0,p=0,f=function(t,e,n){return Math.min(Math.max(e,t),n)};switch(i){case"left":p=t.x-c-r,d=t.cy-h/2,e.x>p&&(p=t.dx+r,i="right"),e.y>d&&(d=e.y),d+h>e.dy&&(d=e.dy-h),l.style("top",f(t.cy-d-5,3,h-13)+"px");break;case"right":p=t.x+t.width+r,d=t.cy-h/2,p+c>e.dx&&(p=t.x-c-r,i="left"),e.y>d&&(d=e.y),d+h>e.dy&&(d=e.dy-h),l.style("top",f(t.cy-d-5,3,h-13)+"px");break;case"top":p=t.cx-c/2,d=t.y-h-r,e.y>d&&(d=t.dy+r,i="bottom"),e.x>p&&(p=e.x),p+c>e.dx&&(p=e.dx-c),l.style("left",f(t.cx-p-5,3,c-13)+"px");break;case"bottom":p=t.cx-c/2,d=t.dy+r,d+h>e.dy&&(d=t.y-h-r,i="top"),e.x>p&&(p=e.x),p+c>e.dx&&(p=e.dx-c),l.style("left",f(t.cx-p-5,3,c-13)+"px");break;default:i=null}d=Math.round(d),p=Math.round(p),o.classed("top right left bottom hide",!1).classed(i,!0),s.style("top",d+"px").style("left",p+"px"),o.style("top",d+"px").style("left",p+"px")},dv.removeTooltip=function(t){t.selectAll(".dv-tooltip").classed("hide",!0)},dv.cancelEvent=function(t){t.stopPropagation(),t.preventDefault()},dv.windowDimensions=function(){var t={width:640,height:480};return document.body&&document.body.offsetWidth&&(t.width=document.body.offsetWidth,t.height=document.body.offsetHeight),"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth&&(t.width=document.documentElement.offsetWidth,t.height=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(t.width=window.innerWidth,t.height=window.innerHeight),t},dv.addWindowResizeHandler=function(t){window.addEventListener("resize",t)},dv.removeWindowResizeHandler=function(t){window.removeEventListener("resize",t)},dv.scale=dv.extend(function(){function t(t){this._d3Scale=t,this._reverse=!1,this._parse=dv.util.identity,this._includeInDomain=function(){return!0}}return t._mapToD3Scale=function(t){return this._d3Scale(t)},t.trainingProperties=function(t){return arguments.length?(dv.util.isValidValue(t,["isUndefined","isArray"])||dv.log.error({msg:"The supplied properties is not an array",data:{range:t}}),this._trainingProperties=t,this):this._trainingProperties?this._trainingProperties:this._property?[this._property]:void 0},t.trainDomain=function(t,e){var n=this.calculateDomain(t,e);return this.domain(n),n},t.parse=function(t){return arguments.length?(this._parse=t,this):this._parse},t.applyRangePadding=function(){},t.mapToProp=function(t){var e=t[this.property()],n=this;return dv.util.isArray(e)?dv.util.map(e,function(t){return n._mapToD3Scale.call(n,t)}):this._mapToD3Scale.call(this,e)},t.mapPropToPercent=function(t){return this.mapValueToPercent(this.mapToProp(t))},t.mapValueToPercent=function(t){var e=dv.util.scaleRange(this),n=e[1]-e[0];return dv.util.isArray(t)?dv.util.map(t,function(t){return n?(t-e[0])/n:0}):n?(t-e[0])/n:0},t.mapValue=function(t){if(dv.util.isArray(t)){var e=this;return dv.util.map(t,function(t){return e._mapToD3Scale.call(e,t)})}return this._mapToD3Scale.call(this,t)},t.invertValue=function(t){return this._d3Scale.invert(t)},t.rangeBand=function(){return 0},t.reverse=function(t){if(!arguments.length)return this._reverse;if(this._reverse!=t){this._reverse=t;var e=this._d3Scale.domain()||[];this._d3Scale.domain(e.reverse())}return this},t.property=function(t){return arguments.length?(this._property=t,this):this._property},t.mapping=function(t){return arguments.length?(this._mapping=t,this):this._mapping},t.domain=function(t){return arguments.length?this._d3Scale?(t=this._reverse?t.reverse():t,this._d3Scale.domain(t),this):this:this._d3Scale.domain()},t.hasSameDomain=function(t){var e=!0,n=this.domain();if(n.length!=t.length)e=!1;else for(var i=0;t.length>i;i++)if(t[i]!=n[i]){e=!1;break}return e},t.range=function(t){return arguments.length?this._d3Scale?(dv.util.isValidValue(t,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:t}}),this._d3Scale.range(t),this):this:this._d3Scale.range()},t.expand=function(t){return arguments.length?(this._expand=t,this):this._expand},t.limits=function(t){return arguments.length?(this._limits=t,this):this._limits},t.breaks=function(t){return arguments.length?(this._breaks=t,this):this._breaks},t.orientation=function(t){return arguments.length?(this._orientation=t,this):this._orientation},t.includeInDomain=function(t){return arguments.length?(this._includeInDomain=t,this):this._includeInDomain},t.scaleIndex=function(t){return arguments.length?(this._scaleIndex=t,this):this._scaleIndex},t._copy=function(){dv.log.error({msg:"A copy function was not specified for the scale subclass."})},t.copy=t._copy,t.isDefault=function(t){return arguments.length?(this._isDefault=t,this):this._isDefault},t}),dv.scale.constant=dv.scale.extend(function(){function t(){this._super(null)}return t.trainDomain=function(){},t.map=function(){return this._value},t.mapToProp=function(){return this._value},t.value=function(t){return arguments.length?(this._value=t,this):this._value},t._copy=function(){var t=this.trainingProperties();return dv.util.isUndefined(t)||(t=t.slice(0)),dv.scale.constant().isDefault(this.isDefault()).value(this.value()).property(this.property()).trainingProperties(t).scaleIndex(this._scaleIndex)},t.copy=t._copy,t}),dv.scale.continuous=dv.scale.extend(function(){function t(t){this._super(t?t:d3.scale.linear()),this.to=this.range,this._parse=function(t){return parseFloat(t)}}return t.calculateDomain=function(t,e){var n,i,r=[],a=this,o=function(t){return a._parse.call(this,t)};this.trainingProperties()||this.trainingProperties([this.property()]);var s=this.trainingProperties();e||(e={}),t||(t=[]);for(var l=0;s.length>l;l++)for(var u=s[l],c=0;t.length>c;c++)if(!e.filter||!e.filter.call(this,t[c].key))for(var h=t[c].values,d=0;h.length>d;d++){var p=h[d];if(this._includeInDomain(p,d)){0!==this.scaleIndex()&&(p[this.property()+"-index"]=this.scaleIndex());var f=e.stack?p.y0:p[u];dv.util.isArray(f)||(f=this._parse.call(this,f));var g=dv.util.isArray(f)?d3.min(f,o):f;if(n=dv.util.isUndefined(n)||n>g?g:n,e.stack){var m=p[u];f+=dv.util.isArray(m)?d3.max(m,o):a._parse.call(this,m)}var v=dv.util.isArray(f)?d3.max(f,o):f;i=dv.util.isUndefined(i)||v>i?v:i}}return r=[isNaN(n)?0:n,isNaN(i)?1:i],this._naturalDomain=[r[0],r[1]],e.fill&&(r=[0,100]),dv.util.isUndefined(this._upperLimit)||dv.util.isFunction(this._upperLimit)||dv.util.isUndefined(this._lowerLimit)||dv.util.isFunction(this._lowerLimit)?this._reconcileLimits(r):r=this.limits(),r},t.unionDomain=function(t,e){return dv.util.isValidValue(t,["isArray"])&&2==t.length||dv.log.error({msg:"The supplied domain is not an array of length 2.",data:{domain:t,isReversed:e}}),this.reverse(e||this._reverse),this.domain(this.domain()?d3.extent(this.domain().concat(t)):d3.extent(t)),this},t.unionRange=function(t){return dv.util.isValidValue(t,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:t}}),this.range(this.range()?d3.extent(this.range().concat(t)):t),this},t.applyRangePadding=function(){var t=this.domain(),e=this.range();if(this._lowerRangePadding){var n=e[0]-e[1],i=Math.min(Math.abs(n)-1,this._lowerRangePadding);t[0]=this.invertValue(n/(Math.abs(n)-i)*i+e[0])}if(this._upperRangePadding){var r=e[1]-e[0],a=Math.min(Math.abs(r)-1,this._upperRangePadding);t[1]=this.invertValue(r/(Math.abs(r)-a)*a+e[1])}return this.domain(t),this},t.upperLimit=function(t){return arguments.length?(dv.util.isValidValue(t,["isUndefined","isFinite","isDate","isFunction"])?this._upperLimit=t:dv.log.error({msg:"Invalid value, cannot set upperLimit with: "+t}),this):this._upperLimit},t.lowerLimit=function(t){return arguments.length?(dv.util.isValidValue(t,["isUndefined","isFinite","isDate","isFunction"])?this._lowerLimit=t:dv.log.error({msg:"Invalid value, cannot set lowerLimit with: "+t}),this):this._lowerLimit},t.limits=function(t){return arguments.length?(t&&2==t.length||dv.log.error({msg:"Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"}),this.lowerLimit(t[0]),this.upperLimit(t[1]),this):[this._lowerLimit,this._upperLimit]},t.naturalDomain=function(){return this._naturalDomain},t.upperRangePadding=function(t){return arguments.length?(dv.util.isValidValue(t,["isUndefined","isFinite","isDate","isFunction"])?this._upperRangePadding=t:dv.log.error({msg:"Invalid value, cannot set upperRangePadding with: "+t}),this):this._upperRangePadding},t.lowerRangePadding=function(t){return arguments.length?(dv.util.isValidValue(t,["isUndefined","isFinite","isDate","isFunction"])?this._lowerRangePadding=t:dv.log.error({msg:"Invalid value, cannot set lowerRangePadding with: "+t}),this):this._lowerRangePadding},t.rangePadding=function(t){return arguments.length?(t&&2==t.length||dv.log.error({msg:"Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"}),this.lowerRangePadding(t[0]),this.upperRangePadding(t[1]),this):[this._lowerRangePadding,this._upperRangePadding]},t.softLowerLimit=function(t){return arguments.length?(this._softLowerLimit=t,this):this._softLowerLimit},t._reconcileLimits=function(t){dv.util.isUndefined(this._softLowerLimit)||(t[0]=Math.min(t[0],this._softLowerLimit),t[1]=Math.max(t[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(t[0]=dv.util.isFunction(this._lowerLimit)?this._lowerLimit(t[0],t[1]):this._lowerLimit),dv.util.isUndefined(this._upperLimit)||(t[1]=dv.util.isFunction(this._upperLimit)?this._upperLimit(t[0],t[1]):this._upperLimit)},t.labels=function(t){return arguments.length?(this._labels=t,this):this._labels},t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.continuous().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).reverse(this.reverse()).domain(t).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).trainingProperties(e).scaleIndex(this._scaleIndex);return n._naturalDomain=this._naturalDomain,n},t.invert=function(t){return this._d3Scale.invert(t[this.mapping()])},t.invertFromProp=function(t){return this._d3Scale.invert(t[this.property()])},t.copy=t._copy,t}),dv.scale.linear=dv.scale.continuous.extend(function(){function t(){this._super(d3.scale.linear())}return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.linear().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex);
return n._naturalDomain=this._naturalDomain,n},t.copy=t._copy,t}),dv.scale.gradient=dv.scale.continuous.extend(function(){function t(){this._super(d3.scale.linear()),this._innerScale=d3.scale.linear().range([0,1]),this.colors=this.range,this._controlPoints=["0%","50%","100%"],this.colors(["#FA5A50","#E1E1E1","#5FAF69"])}return t._adjustOuterDomain=function(){var t=this;this._d3Scale.domain(dv.util.map(this._controlPoints,function(e){return dv.util.isPercentString(e)?t._innerScale.invert(parseInt(e,10)/100):e}))},t.controlPoints=function(t){return arguments.length?(this._controlPoints=t,this._adjustOuterDomain(),this):this._controlPoints},t.domain=function(t){return arguments.length?this._innerScale?(t=this._reverse?t.reverse():t,this._innerScale.domain(t),this._adjustOuterDomain(),this):this:this._innerScale.domain()},t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.gradient().property(this.property()).mapping(this.mapping()).domain(t).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).includeInDomain(this.includeInDomain()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).controlPoints(this.controlPoints()).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex);return n._naturalDomain=this._naturalDomain,n},t.copy=t._copy,t}),dv.scale.time=dv.scale.continuous.extend(function(){function t(){this._super(d3.time.scale()),this._parse=function(t){return t instanceof Date?t:Date.parse(t)}}return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.time().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex);return n._naturalDomain=this._naturalDomain,n},t.copy=t._copy,t._reconcileLimits=function(t,e,n){dv.util.isUndefined(this._softLowerLimit)||(t[0]=Math.min(t[0],this._softLowerLimit),t[1]=Math.max(t[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(t[0]=dv.util.isFunction(this._lowerLimit)?this._parse(this._lowerLimit(new Date(e),new Date(n))):this._lowerLimit),dv.util.isUndefined(this._upperLimit)||(t[1]=dv.util.isFunction(this._upperLimit)?this._parse(this._upperLimit(new Date(e),new Date(n))):this._upperLimit)},t}),dv.scale.time.utc=dv.scale.continuous.extend(function(){function t(){this._super(d3.time.scale.utc()),this._parse=function(t){return t instanceof Date?t:Date.parse(t)}}return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.time.utc().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex);return n._naturalDomain=this._naturalDomain,n},t.copy=t._copy,t._reconcileLimits=function(t,e,n){dv.util.isUndefined(this._softLowerLimit)||(t[0]=Math.min(t[0],this._softLowerLimit),t[1]=Math.max(t[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(t[0]=dv.util.isFunction(this._lowerLimit)?this._parse(this._lowerLimit(new Date(e),new Date(n))):this._lowerLimit),dv.util.isUndefined(this._upperLimit)||(t[1]=dv.util.isFunction(this._upperLimit)?this._parse(this._upperLimit(new Date(e),new Date(n))):this._upperLimit)},t}),dv.scale.ordinal=dv.scale.extend(function(){function t(){this._super(d3.scale.ordinal()),this._defaultPadding=.1,this._defaultOuterPadding=0,this._rangeExtent=[],this._rangeBandsSet=!1}return t._mapToD3Scale=function(t){for(var e=this.domain(),n=-1,i=e.length,r=-1;i>++n;){var a=e[n];if(a===t||dv.util.isDate(a)&&a.getTime()===t.getTime()){r=n;break}}return 0>r?void 0:this._d3Scale(t)},t.calculateDomain=function(t,e){var n={},i=[],r=this.trainingProperties();e=e||{};for(var a=0;r.length>a;a++)for(var o=r[a],s=0;t.length>s;s++){var l=t[s].values;if(!e.filter||!e.filter.call(this,t[s].key))for(var u=0;l.length>u;u++){var c=l[u];if(this._includeInDomain(c,u)){0!==this.scaleIndex()&&(c[this.property()+"-index"]=this.scaleIndex());var h=this._parse.call(this,c[o]);dv.util.isUndefined(h)||n.hasOwnProperty(h)||(n[h]=h,i.push(h))}}}return i.length?i:null},t.unionDomain=function(t,e){if(t&&!dv.util.isArray(t))throw Error("The supplied domain is not an array");return t&&(this.reverse(e||this._reverse),this.domain(this.domain()?dv.util.union(this.domain(),t):t)),this},t.unionRange=function(t){if(t&&!dv.util.isArray(t))throw Error("The supplied range is not an array");return t&&this.range(this.range()?dv.util.union(this.range(),t):t),this},t.invertValue=function(t){var e=this.range().indexOf(t),n=this.domain();if(0>e)throw Error("The supplied value does not exist in the specified range.");return n[e%n.length]},t.reverse=function(t){if(!arguments.length)return this._reverse;if(this._reverse!=t){this._reverse=t;var e=this._d3Scale.domain()||[];this._d3Scale.domain(e.reverse())}return this},t.padding=function(t){return arguments.length?(this._padding=t,this._rangeBandsSet&&this._d3Scale.rangeBands(this.rangeExtent(),this._padding,this.outerPadding()),this):dv.util.isUndefined(this._padding)?this._defaultPadding:this._padding},t.outerPadding=function(t){return arguments.length?(this._outerPadding=t,this._rangeBandsSet&&this._d3Scale.rangeBands(this.rangeExtent(),this.padding(),this._outerPadding),this):dv.util.isUndefined(this._outerPadding)?dv.util.isUndefined(this._padding)?this._defaultOuterPadding:this.padding():this._outerPadding},t.rangeBands=function(t){return arguments.length?(this._rangeBandsSet=!0,this._d3Scale.rangeBands(t,this.padding(),this.outerPadding()),this.rangeExtent(t),this):this._d3Scale.range()},t.rangeBand=function(){return this._d3Scale.rangeBand()},t.range=function(t){return arguments.length?this._d3Scale?(dv.util.isValidValue(t,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:t}}),this._d3Scale.range(t),this.rangeExtent([t[0],t[t.length-1]]),this):this:this._d3Scale.range()},t.rangeExtent=function(t){return arguments.length?(dv.util.isValidValue(t,["isArray"])||dv.log.error({msg:"The supplied range extent is not an array",data:{range:t}}),this._rangeExtent=t,this):this._rangeExtent},t.values=function(t){return arguments.length?(dv.util.isValidValue(t,["isArray"])||dv.log.error({msg:"The supplied values is not an array",data:{range:t}}),this.range(t)):this._d3Scale.range()},t.drop=function(t){return arguments.length?(this._drop=t,this):this._drop},t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(e).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&n.rangeBands(this.rangeExtent().slice(0)),n},t.copy=t._copy,t}),dv.scale.color=dv.scale.ordinal.extend(function(){function t(){this._super(),this.range(e)}var e=["#8CC350","#5A6EAA","#D755A5","#1EBED7","#F0A01E","#9B8CE6","#3CB5A0","#3287D2","#F0557D","#C3D250","#EB782D","#78B4F5","#5FAF69","#AA5FA5","#FA5A50","#F5C841"];return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).range(this.range()).rangeExtent(this.rangeExtent()).includeInDomain(this.includeInDomain()).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(e).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&n.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),n},t.copy=t._copy,t}),dv.scale.shape=dv.scale.ordinal.extend(function(){function t(){this._super(),this.range(e)}var e=["circle","cross","diamond","square","triangle-down","triangle-up"];return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(e).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&n.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),n},t.copy=t._copy,t}),dv.scale.linetype=dv.scale.ordinal.extend(function(){function t(){this._super(),this.range(e)}var e=["solid","dashed","dotted","dotdash","longdash","twodash"];return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(e).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&n.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),n},t.copy=t._copy,t}),dv.scale.size=dv.scale.continuous.extend(function(){function t(){this._super(),this.to([2,10])}return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.size().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex);return n._naturalDomain=this._naturalDomain,n},t.copy=t._copy,t}),dv.scale.identity=dv.scale.ordinal.extend(function(){function t(){this._super(d3.scale.ordinal())}return t.mapToProp=function(t){return t[this.property()]},t.domain=function(t){return arguments.length?this._d3Scale?(t=this._reverse?t.reverse():t,this._d3Scale.domain(t),this._d3Scale.range(t),this):this:this._d3Scale.domain()},t.range=function(){return arguments.length?this:this._d3Scale.range()},t.labels=function(t){return arguments.length?(this._labels=t,this):this._labels},t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();return this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0)),dv.scale.identity().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex)},t.copy=t._copy,t}),dv.svg=dv.svg||{},dv.svg.text=function(){function a(t){return t.select(function(t,e){return u.call(this,t,e)?this:null}).attr("x",function(t,e){return o.call(this,t,e)}).attr("y",function(t,e){return s.call(this,t,e)}).text(function(t,e){return l.call(this,t,e)})}var o=t,s=e,l=n,u=i,c=r;return a.x=function(t){return arguments.length?(o=t,a):o},a.y=function(t){return arguments.length?(s=t,a):s},a.label=function(t){return arguments.length?(l=t,a):l},a.defined=function(t){return arguments.length?(u=t,a):u},a.duration=function(t){return arguments.length?(c=t,a):c},a},dv.svg.text.radial=function(){function a(t){var e=function(t,e){return o.call(this,t,e)+N},n=function(t,e){return s.call(this,t,e)};return t.select(function(t,e){return u.call(this,t,e)?this:null}).attr("x",function(t,i){return n(t,i)*Math.cos(e(t,i))}).attr("y",function(t,i){return n(t,i)*Math.sin(e(t,i))}).text(function(t,e){return l.call(this,t,e)})}var o=t,s=e,l=n,u=i,c=r;return a.angle=function(t){return arguments.length?(o=t,a):o},a.radius=function(t){return arguments.length?(s=t,a):s},a.label=function(t){return arguments.length?(l=t,a):l},a.defined=function(t){return arguments.length?(u=t,a):u},a.duration=function(t){return arguments.length?(c=t,a):c},a},dv.svg.rect=function(){function t(t,a){return h.call(this,t,a)?c(e.call(this,t,a),n.call(this,t,a),i.call(this,t,a),r.call(this,t,a)):null}var e=a,n=o,i=s,r=l,h=u;return t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(e){return arguments.length?(n=e,t):n},t.y0=function(e){return arguments.length?(i=e,t):i},t.y1=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(h=e,t):h},t},dv.svg.symbol=function(){function t(t,o){return a.call(this,t,o)?(z[e.call(this,t,o)]||z.circle)(n.call(this,t,o),i.call(this,t,o),r.call(this,t,o)):null}var e=d,n=h,i=p,r=f,a=g;return t.x=function(e){return arguments.length?(i=e,t):i},t.y=function(e){return arguments.length?(r=e,t):r},t.type=function(n){return arguments.length?(e=d3.functor(n),t):e},t.size=function(e){return arguments.length?(n=d3.functor(e),t):n},t.defined=function(e){return arguments.length?(a=e,t):a},t},dv.svg.symbol.radial=function(){function t(t,o){if(a.call(this,t,o)){var s=i.call(this,t,o)+N,l=r.call(this,t,o),u=l*Math.cos(s),c=l*Math.sin(s);return(z[e.call(this,t,o)]||z.circle)(n.call(this,t,o),u,c)}return null}var e=d,n=h,i=p,r=f,a=g;return t.angle=function(e){return arguments.length?(i=e,t):i},t.radius=function(e){return arguments.length?(r=e,t):r},t.type=function(n){return arguments.length?(e=d3.functor(n),t):e},t.size=function(e){return arguments.length?(n=d3.functor(e),t):n},t.defined=function(e){return arguments.length?(a=e,t):a},t},d3.svg.symbolTypes=d3.keys(z);var z={circle:function(t,e,n){var i=Math.sqrt(t/Math.PI);return"M"+e+","+(n+i)+"A"+i+","+i+" 0 1,1 "+e+","+(n-i)+"A"+i+","+i+" 0 1,1 "+e+","+(n+i)+"Z"},cross:function(t,e,n){var i=Math.sqrt(t/5)/2;return"M"+(e+-3*i)+","+(n-i)+"H"+(e-i)+"V"+(n+-3*i)+"H"+(e+i)+"V"+(n-i)+"H"+(e+3*i)+"V"+(n+i)+"H"+(e+i)+"V"+(n+3*i)+"H"+(e-i)+"V"+(n+i)+"H"+(e-3*i)+"Z"},diamond:function(t,e,n){var i=Math.sqrt(t/(2*C)),r=i*C;return"M"+e+","+(n-i)+"L"+(e+r)+","+n+" "+e+","+(n+i)+" "+(e-r)+","+n+"Z"},square:function(t,e,n){var i=Math.sqrt(t)/2;return"M"+(e-i)+","+(n-i)+"L"+(e+i)+","+(n-i)+" "+(e+i)+","+(n+i)+" "+(e-i)+","+(n+i)+"Z"},"triangle-down":function(t,e,n){var i=Math.sqrt(t/V),r=i*V/2;return"M"+e+","+(n+r)+"L"+(e+i)+","+(n-r)+" "+(e-i)+","+(n-r)+"Z"},"triangle-up":function(t,e,n){var i=Math.sqrt(t/V),r=i*V/2;return"M"+e+","+(n-r)+"L"+(e+i)+","+(n+r)+" "+(e-i)+","+(n+r)+"Z"}};dv.svg.errorBar=function(){function t(t,o){return a.call(this,t,o)?k(e.call(this,t,o),n.call(this,t,o),i.call(this,t,o),r.call(this,t,o)):null}var e=m,n=v,i=_,r=b,a=A;return t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(e){return arguments.length?(n=e,t):n},t.y0=function(e){return arguments.length?(i=e,t):i},t.y1=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(a=e,t):a},t};var V=Math.sqrt(3),C=Math.tan(30*Math.PI/180),N=-Math.PI/2;dv.svg.poly=function(){function t(t,r){return e.call(this,t,r)?M(n.call(this,t,r),i.call(this,t,r)):null}var e=P,n=S,i=w;return t.xs=function(e){return arguments.length?(n=e,t):n},t.ys=function(e){return arguments.length?(i=e,t):i},t.defined=function(t){return arguments.length?e=t:e},t},dv.svg.poly.radial=function(){function t(t,r){if(e.call(this,t,r)){for(var a=n.call(this,t,r),o=i.call(this,t,r),s=d3.max([a.length,o.length]),l="M",u=0;s>u;u++){u>0&&(l+="L");var c=a[u]+N,h=o[u],d=h*Math.cos(c),p=h*Math.sin(c);l+=a.length>u?d:"0",l+=",",l+=o.length>u?p:"0"}return l+="Z"}return null}var e=P,n=S,i=w;return t.angles=function(e){return arguments.length?(n=e,t):n},t.radii=function(e){return arguments.length?(i=e,t):i},t.defined=function(t){return arguments.length?e=t:e},t},dv.util={},dv.util.filterAndZip=function(t,e,n){var i=[],r=[];if(e)i=t[e];else for(var a in t){i=t[a];break}for(var o=-1,s=i.length;s>++o;){var l=i[o];if(!n||l==n){var u={};for(var c in t)if("data"===c){u[c]={};for(var h in t[c])u[c][h]=t[c][h][o]}else u[c]=t[c][o];r.push(u)}}return r},dv.util.binaryCompare=function(t,e,n,i,r){var a=i;for(4>arguments.length&&(a=0),5>arguments.length&&(r=t.length);r>a;){var o=a+r>>1;n(t[o])>e?r=o:a=o+1}return a==i||Math.abs(n(t[a])-e)<Math.abs(n(t[a-1])-e)?a:a-1},dv.util.uniqueValues=function(t,e){var n=[];return dv.util.each(t,function(i){for(var r=-1,a=n.length,o=!1;a>++r;){var s=n[r];if(e(i,s)){o=!0;break}}o||n.push(t[r])}),n},dv.util.scaleRange=function(t,e){return 1===arguments.length?t.rangeExtent?t.rangeExtent():t.range():(t.rangeExtent?t.rangeBands(e):t.range(e),t)},dv.util.scaleRangeNoReverse=function(t){return t.rangeExtent?t.rangeExtent():dv.util.scaleExtent(t.range())},dv.util.scaleExtent=function(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]},dv.util.merge=function(t,e){var n,i={};for(n in t)i[n]=t[n];for(n in e)i[n]=e[n];return i},dv.util.getPercentValue=function(t,e){return dv.util.isPercentString(t)?e*parseInt(t,10)/100:t},dv.util.isPercentString=function(t){return"string"==typeof t&&/^(-?[0-9]+)%$/.test(t)},dv.util.isValidValue=function(t,e){for(var n=0;e.length>n;n++)if(dv.util[e[n]](t))return!0;return!1},dv.util.identity=function(t){return t},dv.util.clone=function(t){return dv.util.isObject(t)?dv.util.isArray(t)?t.slice():dv.util.extend({},t):t},dv.util.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"==Object.prototype.toString.call(t)},dv.util.isObject=function(t){return t===Object(t)},dv.util.isFunction=function(t){return"[object Function]"==Object.prototype.toString.call(t)},dv.util.isUndefined=function(t){return void 0===t},dv.util.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},dv.util.isDate=function(t){return t instanceof Date},dv.util.isEmpty=function(t){return 0===Object.keys(t).length},dv.util.extend=function(t){return dv.util.each(Array.prototype.slice.call(arguments,1),function(e){for(var n in e)t[n]=e[n]}),t},dv.util.each=function(t,e,n){if(null!=t)if(Array.prototype.forEach&&t.forEach===Array.prototype.forEach)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,r=t.length;r>i;i++)if(e.call(n,t[i],i,t)==={})return}else for(var a in t)if(dv.util.has(t,a)&&e.call(n,t[a],a,t)==={})return},dv.util.has=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},dv.util.uniq=function(t,e,n,i){dv.util.isFunction(e)&&(i=n,n=e,e=!1);var r=n?dv.util.map(t,n,i):t,a=[],o=[];return dv.util.each(r,function(n,i){(e?i&&o[o.length-1]===n:dv.util.contains(o,n))||(o.push(n),a.push(t[i]))}),a},dv.util.union=function(){return dv.util.uniq(Array.prototype.concat.apply(Array.prototype,arguments))},dv.util.contains=function(t,e){return null==t?!1:Array.prototype.indexOf&&t.indexOf===Array.prototype.indexOf?-1!=t.indexOf(e):dv.util.any(t,function(t){return t===e})},dv.util.any=function(t,e,n){e||(e=dv.util.identity);var i=!1;return null==t?i:Array.prototype.some&&t.some===Array.prototype.some?t.some(e,n):(dv.util.each(t,function(t,r,a){return i||(i=e.call(n,t,r,a))?{}:void 0}),void 0)},dv.util.sortBy=function(t,e,n){var i=function(t){return dv.util.isFunction(t)?t:function(e){return e[t]}},r=i(e);return dv.util.pluck(dv.util.map(t,function(t,e,i){return{value:t,index:e,criteria:r.call(n,t,e,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index<e.index?-1:1}),"value")},dv.util.pluck=function(t,e){return dv.util.map(t,function(t){return t[e]})},dv.util.map=function(t,e,n){var i=[];return null===t?i:Array.prototype.map&&t.map===Array.prototype.map?t.map(e,n):(dv.util.each(t,function(t,r,a){i[i.length]=e.call(n,t,r,a)}),i)},dv.util.reduce=function(t,e,n,i){var r=arguments.length>2;if(null===t&&(t=[]),Array.prototype.reduce&&t.reduce===Array.prototype.reduce)return i&&(e=dv.util.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(dv.util.each(t,function(t,a,o){r?n=e.call(i,n,t,a,o):(n=t,r=!0)}),!r)throw new TypeError("Reduce of empty array with no initial value");return n},dv.util.bind=function(t,e){if(t.bind===Function.prototype.bind&&Function.prototype.bind)return Function.prototype.bind.apply(t,Array.prototype.slice.call(arguments,1));var n=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}},dv.util.noop=function(){},dv.util=dv.util||{},dv.util.svg={},dv.util.svg.getDasharray=function(t){if(-1!=t.indexOf(",")||-1!=t.indexOf(" "))return t;if(R.hasOwnProperty(t))return R[t];throw Error("The dashed line format is invalid")};var R={solid:"",dashed:"7,4",dotted:"2,3",dotdash:"2,3,7,4",longdash:"11,4",twodash:"5,2,11,2"};dv.container=dv.extend(function(){function t(){this._aes={}}var e={x:dv.scale.linear,y:dv.scale.linear,yMin:dv.scale.linear,yMax:dv.scale.linear,xMin:dv.scale.linear,xMax:dv.scale.linear,color:dv.scale.color,fill:dv.scale.color,stroke:dv.scale.color,alpha:dv.scale.linear,shape:dv.scale.shape,size:dv.scale.size,radius:dv.scale.linear,group:dv.scale.ordinal,linetype:dv.scale.linetype,label:dv.scale.identity};return t.render=function(){throw Error("render() must be implemented in a subclass")},t._calculateStats=function(){throw Error("_calculateStats() must be implemented in a subclass")},t._handlePositions=function(){throw Error("_handlePositions() must be implemented in a subclass")},t.getTrainedScale=function(){throw Error("getTrainedScale() must be implemented in a subclass")},t.getExplicitScalesMap=function(){return this._aes},t._normalizeData=function(t){if(t.hasOwnProperty("data")&&!dv.util.isArray(t.data))return t;var e,n={},i=this.getExplicitScalesMap();return dv.util.each(i,function(i){for(var r in i)if(e=i[r],!(e instanceof dv.scale.constant)){var a=t[e.mapping()];dv.util.isArray(a)&&(n[e.property()]=a)}}),n.data=t,n},t.map=function(t,n,i,r){if(i||(i=e[t]().copy().isDefault(!0)),!i)throw Error("There is no default scale associated with this property. Either the property isn't valid or the scale default doesn't exist.");return 4>arguments.length&&(r=0),this._aes[t]||(this._aes[t]={}),this._aes[t][r]=i.property(t).mapping(n).scaleIndex(r),this},t.set=function(t,e){this._aes[t]||(this._aes[t]={});var n=this._aes[t][0]=dv.scale.constant();return dv.util.isFunction(e)?(n.map=e,n.mapToProp=e):n.value(e),this},t.on=function(t,e,n){var i=e&&dv.util.isFunction(e);return i?(this.eventMap=this.eventMap||{},this.eventMap[t]={callback:e,capture:n}):(this.eventMap&&delete this.eventMap[t],this.unregisterEventMap=this.unregisterEventMap||{},this.unregisterEventMap[t]=n),this._removeRegisteredEvents(),this._addRegisteredEvents(),this},t.position=function(t){return arguments.length?(this._position=t,this):this._chart&&!this._position?this._chart.position():this._position},t.delay=function(t){return arguments.length?(this._delay=d3.functor(t),this):this._chart&&dv.util.isUndefined(this._delay)?this._chart.delay():this._delay},t.duration=function(t){return arguments.length?(this._duration=d3.functor(t),this):this._chart&&dv.util.isUndefined(this._duration)?this._chart.duration():this._duration},t.ease=function(t){return arguments.length?(this._ease=t,this):this._chart&&dv.util.isUndefined(this._ease)?this._chart.ease():this._ease},t}),dv.coord=dv.extend(function(){function t(){this._flip=!1}return t.flip=function(t){return arguments.length?(this._flip=t,this):this._flip},t.startX=function(t){return arguments.length?(dv.util.isValidValue(t,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, startX/startAngle must be a number or percent string",data:{val:t}}),this._startX=t,this):this._startX},t.endX=function(t){return arguments.length?(dv.util.isValidValue(t,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, endX/endAngle must be a number or percent string",data:{val:t}}),this._endX=t,this):this._endX},t.startY=function(t){return arguments.length?(dv.util.isValidValue(t,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, startY/innerRadius must be a number or percent string",data:{val:t}}),this._startY=t,this):this._startY},t.endY=function(t){return arguments.length?(dv.util.isValidValue(t,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, endY/outerRadius must be a number or percent string",data:{val:t}}),this._endY=t,this):this._endY},t}),dv.coord.cartesian=dv.coord.extend(function(){function t(){this._super(),this.startX(0),this.endX(0),this.startY(0),this.endY(0),this._type="cartesian"}return t._translatePercentToX=function(t,e){var n=dv.util.scaleRange(t);return this._translatePercent(e,n,this.startX(),this.endX())},t._translatePercentToY=function(t,e){var n=dv.util.scaleRange(t);return this._translatePercent(e,n,this.startY(),this.endY())},t._translatePercent=function(t,e,n,i){return(e[1]-e[0]-i-n)*t+n+e[0]},t._translatePercentArrToY=function(t,e){var n=this;return dv.util.map(e,function(e){return n._translatePercentToY(t,e)})},t._translatePercentArrToX=function(t,e){var n=this;return dv.util.map(e,function(e){return n._translatePercentToX(t,e)})},t._text=function(){function t(){var n=dv.svg.text();return e._flip?n.x(function(n,i){return e._translatePercentToY(n.panel.yOuterScale(),t.y()(n,i))}).y(function(n,i){return e._translatePercentToX(n.panel.xOuterScale(),t.x()(n,i))}):n.x(function(n,i){return e._translatePercentToX(n.panel.xOuterScale(),t.x()(n,i))}).y(function(n,i){return e._translatePercentToY(n.panel.yOuterScale(),t.y()(n,i))})}var e=this;return t.x=function(t){return arguments.length?(this._x=t,this):this._x},t.y=function(t){return arguments.length?(this._y=t,this):this._y},t},t._point=function(){var t=this,e={};return e.renderer=dv.svg.symbol().x(function(t){return t.bounds.x}).y(function(t){return t.bounds.y}),e.getBounds=function(n,i){return n.hasOwnProperty("y")||(n.y=0),e._defined(n,i)?(n.bounds=t._flip?{x:t._translatePercentToY(n.panel.yOuterScale(),e.y()(n,i)),y:t._translatePercentToX(n.panel.xOuterScale(),e.x()(n,i))}:{x:t._translatePercentToX(n.panel.xOuterScale(),e.x()(n,i)),y:t._translatePercentToY(n.panel.yOuterScale(),e.y()(n,i))},n):null},e.getPath=function(t){return null===t||void 0===t.bounds?null:e.renderer(t)},e.x=function(t){return arguments.length?(this._x=t,e):this._x},e.y=function(t){return arguments.length?(this._y=t,e):this._y},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._line=function(){var t=this,e={};return e.renderer=d3.svg.line().x(function(t){return t.bounds.x}).y(function(t){return t.bounds.y}),e.getBounds=function(n){var i=[];return dv.util.each(n,function(r,a){r.hasOwnProperty("y")||(r.y=0),e._defined(r,a)&&(r.bounds=t._flip?{x:t._translatePercentToY(r.panel.yOuterScale(),e.y()(r,a)),y:t._translatePercentToX(r.panel.xOuterScale(),e.x()(r,a))}:{x:t._translatePercentToX(r.panel.xOuterScale(),e.x()(r,a)),y:t._translatePercentToY(r.panel.yOuterScale(),e.y()(r,a))},i.push(n[a]))}),i},e.getPath=function(t){return null===t?null:e.renderer(t)},e.x=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.x must be a function",data:{val:t}}),this._x=t,this):this._x},e.y=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.y must be a function",data:{val:t}}),this._y=t,this):this._y},e.defined=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.defined must be a function",data:{val:t}}),this._defined=t,this):this._defined},e},t._area=function(){var t=this,e={};return e.renderer=d3.svg.area(),e.getBounds=function(n){var i=[];return e.setupRenderer(),dv.util.each(n,function(n,r){if(n.hasOwnProperty("y")||(n.y=0),e._defined(n,r)){var a=dv.util.clone(n);a.bounds={x:t._translatePercentToX(n.panel.xOuterScale(),e.x()(n,r)),y0:t._translatePercentToY(n.panel.yOuterScale(),e.y0()(n,r)),y1:t._translatePercentToY(n.panel.yOuterScale(),e.y1()(n,r))},i.push(a)}}),i},e.getPath=function(t){return e.setupRenderer(),null===t?null:e.renderer(t)},e.setupRenderer=function(){t._flip?e.renderer.x(null).y0(null).y1(null).y(function(t){return t.bounds.x}).x0(function(t){return t.bounds.y0}).x1(function(t){return t.bounds.y1}):e.renderer.y(null).x0(null).x1(null).x(function(t){return t.bounds.x}).y0(function(t){return t.bounds.y0}).y1(function(t){return t.bounds.y1})},e.x=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, area.x must be a function",data:{val:t}}),this._x=t,this):this._x},e.y0=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, area.y0 must be a function",data:{val:t}}),this._y0=t,this):this._y0},e.y1=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, area.y1 must be a function",data:{val:t}}),this._y1=t,this):this._y1},e.defined=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, area.defined must be a function",data:{val:t}}),this._defined=t,this):this._defined},e},t._rect=function(){var t=this,e={};return e.renderer=dv.svg.rect().x0(function(t){return t.bounds.x0}).x1(function(t){return t.bounds.x1}).y0(function(t){return t.bounds.y0}).y1(function(t){return t.bounds.y1}),e.getBounds=function(n,i){var r=dv.util.clone(n),a=r[n.panel.xScale(n).property()];dv.util.isArray(a)&&(r.x0=a[0],r.x1=a[1]);var o=r[n.panel.yScale(n).property()];return dv.util.isArray(o)&&(r.y0=o[0],r.y1=o[1]),e._defined(r,i)?(r.bounds=t._flip?{x0:t._translatePercentToY(n.panel.yOuterScale(),e.y0()(r,i)),x1:t._translatePercentToY(n.panel.yOuterScale(),e.y1()(r,i)),y0:t._translatePercentToX(n.panel.xOuterScale(),e.x0()(r,i)),y1:t._translatePercentToX(n.panel.xOuterScale(),e.x1()(r,i))}:{x0:t._translatePercentToX(n.panel.xOuterScale(),e.x0()(r,i)),x1:t._translatePercentToX(n.panel.xOuterScale(),e.x1()(r,i)),y0:t._translatePercentToY(n.panel.yOuterScale(),e.y0()(r,i)),y1:t._translatePercentToY(n.panel.yOuterScale(),e.y1()(r,i))},r):null},e.getPath=function(t){return null===t?null:e.renderer(t)},e.x0=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.x0 must be a function",data:{val:t}}),this._x0=t,this):this._x0},e.x1=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.x1 must be a function",data:{val:t}}),this._x1=t,this):this._x1},e.y0=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.y0 must be a function",data:{val:t}}),this._y0=t,this):this._y0},e.y1=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.y1 must be a function",data:{val:t}}),this._y1=t,this):this._y1},e.defined=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.defined must be a function",data:{val:t}}),this._defined=t,this):this._defined
},e},t._errorBar=function(){var t=this,e={};return e.renderer=dv.svg.errorBar().x0(function(t){return t.bounds.x0}).x1(function(t){return t.bounds.x1}).y0(function(t){return t.bounds.y0}).y1(function(t){return t.bounds.y1}),e.getBounds=function(n,i){var r=dv.util.clone(n);return e._defined(r,i)?(r.bounds=t._flip?{x0:t._translatePercentToY(n.panel.yOuterScale(),e.y0()(r,i)),x1:t._translatePercentToY(n.panel.yOuterScale(),e.y1()(r,i)),y0:t._translatePercentToX(n.panel.xOuterScale(),e.x0()(r,i)),y1:t._translatePercentToX(n.panel.xOuterScale(),e.x1()(r,i))}:{x0:t._translatePercentToX(n.panel.xOuterScale(),e.x0()(r,i)),x1:t._translatePercentToX(n.panel.xOuterScale(),e.x1()(r,i)),y0:t._translatePercentToY(n.panel.yOuterScale(),e.y0()(r,i)),y1:t._translatePercentToY(n.panel.yOuterScale(),e.y1()(r,i))},r):null},e.getPath=function(t){return null===t?null:e.renderer(t)},e.x0=function(t){return arguments.length?(this._x0=t,this):this._x0},e.x1=function(t){return arguments.length?(this._x1=t,this):this._x1},e.y0=function(t){return arguments.length?(this._y0=t,this):this._y0},e.y1=function(t){return arguments.length?(this._y1=t,this):this._y1},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._poly=function(){var t=this,e={};return e.renderer=dv.svg.poly().xs(function(t){return t.bounds.x}).ys(function(t){return t.bounds.y}),e.getBounds=function(n,i){var r=dv.util.clone(n);return e._defined(n,i)&&(r.bounds=t._flip?{x:t._translatePercentArrToY(n.panel.yOuterScale(),e.ys()(n,i)),y:t._translatePercentArrToX(n.panel.xOuterScale(),e.xs()(n,i))}:{x:t._translatePercentArrToX(n.panel.xOuterScale(),e.xs()(n,i)),y:t._translatePercentArrToY(n.panel.yOuterScale(),e.ys()(n,i))}),r},e.getPath=function(t){return null===t?null:e.renderer(t)},e.xs=function(t){return arguments.length?(this._xs=t,this):this._xs},e.ys=function(t){return arguments.length?(this._ys=t,this):this._ys},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t}),dv.coord.polar=dv.coord.extend(function(){function t(){this._super(),this.innerRadius=this.startY,this.outerRadius=this.endY,this.startAngle=this.startX,this.endAngle=this.endX,this.innerRadius(0),this.outerRadius(0),this.startAngle(0),this.endAngle(360),this._type="polar"}return t._transformAngleRadiusToXY=function(t,e){return t+=-1.570796327,[e*Math.cos(t),e*Math.sin(t)]},t._translatePercentToRadius=function(t,e){var n=Math.abs(t[1]-t[0])/2,i=dv.util.getPercentValue(this.innerRadius(),n),r=dv.util.getPercentValue(this.outerRadius(),n);return(n-r-i)*e+i},t._translatePercentToTheta=function(t,e){var n=360,i=dv.util.getPercentValue(this.startAngle(),n),r=dv.util.getPercentValue(this.endAngle(),n),a=(r-i)*e+i;return.017453293*a},t._translatePercentArrToRadius=function(t,e){var n=this;return dv.util.map(e,function(e){return n._translatePercentToRadius(t,e)})},t._translatePercentArrToTheta=function(t,e){var n=this;return dv.util.map(e,function(e){return n._translatePercentToTheta(t,e)})},t._getRadiusRange=function(t,e){var n=dv.util.scaleRange(t),i=dv.util.scaleRange(e);return[0,Math.min(Math.abs(n[1]-n[0]),Math.abs(i[1]-i[0]))]},t._text=function(){function t(){var n=dv.svg.text.radial();return e._flip?n.angle(function(n,i){return e._translatePercentToTheta(n.panel.xOuterScale(),t.x()(n,i))}).radius(function(n,i){return e._translatePercentToRadius(e._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale()),t.y()(n,i))}):n.angle(function(n,i){return e._translatePercentToTheta(n.panel.yOuterScale(),t.y()(n,i))}).radius(function(n,i){return e._translatePercentToRadius(e._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale()),t.x()(n,i))})}var e=this;return t.x=function(t){return arguments.length?(this._x=t,this):this._x},t.y=function(t){return arguments.length?(this._y=t,this):this._y},t},t._point=function(){var t=this,e={};return e.renderer=dv.svg.symbol.radial().angle(function(t){return t.bounds.x}).radius(function(t){return t.bounds.y}),e.getBounds=function(n,i){if(n.hasOwnProperty("y")||(n.y=0),e._defined(n,i)){var r=t._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale());n.bounds=t._flip?{x:t._translatePercentToTheta(n.panel.xOuterScale(),e.y()(n,i)),y:t._translatePercentToRadius(r,e.x()(n,i))}:{x:t._translatePercentToTheta(n.panel.xOuterScale(),e.x()(n,i)),y:t._translatePercentToRadius(r,e.y()(n,i))}}return n},e.getPath=function(t){return null===t||dv.util.isUndefined(t.bounds)?null:e.renderer(t)},e.x=function(t){return arguments.length?(this._x=t,this):this._x},e.y=function(t){return arguments.length?(this._y=t,this):this._y},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._line=function(){var t=this,e={};return e.renderer=d3.svg.line.radial().angle(function(t){return t.bounds.x}).radius(function(t){return t.bounds.y}),e.getBounds=function(n){var i=[];return dv.util.each(n,function(r,a){var o=t._getRadiusRange(r.panel.xOuterScale(),r.panel.yOuterScale());r.hasOwnProperty("y")||(r.y=0),e._defined(r,a)&&(r.bounds=t._flip?{x:t._translatePercentToTheta(r.panel.xOuterScale(),e.y()(r,a)),y:t._translatePercentToRadius(o,e.x()(r,a))}:{x:t._translatePercentToTheta(r.panel.xOuterScale(),e.x()(r,a)),y:t._translatePercentToRadius(o,e.y()(r,a))},i.push(n[a]))}),i},e.getPath=function(t){return null===t?null:e.renderer(t)},e.x=function(t){return arguments.length?(this._x=t,this):this._x},e.y=function(t){return arguments.length?(this._y=t,this):this._y},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._area=function(){var t=this,e={};return e.renderer=d3.svg.area.radial(),e.getBounds=function(n){var i=[];return e.setupRenderer(),dv.util.each(n,function(n,r){var a=t._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale());if(n.hasOwnProperty("y")||(n.y=0),e._defined(n,r)){var o=dv.util.clone(n);o.bounds=t._flip?{x:t._translatePercentToRadius(a,e.x()(n,r)),y0:t._translatePercentToTheta(n.panel.xOuterScale(),e.y0()(n,r)),y1:t._translatePercentToTheta(n.panel.xOuterScale(),e.y1()(n,r))}:{x:t._translatePercentToTheta(n.panel.xOuterScale(),e.x()(n,r)),y0:t._translatePercentToRadius(a,e.y0()(n,r)),y1:t._translatePercentToRadius(a,e.y1()(n,r))},i.push(o)}}),i},e.getPath=function(t){return e.setupRenderer(),null===t?null:e.renderer(t)},e.setupRenderer=function(){t._flip?e.renderer.angle(null).innerRadius(null).outerRadius(null).radius(function(t){return t.bounds.x}).startAngle(function(t){return t.bounds.y0}).endAngle(function(t){return t.bounds.y1}):e.renderer.radius(null).startAngle(null).endAngle(null).angle(function(t){return t.bounds.x}).innerRadius(function(t){return t.bounds.y0}).outerRadius(function(t){return t.bounds.y1})},e.x=function(t){return arguments.length?(this._x=t,this):this._x},e.y0=function(t){return arguments.length?(this._y0=t,this):this._y0},e.y1=function(t){return arguments.length?(this._y1=t,this):this._y1},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._rect=function(){var t=this,e={};return e.renderer=d3.svg.arc().startAngle(function(t){return t.bounds.x0}).endAngle(function(t){return t.bounds.x1}).innerRadius(function(t){return t.bounds.y0}).outerRadius(function(t){return t.bounds.y1}),e.getBounds=function(n,i){var r=dv.util.clone(n);if(!e._defined(r,i))return null;var a=t._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale());return r.bounds=t._flip?{x0:t._translatePercentToTheta(n.panel.xOuterScale(),e.x0()(r,i)),x1:t._translatePercentToTheta(n.panel.xOuterScale(),e.x1()(r,i)),y0:t._translatePercentToRadius(a,e.y0()(r,i)),y1:t._translatePercentToRadius(a,e.y1()(r,i))}:{x0:t._translatePercentToTheta(n.panel.yOuterScale(),e.y0()(r,i)),x1:t._translatePercentToTheta(n.panel.yOuterScale(),e.y1()(r,i)),y0:t._translatePercentToRadius(a,e.x0()(r,i)),y1:t._translatePercentToRadius(a,e.x1()(r,i))},r},e.getPath=function(t){return null===t?null:e.renderer(t)},e.x0=function(t){return arguments.length?(this._x0=t,this):this._x0},e.x1=function(t){return arguments.length?(this._x1=t,this):this._x1},e.y0=function(t){return arguments.length?(this._y0=t,this):this._y0},e.y1=function(t){return arguments.length?(this._y1=t,this):this._y1},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._poly=function(){var t=this,e={};return e.renderer=dv.svg.poly.radial().angles(function(t){return t.bounds.x}).radii(function(t){return t.bounds.y}),e.getBounds=function(n,i){var r=dv.util.clone(n);if(e._defined(n,i)){var a=t._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale());r.bounds=t._flip?{x:t._translatePercentArrToTheta(n.panel.xOuterScale(),e.ys()(n,i)),y:t._translatePercentArrToRadius(a,e.xs()(n,i))}:{x:t._translatePercentArrToTheta(n.panel.xOuterScale(),e.xs()(n,i)),y:t._translatePercentArrToRadius(a,e.ys()(n,i))}}return r},e.getPath=function(t){return null===t?null:e.renderer(t)},e.xs=function(t){return arguments.length?(this._xs=t,this):this._xs},e.ys=function(t){return arguments.length?(this._ys=t,this):this._ys},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t}),dv.guide=dv.extend(function(){function t(){this._renderer=null}return t._render=function(){dv.log.warn({msg:"dv.guide._render should not be called directly, try using dv.guide.legend.render or dv.guide.axis.render"})},t._scale=function(t){return arguments.length?(this.__scale=t,this):this.__scale},t.orientation=function(t){return arguments.length?(this._orientation=t,this):this._orientation},t._parent=function(t){return arguments.length?(this.__parent=t,this):this.__parent},t.scaleIndex=function(t){return arguments.length?(this._scaleIndex=t,this):this._scaleIndex},t.title=function(t){return arguments.length?(this._title=t,this):this._title},t}),dv.guide.axes=dv.extend(function(){function t(){this._axes={},this._emptyTickFormat=function(){return""}}return t._initializeAxisRenderers=function(){this._eachAxis(function(t,e,n){if(n.hasOwnProperty("_orientation")||"x"!==t||(n._orientation="bottom"),n.hasOwnProperty("_orientation")||"y"!==t||(n._orientation="left"),this._chart._coord.flip())switch(n._orientation){case"top":n._orientation="right";break;case"right":n._orientation="top";break;case"bottom":n._orientation="left";break;case"left":n._orientation="bottom"}})},t._measure=function(t){var e=this._chart._g.select(".panels"),n=this._chart._axisLabelContainer;return this._eachAxis(function(i,r,a){var o=this._changeScaleRangeToLocal(t.getOuterScale(i));this._chart._coord instanceof dv.coord.polar||"none"===a||(a._chart(this._chart)._scale(o[r])._parent(e)._labelParent(n),t.margins(a._measure(t.margins(),t.bounds(),t)))}),this},t._getAllOrientations=function(){var t={};return this._eachAxis(function(e,n,i){t[i._orientation]=e}),t},t._render=function(t,e,n){return this._eachAxis(function(i,r,a){var o=this._changeScaleRangeToLocal(n.getOuterScale(i));this._chart._coord instanceof dv.coord.polar||"none"===a?(t.selectAll(".axis-"+i+".axis-index-"+r).transition().duration(this._chart._duration).style("opacity",0).remove(),this._chart._chartContainer.select(".axes-labels .axis-"+i+".axis-index-"+r).transition().duration(this._chart._duration).style("opacity",0).remove()):a._chart(this._chart)._parent(t)._scale(o[r])._labelParent(e)._render(t,n,n.bounds())}),this},t._measureTitles=function(t){var e=this._chart._axisLabelContainer;return this._eachAxis(function(n,i,r){if("none"!==r){var a=r._chart(this._chart)._measureAxisTitle(e,n,i);t.left+=a.left,t.top+=a.top,t.right-=a.right,t.bottom-=a.bottom}}),t},t._renderTitles=function(t){var e=this._chart._axisLabelContainer;this._eachAxis(function(n,i,r){"none"!==r&&r.title()?r._chart(this._chart)._renderAxisTitle(e,t,n,i):e.selectAll(".axis-title-"+n+".axis-title-index-"+i).transition().duration(this._chart._duration).style("opacity",0).remove()})},t._changeScaleRangeToLocal=function(t){var e=t.range(),n=t.innerScaleGroup();for(var i in n)dv.util.scaleRange(n[i],[e[0],e[1]]);return n},t._eachAxis=function(t){for(var e in this._axes){var n=this._axes[e];for(var i in n)t.call(this,e,+i,n[i])}},t._add=function(t,e,n){n=void 0===n?0:n;var i=this._axes[t];return i||(this._axes[t]=i={}),i[n]=e,this},t._axes=function(t){return arguments.length?(this._axes=t,this):this._axes},t._get=function(t){return this._axes[t]},t._empty=function(){for(var t in this._axes)delete this._axes[t];return this._axes={},this},t._chart=function(t){return arguments.length?(this._chart=t,this):this._chart},t}),dv.guide.axis=dv.guide.extend(function(){function t(){this._ticks=d3.functor(5),this._tickInterval=void 0,this._labelGroup=null,this._htmlLabels=!1}function e(t){return t+"%"}return t._measure=function(t,e,n){var i,r=this._getAxisOffset(e),a=dv.util.scaleRange(this._scale()),o=this._ticks.call(this,Math.abs(a[1]-a[0])),s=this,l=this._parent().append("g").classed("temp-axis",!0);this._shouldDrawAxisLabels(n)&&(i=this._constructLabelGroup(this.__labelParent,r,!0));var u=this._constructD3Axis(i,e,o,n),c=this._measureAxis(l,r,u),h={left:c.x+r[0],top:c.y+r[1],right:c.x+c.width+r[0],bottom:c.y+c.height+r[1]};i&&i.selectAll("span").each(function(){var t=this,e=d3.select(this),n=s._htmlLabels?e.html():e.text();if(n){var i="right"===s._orientation?t.offsetWidth/2:0,r="bottom"===s._orientation?t.offsetHeight/2:0,a=[t.parentNode.parentNode.offsetLeft+t.parentNode.offsetLeft+i,t.parentNode.parentNode.offsetTop+t.parentNode.offsetTop+r];h.left=Math.min(a[0],h.left),h.top=Math.min(a[1],h.top),h.right=Math.max(a[0]+i,h.right),h.bottom=Math.max(a[1]+r,h.bottom)}}),l.remove(),i&&i.remove();var d={};return d.left=Math.abs(Math.min(h.left-e.left,0)),d.top=Math.abs(Math.min(h.top-e.top,0)),d.right=Math.max(h.right-e.right,0),d.bottom=Math.max(h.bottom-e.bottom,0),this._unionAxisPadding(d,t)},t._render=function(t,e,n){if(!this._scale())throw Error("The axis does not have a scale associated with it.");var i,r=dv.util.scaleRange(this._scale()),a=this._ticks.call(this,Math.abs(r[1]-r[0])),o=this._getAxisOffset(n);this._shouldDrawAxisLabels(e)?i=this._constructLabelGroup(this.__labelParent,o):this.__labelParent.selectAll(".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()).remove();var s=this._constructD3Axis(i,n,a,e);return this._renderAxis(this._parent(),e.bounds(),o,s,i),this},t._shouldDrawAxisLabels=function(t){var e=t.facet(),n=this._scale().property(),i=this.orientation();return e._isFree(n)&&e._showAllPanelLabelsIfFree()||t.visibleAxisLabelOrientations()[i]},t._unionAxisPadding=function(t,e){return e.left=Math.max(e.left,t.left),e.top=Math.max(e.top,t.top),e.right=Math.max(e.right,t.right),e.bottom=Math.max(e.bottom,t.bottom),e},t._constructLabelGroup=function(t,e,n){var i=".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()+(n?" .temp-axis":""),r=t.selectAll(i).data([0]);return r.enter().append("div").classed("axis-"+this._scale().property()+" axis-index-"+this._scale().scaleIndex(),!0).classed("temp-axis",n).style("left",e[0]+"px").style("top",e[1]+"px"),dv.ANIMATION?r.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease()).style("left",e[0]+"px").style("top",e[1]+"px"):r.style("left",e[0]+"px").style("top",e[1]+"px"),r},t._getAxisOffset=function(t){switch(this._orientation){case"bottom":return[0,t.bottom];case"left":return[t.left,0];case"top":return[0,t.top];case"right":return[t.right,0]}},t._constructD3Axis=function(t,n,i,r){var a,o=dv.util.isUndefined(this._tickSize)?this._getDefaultTickSize(n):this._tickSize,s=dv.util.isUndefined(this._minorTickSize)?this._getDefaultTickSize(n):this._minorTickSize;if("left"===this._orientation&&(a="right"),"right"===this._orientation&&(a="left"),"top"===this._orientation&&(a="bottom"),"bottom"===this._orientation&&(a="top"),"x"===this._scale().property()){var l=dv.util.scaleRange(this._scale());l[0]+=this._chart().coord().startX(),l[1]-=this._chart().coord().endX(),this._scale()instanceof dv.scale.ordinal?this._scale().rangeBands(l):this._scale().range(l)}return dv.svg.axis()._orient(a)._labelParent(t)._panel(r)._ticks(dv.util.isUndefined(i)?5:i,this._tickInterval)._tickSize(o,s,o)._tickDx(dv.util.isUndefined(this._tickDx)?this._getDefaultTickDx():this._tickDx)._tickDy(dv.util.isUndefined(this._tickDy)?this._getDefaultTickDy():this._tickDy)._tickAnchor(dv.util.isUndefined(this._tickAnchor)?this._getDefaultTickAnchor():this._tickAnchor)._tickFormat(dv.util.isUndefined(this._tickFormat)&&"fill"===this._chart().position()&&"y"===this._scale().property()?e:this._tickFormat)._tickValues(this._tickValues)._htmlLabels(this._htmlLabels)._tickSubdivide(this._tickSubdivide)._scale(this._scale()._d3Scale)},t._renderAxis=function(t,e,n,i,r){var a=t.selectAll(".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()).data([0]);i._labelParent(r),a.enter().append("g").classed("axis axis-"+this._scale().property()+" axis-index-"+this._scale().scaleIndex(),!0).attr("transform","translate("+n[0]+","+n[1]+")"),dv.ANIMATION&&(a=a.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease())),a.attr("transform","translate("+n[0]+","+n[1]+")").call(i)},t._measureAxis=function(t,e,n){return t.attr("transform","translate("+e[0]+","+e[1]+")").call(n),t.node().getBBox()},t._measureAxisTitle=function(t,e,n){var i={left:0,top:0,right:0,bottom:0};if(this._title){var r=t.append("div").classed("temp-axis-title",!0),a=this._titleOrientation||this._orientation,o=this._createAxisTitle(r,a,e,n),s=o.node().getBoundingClientRect();i[a]+="top"===a||"bottom"===a?s.height:s.width,r.remove()}return i},t._renderAxisTitle=function(t,e,n,i){var r,a=this._titleOrientation||this._orientation;if(this._title){var o=t.selectAll(".axis-title-"+n+".axis-title-index-"+i).empty(),s=this._createAxisTitle(t,a,n,i);dv.ANIMATION&&(r=s.transition().duration(this._chart().duration()).delay(this._chart().delay()).ease(this._chart().ease())),this._positionAxisTitle(o||!dv.ANIMATION?s:r,e[a],a),r?r.style("opacity",1):s.style("opacity",1)}},t._createAxisTitle=function(e,n,i,r){var a=e.selectAll(".axis-title-"+i+".axis-title-index-"+r).data([t]);return a.enter().append("div").classed("axis-title axis-title-"+i+" axis-title-index-"+r,!0).style("opacity",dv.ANIMATION?0:1).style("position","absolute"),a.text(this._title).classed("top bottom left right",!1).classed(n,!0)},t._positionAxisTitle=function(t,e,n){t.style("left",function(){var t=0;return e[0]+t+"px"}).style("top",function(){var t=0;return"top"===n&&(t=-this.offsetHeight),("right"===n||"left"===n)&&(t=-this.offsetHeight/2),e[1]+t+"px"})},t._getDefaultTickSize=function(t){return"bottom"===this._orientation?d3.functor(t.bottom-t.top):"left"===this._orientation?d3.functor(t.right-t.left):"top"===this._orientation?d3.functor(t.bottom-t.top):d3.functor(t.right-t.left)},t._getDefaultTickDx=function(){return"bottom"===this._orientation||"top"===this._orientation?d3.functor(0):d3.functor(-12)},t._getDefaultTickDy=function(){return"bottom"===this._orientation||"top"===this._orientation?d3.functor(-12):d3.functor(0)},t._getDefaultTickAnchor=function(){return"left"===this._orientation?d3.functor("end"):"right"===this._orientation?d3.functor("start"):d3.functor("middle")},t._labelParent=function(t){return arguments.length?(this.__labelParent=t,this):this.__labelParent},t.ticks=function(t,e){return arguments.length?(arguments.length>1?(this._ticks=function(){return t},this._tickInterval=e):(this._ticks=d3.functor(t),this._tickInterval=void 0),this):dv.util.isFinite(this._tickInterval)?[this._ticks,this._tickInterval]:this._ticks},t.tickSubdivide=function(t){return arguments.length?(this._tickSubdivide=t,this):this._tickSubdivide},t.tickSize=function(t){return arguments.length?(this._tickSize=d3.functor(t),this):this._tickSize},t.minorTickSize=function(t){return arguments.length?(this._minorTickSize=d3.functor(t),this):this._minorTickSize},t.tickDx=function(t){return arguments.length?(this._tickDx=d3.functor(t),this):this._tickDx},t.htmlLabels=function(t){return arguments.length?(this._htmlLabels=t,this):this._htmlLabels},t.tickDy=function(t){return arguments.length?(this._tickDy=d3.functor(t),this):this._tickDy},t.tickAnchor=function(t){return arguments.length?(this._tickAnchor=d3.functor(t),this):this._tickAnchor},t.tickFormat=function(t){if(!arguments.length){var e=this._scale()._d3Scale;return this._tickFormat?this._tickFormat:e.tickFormat?e.tickFormat(e):function(t){return t}}return this._tickFormat=t,this},t.tickValues=function(t){return arguments.length?(this._tickValues=t,this):this._tickValues},t.titleOrientation=function(t){return arguments.length?(this._titleOrientation=t,this):this._titleOrientation},t._chart=function(t){return arguments.length?(this.__chart=t,this):this.__chart},t}),dv.svg.axis=function(){function t(t,e){t.attr("transform",function(t){return"translate("+e(t)+",0)"})}function e(t,e){t.attr("transform",function(t){return"translate(0,"+e(t)+")"})}function n(t,e,n){var i=d3.select(t).select("span").node().offsetWidth,r="end"===n?-i:"middle"===n?-i/2:0;return e+r}function i(t,e,n){var i=d3.select(t).select("span").node().offsetHeight,r="top"===n?0:"middle"===n?-i/2:-i;return e+r}function r(t,e,n){var i=[];if(n&&e.length>1){for(var r,a,o=dv.util.scaleExtent(t.domain()),s=-1,l=e.length,u=(e[1]-e[0])/++n;l>++s;)for(r=n;--r>0;)(a=+e[s]-r*u)>=o[0]&&i.push(a);for(--s,r=0;n>++r&&(a=+e[s]+r*u)<o[1];)i.push(a)}return i}function a(a){var x=function(t,e,r,a,o){var s={};switch(o){case"top":s.top=i(t,-f.call(t,e,r),"top"),s.left=a(e)+n(t,p.call(t,e,r),g.call(t,e,r));break;case"bottom":s.top=i(t,f.call(t,e,r),"bottom"),s.left=a(e)+n(t,p.call(t,e,r),g.call(t,e,r));break;case"right":s.top=a(e)+i(t,f.call(t,e,r),"middle"),s.left=n(t,p.call(t,e,r),g.call(t,e,r));break;case"left":s.top=a(e)+i(t,f.call(t,e,r),"middle"),s.left=n(t,-p.call(t,e,r),g.call(t,e,r))}return s.top=(isNaN(s.top)?0:s.top)+"px",s.left=(isNaN(s.left)?0:s.left)+"px",d3.select(t).classed("start middle end",!1).classed(g.call(t,e,r),!0),s},b=function(t,e){["top","left"].forEach(function(n){t.style(n,function(t,i){return e[i][n]})})},A=function(t,e,n){if(s){var i,r,a,c,h=null==o?l.tickFormat?l.tickFormat.apply(l,m):String:o;s.style("position","absolute"),i=s.selectAll(".axis-label").data(t,String),r=i.enter().append("div").classed("axis-label",!0).style("opacity",1e-6).style("position","absolute"),a=d3.transition(i.exit()).style("opacity",1e-6).remove(),c=d3.transition(i).style("opacity",1),r.append("span");var d=i.selectAll("span"),p=function(t,e,n){return h.call(this,t,n)};_?d.html(p):d.text(p);var f,g=[],v=[],y=[],A=[];if(!l.ticks){var k=l.rangeBand()/2;f=function(t){return n(t)+k}}r.each(function(t,n){g[n]=x(this,t,n,f||e,u)}),c.each(function(t,i){v[i]=x(this,t,i,f||e,u),y[i]=x(this,t,i,f||n,u)}),l.ticks&&a.each(function(t,e){A[e]=x(this,t,e,n,u)}),b(r,g),b(i,v),b(c,y),l.ticks&&b(a,A)}};a.each(function(){var n,i=d3.select(this),a=null==v?l.ticks?l.ticks.apply(l,m):l.domain():v,o=r(l,a,y),s=i.selectAll(".minor").data(o,String),p=s.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),f=d3.transition(s.exit()).style("opacity",1e-6).remove(),g=d3.transition(s).style("opacity",1),_=i.selectAll(".axis-tick").data(a,String),x=_.enter().insert("g","path").classed("axis-tick",!0).style("opacity",1e-6),b=d3.transition(_.exit()).style("opacity",1e-6).remove(),k=d3.transition(_).style("opacity",1),P=dv.util.scaleRangeNoReverse(l);path=i.selectAll(".domain").data([0]),pathEnter=path.enter().append("path").attr("class","domain"),pathUpdate=d3.transition(path);var S=l.copy(),w=this.__chart__||S;this.__chart__=S,x.append("line").attr("class","tick");var M=x.select("line"),T=k.select("line");switch(u){case"bottom":n=t,p.attr("y2",function(t,e){return h.call(this,t,e,panel)}),g.attr("x2",0).attr("y2",function(t,e){return h.call(this,t,e,panel)}),M.attr("y2",function(t,e){return c.call(this,t,e,panel)}),T.attr("x2",0).attr("y2",function(t,e){return c.call(this,t,e,panel)}),pathUpdate.attr("d",function(t,e){return"M"+P[0]+","+d.call(this,t,e,panel)+"V0H"+P[1]+"V"+d.call(this,t,e,panel)});break;case"top":n=t,p.attr("y2",function(t,e){return-h.call(this,t,e,panel)}),g.attr("x2",0).attr("y2",function(t,e){return-h.call(this,t,e,panel)}),M.attr("y2",function(t,e){return-c.call(this,t,e,panel)}),T.attr("x2",0).attr("y2",function(t,e){return-c.call(this,t,e,panel)}),pathUpdate.attr("d",function(t,e){return"M"+P[0]+","+-d.call(this,t,e,panel)+"V0H"+P[1]+"V"+-d.call(this,t,e,panel)});break;case"left":n=e,p.attr("x2",function(t,e){return-h.call(this,t,e,panel)}),g.attr("x2",function(t,e){return-h.call(this,t,e,panel)}).attr("y2",0),M.attr("x2",function(t,e){return-c.call(this,t,e,panel)}),T.attr("x2",function(t,e){return-c.call(this,t,e,panel)}).attr("y2",0),pathUpdate.attr("d",function(t,e){return"M"+-d.call(this,t,e,panel)+","+P[0]+"H0V"+P[1]+"H"+-d.call(this,t,e,panel)});break;case"right":n=e,p.attr("x2",function(t,e){return h.call(this,t,e,panel)}),g.attr("x2",function(t,e){return h.call(this,t,e,panel)}).attr("y2",0),M.attr("x2",function(t,e){return c.call(this,t,e,panel)}),T.attr("x2",function(t,e){return c.call(this,t,e,panel)}).attr("y2",0),pathUpdate.attr("d",function(t,e){return"M"+d.call(this,t,e,panel)+","+P[0]+"H0V"+P[1]+"H"+d.call(this,t,e,panel)})}if(l.ticks)x.call(n,w),k.call(n,S),b.call(n,S),p.call(n,w),g.call(n,S),f.call(n,S);else{var O=S.rangeBand()/2,E=function(t){return S(t)+O};x.call(n,E),k.call(n,E)}A(a,w,S)})}var o,s,l=d3.scale.linear(),u="bottom",c=d3.functor(6),h=d3.functor(6),d=d3.functor(6),p=d3.functor(0),f=d3.functor(0),g=d3.functor("start"),m=[10],v=null,_=!1,y=0;return a._scale=function(t){return arguments.length?(l=t,a):l},a._orient=function(t){return arguments.length?(u=t,a):u},a._ticks=function(){return arguments.length?(m=arguments,a):m},a._tickValues=function(t){return arguments.length?(v=t,a):v},a._tickFormat=function(t){return arguments.length?(o=t,a):o},a._htmlLabels=function(t){return arguments.length?(_=t,a):_},a._tickSize=function(t,e){if(!arguments.length)return c;var n=arguments.length-1;return c=d3.functor(t),h=n>1?d3.functor(e):c,d=n>0?d3.functor(arguments[n]):c,a},a._tickDx=function(t){return arguments.length?(p=t,a):p},a._tickDy=function(t){return arguments.length?(f=t,a):f},a._tickAnchor=function(t){return arguments.length?(g=t,a):g},a._tickSubdivide=function(t){return arguments.length?(y=+t,a):y},a._panel=function(t){return arguments.length?(panel=t,a):panel},a._labelParent=function(t){return arguments.length?(s=t,a):s},a},dv.guide.legends=dv.extend(function(){function t(){this._legArr=[],this.__hide=!1,this._ad={left:0,right:0,width:0,height:0}}return t._render=function(t){if(this._w=0,this._h=0,!this.__hide){var e=t.el.select(".legends"),n=this,i=e.selectAll(".legend").data(this._legArr);i.exit().transition().duration(t.duration).style("opacity",0).remove();var r=i.enter().append("g").classed("legend",!0);dv.ANIMATION&&r.style("opacity",0),i.each(function(e){for(var i={},r=(e.props[0],n._getScale(t,e.props[0])),a=r.domain(),o=0;e.props.length>o;o++){var s=e.props[o],l=n._getScale(t,e.props[o]);if(!l.hasSameDomain(a))throw Error("Can't render single legend from multiple domains");i[s]=t.scales[s]}e.guide._render(d3.select(this),i,{dims:n._ad,renderOpts:t}),n._w+=e.guide._getUsedWidth(),n._h+=e.guide._getUsedHeight(),n._ad=e.guide._getAdjustedDimensions(n._ad)})}return this},t._getScale=function(t,e){var n=t.scales[e];if(void 0===e||void 0===n||void 0===n[0])throw Error("A '"+e+"'' legend has been called for, but '"+e+" hasn't been mapped to data.");return n[0]},t._add=function(t){return this._legArr.push(t),this},t._remove=function(t){for(var e in t)for(var n=t[e],i=0;this._legArr.length>i;i++){for(var r=this._legArr[i].props,a=!0,o=0;r.length>o;o++)r[o]===n&&(r.splice(o,1),o--),0===r.length&&(a=!1);a||(this._legArr.splice(i,1),i--)}},t._legends=function(t){return arguments.length?(this._legArr=t,this):this._legArr},t._allowedDimensions=function(t){return arguments.length?(this._ad=t,this):this._ad},t._getWidth=function(){return this._w},t._getHeight=function(){return this._h},t._hide=function(t){return arguments.length?(this.__hide=t,this):this.__hide},t._empty=function(){for(var t=0;this._legArr.length>t;t++)delete this._legArr[t];return this._legArr=[],this},t}),dv.guide.legend=dv.guide.extend(function(){function t(){this._overlay=!1,this._orientation="top",this._vGap=5,this._hGap=15,this._defaultPadding=this._padding={top:10,left:10,right:10,bottom:10},this._swatchWidth=15,this._swatchHeight=10,this._innerPadding=5,this._spanPercent=.75,this._lineHeight=0}function e(t){var e=this,n=[],i=[];for(var r in this._scales){n=this._scales[r][0].domain();break}var a=t.selectAll(".legend-entry").data(n);a.exit().transition().duration(this._renderingOptions.duration).style("opacity",0).remove();var s=a.enter().append("g").classed("legend-entry",!0);return s.append("path"),s.append("text").classed("legend-entry-label",!0),s.append("text").classed("legend-entry-value",!0),a.select("path").attr("d",function(t,n){return o.call(e,t,n)}).call(function(t){t.attr("style",""),e._scales.hasOwnProperty("fill")&&t.style("fill",function(t){return e._scales.fill[0].mapValue(t)}),e._scales.hasOwnProperty("stroke")&&t.style("stroke",function(t){return e._scales.stroke[0].mapValue(t)}).style("stroke-width",2),e._scales.hasOwnProperty("linetype")&&(t.style("stroke-dasharray",function(t){return dv.util.svg.getDasharray(e._scales.linetype[0].mapValue(t))}),e._scales.hasOwnProperty("stroke")||t.style("stroke","#000"),t.style("stroke-width",2)),e._scales.hasOwnProperty("size")&&t.style("stroke-width",function(t){return e._scales.size[0].mapValue(t)})}).each(function(t,e){i[e]=this.getBBox().width}),a.select("text.legend-entry-label").attr("x",this._swatchWidth+this._innerPadding).attr("y",10).text(function(t,n){return dv.util.isUndefined(e._labels)?t:e._labels[n%e._labels.length]}).each(function(t,n){i[n]+=e._innerPadding+this.getBBox().width}),a.select("text.legend-entry-value").attr("y",10).attr("x",function(t,n){return i[n]+e._innerPadding}).text(function(t,n){return dv.util.isUndefined(e._values)?"":e._values[n]}).style("fill",function(t){return dv.util.isUndefined(e._scales.stroke)?dv.util.isUndefined(e._scales.fill)?void 0:e._scales.fill[0].mapValue(t):e._scales.stroke[0].mapValue(t)}).each(function(t,n){var r=this.getBBox().width;i[n]+=r+(r>0?e._innerPadding:0)}),a.each(function(t,n){i[n]=Math.min(i[n],e._width),e._lineHeight=Math.max(e._lineHeight,this.getBBox().height)}),i}function n(t){for(var e,r=0,a=0,o=0,s=!1,l=0,u=0,c=[],h=0;this._legendWidths.length>h;h++)if(r+=(0===a?0:this._hGap)+this._legendWidths[h],t.data.length>a&&this._width>=r){if(this._legendWidths[h]<=t.data[a]+o)u+=0===a?0:this._hGap,c.push({x:u,y:l}),u+=t.data[a]+o,o=0;else{if((e=this._legendWidths[h]-t.data[a])<=t.padding)return t.padding-=e,t.data[a]=this._legendWidths[h],n.call(this,t);if(!(t.data.length>a+1&&this._legendWidths[h]>=t.data[a]+t.data[a+1]*this._spanPercent+o))return t=i.call(this,t.data.length-1),n.call(this,t);t.data.length>=a+1?(o+=(0===a?0:this._hGap)+t.data[a],r-=(0===a?0:this._hGap)+this._legendWidths[h],h--):(r=r-this._legendWidths[h]+o+t.data[a],o=0,u+=0===a?0:this._hGap,c.push({x:u,y:l}),u+=t.data[a]+o,a++)}a++}else{if(a+1===t.data.length&&t.data.length>1)return t=i.call(this,t.data.length-1),n.call(this,t);a===t.data.length&&(s=!0),l+=this._lineHeight+this._vGap,r=u=0,a=0,o=0,h--}return a===t.data.length&&(s=!0),s?{offsets:c,cols:t}:(t=i.call(this,t.data.length-1),n.call(this,t))}function i(t){var e={data:[],padding:this._width},n=0,r=0;for(this._isVAligned()&&(t=Math.ceil(this._legendWidths.length/Math.floor(this._height/(this._lineHeight+this._vGap)))),r=0;t>r;r++)n+=this._legendWidths[r]+this._hGap;return n-=this._hGap,n>this._width&&t>1?i.call(this,t-1):(e.data=this._legendWidths.slice(0,t),e.padding-=n,0>e.padding&&(e.padding=0),e)}function r(t,e,n,i){return"M"+t+","+e+"L"+(t+n)+","+e+"L"+(t+n)+","+(e+i)+"L"+t+","+(e+i)+"Z"
}function a(t,e,n,i){var r=e+i>>1;return"M"+t+","+r+"L"+n+","+r}function o(){return this._scales.hasOwnProperty("fill")?r.call(this,0,0,this._swatchWidth,this._swatchHeight):a.call(this,0,0,this._swatchWidth,this._swatchHeight)}return t._render=function(t,r,a){var o=t,s=a.dims,l=this;this._renderingOptions=a.renderOpts,this._scales=r,this._transformData=[],this._width=s.width-this._padding.left-this._padding.right,this._height=s.height-this._padding.top-this._padding.bottom,this._legendWidths=e.call(this,t);var u=i.call(this,Math.min(this._legendWidths.length,Math.floor(this._width/this._swatchWidth))),c=n.call(this,u),h=c.offsets;u=c.cols,this._width=this._width-u.padding+this._hGap*(u.data.length-1),this._height=this._lineHeight+h[h.length-1].y,t.selectAll(".legend-entry").each(function(t,e){var n=d3.select(this);dv.ANIMATION&&(n=n.transition().duration(l._renderingOptions.duration).delay(l._renderingOptions.delay).ease(l._renderingOptions.ease)),n.attr("transform","translate("+h[e].x+", "+h[e].y+")")}),this._renderingOptions.firstRender||(o=t.transition().duration(this._renderingOptions.duration).style("opacity",1));var d="right"===this._orientation?s.left+s.width-this._width-this._padding.right:s.left+this._padding.left,p="bottom"===this._orientation?s.top+s.height-this._height-this._padding.bottom:s.top+this._padding.top;o.attr("transform","translate("+d+","+p+")"),this._renderingOptions.firstRender&&o.transition().duration(this._renderingOptions.duration).style("opacity",1)},t._getAdjustedDimensions=function(t){if(this._overlay)return t;var e=this._padding.left+this._width+this._padding.right,n=this._padding.top+this._height+this._padding.bottom;return"left"===this._orientation?(t.left+=e,t.width-=e):"top"===this._orientation?(t.top+=n,t.height-=n):"right"===this._orientation?t.width-=e:"bottom"===this._orientation&&(t.height-=n),t},t._getUsedWidth=function(){return this._overlay?0:this._isVAligned()?this._width+this._padding.left+this._padding.right:0},t._getUsedHeight=function(){return this._overlay?0:this._isVAligned()?0:this._height+this._padding.top+this._padding.bottom},t._isVAligned=function(){return"left"===this._orientation||"right"===this._orientation},t.vGap=function(t){return arguments.length?(this._vGap=t,this):this._vGap},t.hGap=function(t){return arguments.length?(this._hGap=t,this):this._hGap},t.padding=function(t){return arguments.length?(this._padding=dv.util.merge(this._defaultPadding,t),this):this._padding},t.align=function(t){return arguments.length?(this._align=t,this):this._align},t.labels=function(t){return arguments.length?(this._labels=t,this):this._labels},t.values=function(t){return arguments.length?(this._values=t,this):this._values},t.overlay=function(t){return arguments.length?(this._overlay=t,this):this._overlay},t}),dv.guide.custom=dv.guide.extend(function(){function t(){this._render=function(){return dv.log.warn({msg:"empty render function on custom guide"}),this},this._getAdjustedDimensions=function(t){return t},this._getUsedWidth=function(){return 0},this._getUsedHeight=function(){return 0}}return t.setFunc=function(t,e){return this[t]=e,this},t}),dv.geom=dv.container.extend(function(){function t(){this._super(),this._defaultAes={},this._behaviorsLayer=null,this._initializeDefaultAes()}return t._initializeDefaultAes=function(){this._defaultAes.x=1,this._defaultAes.y=1,this._defaultAes.shape="circle",this._defaultAes.linetype="solid"},t._prerender=function(t){this._trainedScales={},this._chart=t,this.normalizedData(this._normalizeData(this.data())),this._calculateStats(),this._inheritChartAesthetics(t)},t._inheritChartAesthetics=function(t){for(var e in t._aes){var n=t._aes[e];this._aes[e]||(this._aes[e]={});for(var i in n)this._aes[e][i]||(this._aes[e][i]=n[i])}},t._trainScales=function(){},t._createDefaultScales=function(){for(var t in this._defaultAes)this._aes.hasOwnProperty(t)||(this._aes[t]={},this._aes[t][0]=dv.scale.constant().value(this._defaultAes[t]).property(t)),delete this._defaultAes[t]},t._render=function(t){var e=this;this._geomGroup=d3.select(t);var n=this._geomGroup.selectAll(".series").data(this._nestData);n.exit().call(e.exitSeriesGroup,e),n.enter().append("g").classed("series",!0),n.call(e.updateGroups,e.enterPen,e.pen,e.enterPen,e).call(e.updateDataPoints,e.enterPen,e.pen,e.enterPen,e),e._renderBehaviors(e._geomGroup),e.unregisterEventMap=null},t._renderBehaviors=function(t){var e=this;this._behaviors&&this._behaviors.length&&(this._behaviorsLayer=t.select(".behavior-layer"),this._behaviorsLayer.empty()?this._behaviorsLayer=t.append("g").classed("behavior-layer",!0):this._behaviorsLayer.node().parentNode.appendChild(this._behaviorsLayer.node()),dv.util.each(this._behaviors,function(t){t._geom(e)._render(e._behaviorsLayer)}))},t.updateGroups=function(t,e,n,i,r){t.each(function(t){var e=0,n=0,i=d3.select(this),a=i.attr("transform");if(r._chart._coord instanceof dv.coord.polar){var o=t.values[0],s=dv.util.scaleRange(o.panel.xOuterScale()),l=dv.util.scaleRange(o.panel.yOuterScale()),u=(s[0]+s[1])/2,c=(l[0]+l[1])/2,h=r._chart._coord.flip();e=h?c:u,n=h?u:c}a&&dv.ANIMATION&&(i=i.transition().duration(function(t,e){return r.duration().call(this,t,e)})),i.attr("transform","translate("+e+","+n+")")})},t.updateDataPoints=function(t,e,n,i,r){t.each(function(t,a){var o=d3.select(this),s=e.call(r,a),l=n.call(r,a),u=i.call(r,a),c=o.selectAll("."+r._dataPointStyleClass).data(r.getValues(t));c.exit().transition().delay(function(t,e){return r.delay().call(this,t,e,a)}).duration(function(t,e){return r.duration().call(this,t,e,a)}).ease(r.ease()).each(function(){this.__exiting__=!0}).attrTween("d",u.pathTween).remove(),c.enter().append("path").each(function(t,e){r.setPreviousState.call(this,s,u,t,e)}).attr("class",function(t,e){return"datum-"+e+" series-"+a}).call(r.attributes,r,a).attr("d",s.path);var h=c.call(r.attributes,r,a).call(r._removeRegisteredEvents,r).call(r._addRegisteredEvents,r);dv.ANIMATION?h=h.transition().delay(function(t,e){return r.delay().call(this,t,e,a)}).duration(function(t,e){return r.duration().call(this,t,e,a)}).ease(r.ease()).attrTween("d",l.pathTween):h.each(function(t,e){var n=l.bounds(t,e);n&&(t.bounds=n.bounds)}).attr("d",l.path),h.call(r.addEachFunction,r,a)})},t.addEachFunction=function(t,e,n){e._each&&(dv.util.isUndefined(e._each.start)||(dv.ANIMATION?t.each("start",function(t,i){e._each.start.call(this,t,i,n)}):t.each(function(t,i){e._each.start.call(this,t,i,n)})),dv.util.isUndefined(e._each.end)||(dv.ANIMATION?t.each("end",function(t,i){e._each.end.call(this,t,i,n)}):t.each(function(t,i){e._each.end.call(this,t,i,n)})))},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.setPreviousState=function(t,e,n,i){var r=t.bounds(n,i);this.__previousBounds__=r,this.__exitTransition__=e},t.pathTween=function(t,e,n,i){var r,a=d3.select(e);return e.__exiting__?(r=e.__exitTransition__.path(n,i),e.__exiting__=!1):r=t.getPath(t.getBounds(n,i)),null===r?(a.remove(),null):d3.interpolate(a.attr("d"),r)},t._calculateStats=function(){},t._handlePositions=function(){if("stack"===this.position()||"fill"===this.position()||"dodge"===this.position()){var t=this.position(),e=this._addGroupLayerToNestedData(),n=this._chart.coord().flip(),i=function(t){var e=r.getExplicitScales(t)[t],n=!1;return function(i,r){for(var a in e)if(n=e[a]._includeInDomain(i,r))break;return n?i[t]:0}},r=this;dv.util.each(e,function(e){var r=i("x"),a=i("y");if("stack"===t)d3.layout.stack().x(r).y(a).values(function(t){return t.values})(e.values);else if("fill"===t)d3.layout.stack().x(r).y(a).offset(function(t){var e,n,i,r=t.length,a=t[0].length,o=[];for(n=0;a>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];if(i)for(e=0;r>e;e++)t[e][n][1]/=i;else for(e=0;r>e;e++)t[e][n][1]=0}for(n=0;a>n;++n)o[n]=0;return o}).values(function(t){return t.values})(e.values);else if("dodge"===t){var o=e.values.length;dv.util.each(e.values,function(t,e){dv.util.each(t.values,function(t){t.dodge={groupIndex:n?o-1-e:e,numGroups:o}})})}})}},t._addGroupLayerToNestedData=function(){var t=[],e={},n={};return dv.util.each(this._nestData,function(i){var r,a,o=/(.*) ~ .*/g.exec(i.key)[1],s=/.* ~ (.*)/g.exec(i.key)[1];e.hasOwnProperty(o)||(t.push({key:o,values:[]}),e[o]=t.length-1),r=t[e[o]],n.hasOwnProperty(i.key)||(r.values.push({key:s,values:[]}),n[i.key]=r.values.length-1),a=r.values[n[i.key]],a.values=a.values.concat(i.values)}),t},t.exit=function(t){d3.select(t).selectAll(".series").call(this.exitSeriesGroup,this)},t.exitSeries=function(t,e,n){t.each(function(t,i){var r=d3.select(this);r.selectAll("."+n._dataPointStyleClass).transition().delay(function(t,e){return n.delay().call(this,t,e,i)}).duration(function(t,e){return n.duration().call(this,t,e,i)}).ease(n.ease()).each(function(){this.__exiting__=!0}).attrTween("d",e.call(n,i).pathTween).remove().each("end",function(){var t=r.node();if(t&&t.childNodes&&!t.childNodes.length){var e=t.parentNode;e&&e.childNodes&&1>=e.childNodes.length?d3.select(e).remove():r.remove()}})})},t.coord=function(){return this.chart().coord()},t._addRegisteredEvents=function(t,e){e||(e=this),e._geomGroup&&(t=t?t:e._geomGroup.selectAll("."+this._dataPointStyleClass),e=e||this,dv.util.each(e.eventMap,function(n,i){t.on(i,function(t,n){e.eventMap[i].callback.call(this,t,n,d3.event)},n.capture)}),dv.util.each(e._chart.eventMap,function(n,i){t.on(i+".dvchart",function(){var t=d3.event,n=e._chart._interactionGroup.select(".interaction-canvas").node();e._shouldDispatchChartEvent(t,n)&&e._chart.eventMap[i].callback.call(n,t)},n.capture)}),dv.util.each(e._behaviors,function(t){t._addRegisteredEvents&&t._addRegisteredEvents()}))},t._removeRegisteredEvents=function(t,e){e||(e=this),e._geomGroup&&(t=t||e._geomGroup.selectAll("."+this._dataPointStyleClass),e=e||this,dv.util.each(e.unregisterEventMap,function(e,n){t.on(n,null,e)}),dv.util.each(e._chart.unregisterEventMap,function(e,n){t.on(n+".dvchart",null,e)}),dv.util.each(e._behaviors,function(t){t._removeRegisteredEvents&&t._removeRegisteredEvents()}))},t._shouldDispatchChartEvent=function(t,e){var n=!0;if("mouseout"===t.type||"mouseover"===t.type){var i=t.relatedTarget;i||(i="mouseout"===t.type?t.toElement:t.fromElement);var r=d3.select(i);if(r&&!r.empty()){var a=r.attr("class");n=!(r.node()===e||a&&a.indexOf("-geom")>=0)}}return n},t.getExplicitScalesMap=function(){var t=dv.util.clone(this._chart.getExplicitScalesMap());for(var e in this._aes){var n=this._aes[e],i=t[e]||{},r=dv.util.extend({},i,n);t[e]=r}return t},t.getExplicitScale=function(t,e){if("group"===t)return this._getGroup();var n=this._aes[t],i=this.chart()._aes[t];return void 0!==e&&n&&n[e]?n[e]:void 0!==e&&i&&i[e]?i[e]:n&&void 0!==n[0]?n[0]:i&&void 0!==i[0]?i[0]:null},t.getExplicitScales=function(t){dv.util.isArray(t)||(t=[t]);for(var e={},n=-1,i=t.length;i>++n;){var r=t[n],a=this._aes[r],o=this.chart()._aes[r]||{};e[r]=dv.util.extend({},o,a)}return e},t.getTrainedScale=function(t,e){return this.chart().getTrainedScale(t,e)},t.getScale=function(t,e){return this.getExplicitScale(t,e)},t.getScales=function(t){return this.getExplicitScales(t)},t.hasScale=function(t,e){return this.getExplicitScale(t,e)?!0:!1},t._dodgeAdjust=function(t,e){var n=t.dodge.groupIndex,i=t.dodge.numGroups,r=t.panel.xScale(t).rangeBand(),a=i>1?r/(i-1)*this._dodgePadding:0,o=(r-a*(i-1))/i;return(o+a)*n+(e?o:0)},t.applyAttributeValue=function(t,e,n,i,r){var a=e.getScale(i,0);t.style(n,function(t,e){var n=t;return dv.util.isArray(t)&&(n=t[0]),a?a.mapToProp(n,e,r):null})},t._getGroup=function(){if(this._aes.hasOwnProperty("group"))return this._aes.group[0];var t=this.chart()._getGroup();if(t&&"group"===t.property())return t;for(var e=-1,n=dv.DEFAULT_CATEGORICAL_AES.length-1;n>e++;){var i=this._aes[dv.DEFAULT_CATEGORICAL_AES[e]];if(i&&i[0]&&!dv.util.isUndefined(i[0].mapping()))return i[0]}return t},t.each=function(t,e){var n,i;return arguments?(this._each=this._each||{},2>arguments.length?(i=t,n="end"):(i=e,n=t),this._each[n]=i,this):this._each},t.behaviors=function(t){return arguments.length?(this._behaviors=t,this):this._behaviors},t.stat=function(t){return arguments?(this._stat=t,this):this._stat},t.chart=function(t){return arguments.length?(this._chart=t,this):this._chart},t.normalizedData=function(t){return arguments.length?(this._normalizedData=t,this):this._normalizedData},t.data=function(t){return arguments.length?(this._data=t,this):this._data?this._data:this.chart().data()},t}),dv.geom.point=dv.geom.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.point}return t._dataPointStyleClass="point-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.shape="circle",this._defaultAes.size=7},t.getValues=function(t){return t.values},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.attributes=function(t,e,n){t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"opacity","alpha",n).call(e.applyAttributeValue,e,"stroke","stroke",n).call(e.applyAttributeValue,e,"fill","fill",n)},t.getHighlightColor=function(t,e){var n=this.getScale("fill"),i=this.getScale("stroke");return!i||i instanceof dv.scale.constant?!n||n instanceof dv.scale.constant?i?i.mapToProp(t,e):"#8CC350":n.mapToProp(t,e):i.mapToProp(t,e)},t.enterPen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t){return t.panel.yScale(t).reverse()?1:0};return this._decoratePen(t,e)},t.pen=function(){var t,e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)};switch(this.position()){case"identity":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)};break;case"stack":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0+t.y),e)};break;case"fill":t=function(t){return t.y+t.y0}}return this._decoratePen(e,t)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t._decoratePen=function(t,e){var n=this.getScale("shape"),i=this.getScale("size"),r=this,a=this.coord()._point().x(t).y(e).defined(this._defined);return a.renderer.type(function(t,e){return n.mapToProp(t,e)}).size(function(t,e){return Math.pow(i.mapToProp(t,e),2)}),{bounds:function(t,e){return a.getBounds(t,e)},pathTween:function(t,e){return r.pathTween(a,this,t,e)},path:function(t,e){return a.getPath(a.getBounds(t,e))}}},t}),dv.geom.text=dv.geom.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.text,this._dx=d3.functor(0),this._dy=d3.functor(0),this._textFormat=function(t){return t},this._textAnchor="start"}return t._dataPointStyleClass="text-geom",t.dx=function(t){return arguments.length?(this._dx=d3.functor(t),this):this._dx},t.dy=function(t){return arguments.length?(this._dy=d3.functor(t),this):this._dy},t.textAnchor=function(t){return arguments.length?(this._textAnchor=t,this):this._textAnchor},t.textFormat=function(t){return arguments.length?(this._textFormat=d3.functor(t),this):this._textFormat},t.getValues=function(t){return t.values},t.updateDataPoints=function(t,e,n,i,r){r.getScale("alpha"),t.each(function(a,o){var s=d3.select(this),l=e.call(r,o),u=n.call(r,o),c=i.call(r,o),h=s.selectAll("."+r._dataPointStyleClass).data(r.getValues(a));h.exit().transition().delay(function(t,e){return r.delay().call(this,t,e,o)}).duration(function(t,e){return r.duration().call(this,t,e,o)}).ease(r.ease()).call(c).each("end.transition",function(){t.node().removeChild(this)}),h.enter().append("text").attr("class",function(t,e){return"datum-"+e+" series-"+o}).call(r.attributes,r,o).call(l);var d=h.call(r.attributes,r,o).call(r._removeRegisteredEvents,r).call(r._addRegisteredEvents,r);dv.ANIMATION&&(d=d.transition().delay(function(t,e){return r.delay().call(this,t,e,o)}).duration(function(t,e){return r.duration().call(this,t,e,o)}).ease(r.ease())),d.call(u).call(r.addEachFunction,r)})},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.exitSeries=function(t,e,n){t.each(function(t,i){var r=d3.select(this),a=e.call(n,i);r.selectAll("."+n._dataPointStyleClass).transition().delay(function(t,e){return n.delay().call(this,t,e,i)}).duration(function(t,e){return n.duration().call(this,t,e,i)}).ease(n.ease()).call(a).remove().each("end.transition",function(){var t=r.node();t.parentNode&&t.removeChild(this),t&&t.childNodes&&!t.childNodes.length&&r.remove()})})},t.attributes=function(t,e,n){t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"stroke","stroke",n).call(e.applyAttributeValue,e,"fill","fill",n).call(e.applyAttributeValue,e,"opacity","alpha",n).call(e.applyAttributeValue,e,"font-size","size",n).attr("text-anchor",e._textAnchor)},t.enterPen=function(t){var e,n=this,i=this._dx,r=function(t){return t.panel.yScale(t).reverse()?1:0};return e="dodge"===this.position()?function(e,r){var a=e.panel.xScale(e);return a.mapValueToPercent(a.mapToProp(e,r)+n._dodgeAdjust(e)+i(e,r,t),r)}:function(e,n){var r=e.panel.xScale(e);return r.mapValueToPercent(r.mapToProp(e,n)+r.rangeBand()/2+i(e,n,t),n)},this._decoratePen(e,r,t)},t.pen=function(t){var e,n=this,i=this._dx,r=this._dy,a=function(e,n){var r=e.panel.xScale(e);return r.mapValueToPercent(r.mapToProp(e,n)+r.rangeBand()/2+i(e,n,t),n)};switch(this.position()){case"identity":e=function(e,n){var i=e.panel.yScale(e);return i.mapValueToPercent(i.mapToProp(e,n)+r(e,n,t)+i.rangeBand()/2,n)};break;case"stack":e=function(e,n){var i=e.panel.yScale(e);return i.mapValueToPercent(i.mapValue(e.y0+e.y,n)+r(e,n,t),n)};break;case"dodge":a=function(e,r){var a=e.panel.xScale(e);return a.mapValueToPercent(a.mapToProp(e,r)+n._dodgeAdjust(e)+i(e,r,t),r)},e=function(e,n){var i=e.panel.yScale(e);return i.mapValueToPercent(i.mapToProp(e,n)+r(e,n,t)+i.rangeBand()/2,n)};break;case"fill":e=function(e,n){var i=e.panel.yScale(e);return e.y+e.y0+i.mapValueToPercent(r(e,n,t)+dv.util.scaleRange(i)[0],n)}}return this._decoratePen(a,e,t)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t._decoratePen=function(t,e,n){var i=this.getScale("label"),r=this,a=this.coord()._text().x(t).y(e);return a().label(function(t,e){return r._textFormat.call(this,i.mapToProp(t,e),e,n)}).defined(this._defined)},t}),dv.geom.line=dv.geom.extend(function(){function t(){this._super(),this._tension=.7,this._interpolate="linear",this._rendererClass=dv.geom.line}return t._dataPointStyleClass="line-geom",t.tension=function(t){return arguments.length?(this._tension=t,this):this._tension},t.interpolate=function(t){return arguments.length?(this._interpolate=t,this):this._interpolate},t._render=function(t){this._super(t);var e=this.getScale("size");e&&e.to&&!e.to()&&e.to([2,8])},t.getValues=function(t){return[t.values]},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.attributes=function(t,e,n){var i=e.getScale("linetype",0);t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"stroke","stroke",n).call(e.applyAttributeValue,e,"opacity","alpha",n).call(e.applyAttributeValue,e,"stroke-width","size",n).style("stroke-dasharray",function(t,e){return i?dv.util.svg.getDasharray(i.mapToProp(t[0],e,n)):null}).style("fill","none")},t.getHighlightColor=function(t,e){var n=this.getScale("stroke",0);return n?n.mapToProp(t,e):"#8CC350"},t.enterPen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t){return t.panel.yScale(t).reverse()?1:0};return this._decoratePen(t,e)},t.pen=function(){var t,e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)};switch(this.position()){case"identity":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)};break;case"stack":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0+t.y),e)};break;case"fill":t=function(t){return t.y+t.y0}}return this._decoratePen(e,t)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t._decoratePen=function(t,e){var n=this,i=this.coord()._line().x(t).y(e).defined(this._defined);return i.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(t,e){return i.getBounds(t,e)},pathTween:function(t,e){return n.pathTween(i,this,t,e)},path:function(t,e){return i.getPath(i.getBounds(t,e))}}},t}),dv.geom.area=dv.geom.extend(function(){function t(){this._super(),this._tension=.7,this._interpolate="linear",this._rendererClass=dv.geom.area,this._baseline=0}return t._dataPointStyleClass="area-geom",t._initializeDefaultAes=function(){this._super()},t._trainScales=function(){if(void 0!==this._baseline){var t=this.getExplicitScales("y").y;for(var e in t){var n=t[e];n instanceof dv.scale.continuous&&n.softLowerLimit(this._baseline)}}this._super()},t.tension=function(t){return arguments.length?(this._tension=t,this):this._tension},t.interpolate=function(t){return arguments.length?(this._interpolate=t,this):this._interpolate},t.getValues=function(t){return[t.values]},t.pathTween=function(t,e,n,i,r){var a,o,s,l,u=e.__previousBounds__,c=[],h=this.enterPen.call(this,r),d=this.getScale("x").domain(),p=-1;for(a=t.getBounds(n,i),a.coord=this.coord(),(u&&u.coord&&a.coord._type!==u.coord._type||a.coord.flip()!=u.coord.flip())&&(u=this.enterPen.call(this,r).bounds(n,i)),o=Math.max(a.length,u.length);o>++p;)s=a.length>p?a[p]:null,l=u.length>p?u[p]:null,l?s||(s=h.bounds([l],i)[0]):(s.x=d[d.length-1],l=h.bounds([s],i)[0]),c.push(d3.interpolateObject(l.bounds,s.bounds));return e.__previousBounds__=a,function(e){1===e&&(c=c.splice(0,a.length));var n=[];return dv.util.each(c,function(t){var i={};i.bounds=t(e),n.push(i)}),t.getPath(n)}},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.attributes=function(t,e,n){t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"opacity","alpha",n).call(e.applyAttributeValue,e,"fill","fill",n)},t.getHighlightColor=function(t,e){var n=this.getScale("fill");return n?n.mapToProp(t,e):"#8CC350"},t.getBaseline=function(t){var e=t.domain()[0];return void 0!==self._baseline?self._baseline:0>e?0:e},t.enterPen=function(){var t=this,e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},n=function(e,n){var i=e.panel.yScale(e);return i.mapValueToPercent(i.mapValue(t.getBaseline(i)),n)};return this._decoratePen(e,n,n)},t.pen=function(){var t,e,n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},i=this;switch(this.position()){case"identity":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(i.getBaseline(n)),e)},e=function(t,e){var n=t.panel.yScale(t);return n.mapPropToPercent(t,e)};break;case"stack":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0),e)},e=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0+t.y),e)};break;case"fill":t=function(t){return t.y0},e=function(t){return t.y+t.y0}}return this._decoratePen(n,t,e)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t))},t._decoratePen=function(t,e,n){var i=this,r=this.coord()._area().x(t).y0(e).y1(n).defined(this._defined);return r.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(t,e){var n=r.getBounds(t,e);return n&&(n.coord=i.coord()),n},pathTween:function(t,e){return i.pathTween(r,this,t,e)},path:function(t,e){return r.getPath(r.getBounds(t,e))}}},t.baseline=function(t){return arguments?(this._baseline=t,this):this._baseline},t}),dv.geom.rect=dv.geom.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.rect}return t._dataPointStyleClass="bar-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,this._defaultAes.xMin=1,this._defaultAes.xMax=1,delete this._defaultAes.x,delete this._defaultAes.y},t._trainScales=function(){var t,e=this.getExplicitScales(["yMin","xMin"]),n=e.yMin,i=e.xMin;for(t in n){var r=this._aes.y;r||(this._aes.y=r={}),r[t]||(r[t]=n[t].copy().property("y").mapping("y")),r[t].trainingProperties(["yMin","yMax"])}for(t in i){var a=this._aes.x;a||(this._aes.x=a={}),a[t]||(a[t]=i[t].copy().property("x").mapping("x")),a[t].trainingProperties(["xMin","xMax"])}},t.getValues=function(t){return t.values},t._render=function(t){var e,n=this.getExplicitScales(["yMin","yMax","y","xMin","xMax","x"]);for(e in n.yMin){var i=n.yMin[e],r=n.yMax[e],a=n.y[e];a&&(r.range(a.range()).domain(a.domain()),i.range(a.range()).domain(a.domain()))}for(e in n.xMin){var o=n.xMin[e],s=n.xMax[e],l=n.x[e];l&&(s.range(l.range()).domain(l.domain()),o.range(l.range()).domain(l.domain()))}this._super(t)},t.pathTween=function(t,e,n,i){var r,a=n,o=e.__previousBounds__,s=this.coord()._type;if(r=e.__exiting__?e.__exitTransition__.bounds(n,i):t.getBounds(n,i),o&&o.coord&&s!==o.coord&&(o=e.__exitTransition__.bounds(n,i)),!r||!o)return null;r.coord=s;var l=d3.interpolateObject(o.bounds,r.bounds);return e.__previousBounds__=r,function(e){return a.bounds=l(e),t.getPath(a)}},t.attributes=function(t,e,n){t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"fill","fill",n).call(e.applyAttributeValue,e,"stroke","stroke",n).call(e.applyAttributeValue,e,"opacity","alpha",n)},t.enterPen=function(t){var e=function(t){return t.panel.yScale(t).reverse()?1:0},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.x)?t.x[0]:t.xMin,e))},i=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.x)?t.x[1]:t.xMax,e))};return this._decoratePen(n,i,e,e,t)},t.pen=function(t){var e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.x)?t.x[0]:t.xMin,e))},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.x)?t.x[1]:t.xMax,e))},i=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.y)?t.y[0]:t.yMin,e))},r=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.y)?t.y[1]:t.yMax,e))};return this._decoratePen(e,n,i,r,t)},t._defined=function(t,e){var n=t.panel.xScale(t),i=t.panel.yScale(t);return dv.util.isFinite(n.mapValue(dv.util.isArray(t.x)?t.x[0]:t.xMin,e))&&dv.util.isFinite(n.mapValue(dv.util.isArray(t.x)?t.x[1]:t.xMax,e))&&dv.util.isFinite(i.mapValue(dv.util.isArray(t.y)?t.y[0]:t.yMin,e))&&dv.util.isFinite(i.mapValue(dv.util.isArray(t.y)?t.y[1]:t.yMax,e))},t._decoratePen=function(t,e,n,i,r){var a=this,o=this.coord()._rect().x0(t).x1(e).y0(n).y1(i).defined(this._defined);return{bounds:function(t,e){var n=o.getBounds(t,e);return n&&(n.bounds.coord=a.coord()._type),n},pathTween:function(t,e){return a.pathTween(o,this,t,e,r)},path:function(t,e){return o.getPath(o.getBounds(t,e))}}},t}),dv.geom.tile=dv.geom.rect.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.tile}return t._dataPointStyleClass="tile-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.y=1,this._defaultAes.x=1},t.getValues=function(t){return t.values},t.enterPen=function(t){var e=function(t){return t.panel.yScale(t).reverse()?1:0},n=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},i=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)};return this._decoratePen(n,i,e,e,t)},t.pen=function(t){var e=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)},i=function(t,e){var n=t.panel.yScale(t);return n.mapPropToPercent(t,e)},r=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)};return this._decoratePen(e,n,i,r,t)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t._decoratePen=function(t,e,n,i,r){var a=this,o=this.coord()._rect().x0(t).x1(e).y0(n).y1(i).defined(this._defined);return{bounds:function(t,e){var n=o.getBounds(t,e);return n&&(n.bounds.coord=a.coord()._type),n},pathTween:function(t,e){return a.pathTween(o,this,t,e,r)},path:function(t,e){return o.getPath(o.getBounds(t,e))}}},t}),dv.geom.bar=dv.geom.rect.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.bar,this._dodgePadding=0,this._baseline=0}return t._dataPointStyleClass="bar-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.y=1,this._defaultAes.x=1},t._trainScales=function(){if(void 0!==this._baseline){var t=this.getExplicitScales("y").y;for(var e in t){var n=t[e];n instanceof dv.scale.continuous&&n.softLowerLimit(this._baseline)}}},t.getValues=function(t){return t.values},t.getBaseline=function(t){var e=t.domain()[0];return void 0!==self._baseline?self._baseline:0>e?0:e},t.enterPen=function(t){var e,n,i=this,r=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(i.getBaseline(n)),e)};return"dodge"===this.position()?(e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+i._dodgeAdjust(t),e)},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+i._dodgeAdjust(t,!0),e)}):(e=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)}),this._decoratePen(e,n,r,r,t)},t.pen=function(t){var e,n,i,r,a=this;switch(this.position()){case"identity":e=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)},i=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(a.getBaseline(n)),e)},r=function(t,e){return t.panel.yScale(t).mapPropToPercent(t,e)};break;case"stack":e=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)},i=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0),e)},r=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0+t.y),e)};break;case"dodge":e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+a._dodgeAdjust(t),e)},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+a._dodgeAdjust(t,!0),e)},i=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(a.getBaseline(n)),e)},r=function(t,e){return t.panel.yScale(t).mapPropToPercent(t,e)};break;case"fill":e=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)},i=function(t){return t.y0},r=function(t){return t.y+t.y0}}return this._decoratePen(e,n,i,r,t)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t._decoratePen=function(t,e,n,i,r){var a=this,o=this.coord()._rect().x0(t).x1(e).y0(n).y1(i).defined(this._defined);return{bounds:function(t,e){var n=o.getBounds(t,e);return n&&(n.bounds.coord=a.coord()._type),n},pathTween:function(t,e){return a.pathTween(o,this,t,e,r)},path:function(t,e){return o.getPath(o.getBounds(t,e))}}},t.dodgePadding=function(t){return arguments?(this._dodgePadding=t,this):this._dodgePadding},t.baseline=function(t){return arguments?(this._baseline=t,this):this._baseline},t}),dv.geom.barrange=dv.geom.bar.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.barrange}return t._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y
},t._trainScales=function(){var t,e,n=this.getExplicitScales("yMin").yMin;for(var i in n)this._aes.y||(this._aes.y={}),t=this._aes.y,e=t[i],e||(t[i]=e=n[i].copy().property("y").mapping("y")),e.trainingProperties(["yMin","yMax"])},t._render=function(t){var e=this.getExplicitScales(["yMin","yMax","y"]),n=e.yMin;for(var i in n){var r=n[i],a=e.yMax[i],o=e.y[i];a.range(o.range()).domain(o.domain()),r.range(o.range()).domain(o.domain())}this._super(t)},t.enterPen=function(t){var e=function(t){return t.panel.yScale(t).reverse()?1:0},n=function(t,e){var n=t.panel.xScale(t);return n.mapPropToPercent(t,e)},i=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)};return this._decoratePen(n,i,e,e,t)},t.pen=function(t){var e=function(t,e){var n=t.panel.xScale(t);return n.mapPropToPercent(t,e)},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)},i=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMin,e),e)},r=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMax,e),e)};return this._decoratePen(e,n,i,r,t)},t._defined=function(t,e){var n=t.panel.xScale(t),i=t.panel.yScale(t);return dv.util.isFinite(n.mapToProp(t,e))&&dv.util.isFinite(i.mapValue(t.yMin,e))&&dv.util.isFinite(i.mapValue(t.yMax,e))},t._decoratePen=function(t,e,n,i,r){var a=this,o=this.coord()._rect().x0(t).x1(e).y0(n).y1(i).defined(this._defined);return{bounds:function(t,e){var n=o.getBounds(t,e);return n&&(n.bounds.coord=a.coord()._type),n},pathTween:function(t,e){return a.pathTween(o,this,t,e,r)},path:function(t,e){return o.getPath(o.getBounds(t,e))}}},t}),dv.geom.segment=dv.geom.line.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.segment}return t.getValues=function(t){return t.values},t.enterPen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t){return t.panel.yScale(t).reverse()?1:0};return this._decoratePen(t,e)},t.pen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t,e){return t.panel.yScale(t).mapPropToPercent(t,e)};return this._decoratePen(t,e)},t}),dv.geom.vline=dv.geom.segment.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.vline}return t._render=function(t){var e=this;dv.util.each(this._nestData,function(t,n){var i=[];dv.util.each(t.values,function(t){var e=t.panel.xScale(t),n=t.panel.yScale(t),r=(n.domain(),t[e.property()]);if(dv.util.isArray(t))t[0].x=r,t[1].x=r;else{var a=[];t.x=r,a.push(t),a.push(dv.util.clone(t)),i.push(a)}}),e._nestData[n].values=i}),this._super(t)},t.enterPen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(){return 0};return this._decoratePen(t,e)},t.pen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t,e){return 0===e?0:1};return this._decoratePen(t,e)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))},t}),dv.geom.hline=dv.geom.segment.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.hline}return t._render=function(t){var e=this;dv.util.each(this._nestData,function(t,n){var i=[];dv.util.each(t.values,function(t){var e=t.panel.xScale(t),n=t.panel.yScale(t),r=(e.domain(),t[n.property()]);if(dv.util.isArray(t))t[0].y=r,t[1].y=r;else{var a=[];t.y=r,a.push(t),a.push(dv.util.clone(t)),i.push(a)}}),e._nestData[n].values=i}),this._super(t)},t.enterPen=function(){var t=function(t,e){return 0===e?0:1},e=function(t){return t.panel.yScale(t).reverse()?1:0};return this._decoratePen(t,e)},t.pen=function(){var t=function(t,e){return 0===e?0:1},e=function(t,e){return t.panel.yScale(t).mapPropToPercent(t,e)};return this._decoratePen(t,e)},t._defined=function(t,e){return dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t}),dv.geom.ribbon=dv.geom.area.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.ribbon}return t._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y},t._trainScales=function(){var t,e,n=this.getExplicitScales("yMin").yMin;for(var i in n)this._aes.y||(this._aes.y={}),t=this._aes.y,e=t[i],e||(t[i]=e=n[i].copy().property("y").mapping("y")),e.trainingProperties(["yMin","yMax"])},t._render=function(t){var e=this.getExplicitScales(["yMin","yMax","y"]),n=e.yMin;for(var i in n){var r=n[i],a=e.yMax[i],o=e.y[i];a.range(o.range()).domain(o.domain()),r.range(o.range()).domain(o.domain())}this._super(t)},t.enterPen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t){return t.panel.yScale(t).reverse()?1:0};return this._decoratePen(t,e,e)},t.pen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMin,e))},n=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMax,e))};return this._decoratePen(t,e,n)},t._defined=function(t,e){var n=t.panel.xScale(t),i=t.panel.yScale(t);return dv.util.isFinite(n.mapToProp(t,e))&&dv.util.isFinite(i.mapValue(t.yMin,e))&&dv.util.isFinite(i.mapValue(t.yMax,e))},t._decoratePen=function(t,e,n){var i=this,r=this.coord()._area().x(t).y0(e).y1(n).defined(this._defined);return r.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(t,e){var n=r.getBounds(t,e);return n&&(n.coord=i.coord()),n},pathTween:function(t,e){return i.pathTween(r,this,t,e)},path:function(t,e){return r.getPath(r.getBounds(t,e))}}},t}),dv.geom.errorbar=dv.geom.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.errorbar,this._width=1}return t._dataPointStyleClass="errorbar-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y},t._trainScales=function(){var t,e=this.getExplicitScales("yMin").yMin;for(var n in e)this._aes.y||(this._aes.y={}),yScales=this._aes.y,t=yScales[n],t||(yScales[n]=t=e[n].copy().property("y").mapping("y")),t.trainingProperties(["yMin","yMax"])},t.getValues=function(t){return t.values},t.width=function(t){return arguments.length?(this._width=t,this):this._width},t.attributes=function(t,e,n){var i=e.getScale("linetype");t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"stroke","stroke",n).call(e.applyAttributeValue,e,"opacity","alpha",n).call(e.applyAttributeValue,e,"stroke-width","size",n).style("stroke-dasharray",function(t,e){return i?dv.util.svg.getDasharray(i.mapToProp(t[0],e,n)):null}).style("fill","none")},t._render=function(t){var e=this.getScale("x");if(!(e instanceof dv.scale.ordinal)){var n,i,r=Number.MAX_VALUE;dv.util.each(this._nestData,function(t){dv.util.each(t.values,function(t){n=t.panel.xScale(t).mapValue(t.x),dv.util.isUndefined(i)||(r=Math.min(r,Math.abs(n-i))),i=n})}),this._maxWidthPixels=r}var a=this.getExplicitScales(["yMin","yMax","y"]),o=a.yMin;for(var s in o){var l=o[s],u=a.yMax[s];yScale=a.y[s],u.range(yScale.range()).domain(yScale.domain()),l.range(yScale.range()).domain(yScale.domain())}this._super(t)},t.enterPen=function(){var t=this,e=function(e,n){var i=e.panel.xScale(e);return i.mapValueToPercent(i.mapToProp(e,n)-(t._isOrdinal(e)?0:t._rangeBand(e)/2),n)},n=function(e,n){var i=e.panel.xScale(e);return i.mapValueToPercent(i.mapToProp(e,n)+(t._isOrdinal(e)?t._rangeBand(e):t._rangeBand(e)/2),n)},i=function(t){return t.panel.yScale(t).reverse()?1:0};return this._decoratePen(e,n,i,i)},t.pen=function(){var t=this,e=function(e,n){var i=e.panel.xScale(e);return i.mapValueToPercent(i.mapToProp(e,n)-(t._isOrdinal(e)?0:t._rangeBand(e)/2),n)},n=function(e,n){var i=e.panel.xScale(e);return i.mapValueToPercent(i.mapToProp(e,n)+(t._isOrdinal(e)?t._rangeBand(e):t._rangeBand(e)/2),n)},i=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMin,e))},r=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMax,e))};return this._decoratePen(e,n,i,r)},t._isOrdinal=function(t){return t.panel.xScale(t)instanceof dv.scale.ordinal},t._rangeBand=function(t){var e=t.panel.xScale(t);return e instanceof dv.scale.ordinal?e.range():this._maxWidthPixels*this._width},t._defined=function(t,e){var n=t.panel.xScale(t),i=t.panel.yScale(t);return dv.util.isFinite(n.mapToProp(t,e))&&dv.util.isFinite(i.mapValue(t.yMin,e))&&dv.util.isFinite(i.mapValue(t.yMax,e))},t._decoratePen=function(t,e,n,i){var r=this,a=this.coord()._errorBar().x0(t).x1(e).y0(n).y1(i).defined(this._defined);return{bounds:function(t,e){return a.getBounds(t,e)},pathTween:function(t,e){return r.pathTween(a,this,t,e)},path:function(t,e){return a.getPath(a.getBounds(t,e))}}},t}),dv.geom.poly=dv.geom.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.poly}return t._dataPointStyleClass="poly-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.size=1,delete this._defaultAes.shape,delete this._defaultAes.x,delete this._defaultAes.y},t._trainScales=function(){var t,e=this.getExplicitScales(["yMin","xMin"]);for(t in e.yMin){var n=this._aes.y;n||(this._aes.y=n={}),n[t]||(n[t]=yMinScale.copy().property("y").mapping("y")),n[t].trainingProperties(["yMin","yMax"])}for(t in e.xMin){var i=this._aes.x;i||(this._aes.x=i={}),i[t]||(i[t]=xMinScale.copy().property("x").mapping("x")),i[t].trainingProperties(["xMin","xMax"])}},t.getValues=function(t){return t.values},t.attributes=function(t,e,n){e.getScale("fill"),e.getScale("stroke"),e.getScale("alpha"),t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"stroke","stroke",n).call(e.applyAttributeValue,e,"fill","fill",n).call(e.applyAttributeValue,e,"opacity","alpha",n)},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.getHighlightColor=function(t,e){var n=this.getScale("fill"),i=this.getScale("stroke");return i instanceof dv.scale.constant?n instanceof dv.scale.constant?i.mapToProp(t,e):n.mapToProp(t,e):i.mapToProp(t,e)},t.enterPen=function(t){var e=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},n=function(t){var e=t.panel.yScale(t);return dv.util.map(t[e.property()],function(){return e.reverse()?1:0})};return this._decoratePen(e,n,t)},t.pen=function(t){var e=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},n=function(t,e){return t.panel.yScale(t).mapPropToPercent(t,e)};return this._decoratePen(e,n,t)},t._defined=function(t,e){for(var n=t.panel.xScale(t).mapToProp(t,e),i=t.panel.yScale(t).mapToProp(t,e),r=d3.max([n.length,i.length]),a=!0,o=0;r>o&&a;o++)a=dv.util.isFinite(n[o])&&dv.util.isFinite(i[o]);return a},t._decoratePen=function(t,e,n){var i=this,r=this.coord()._poly().xs(t).ys(e).defined(this._defined);return{bounds:function(t,e){return r.getBounds(t,e)},pathTween:function(t,e){return i.pathTween(r,this,t,e,n)},path:function(t,e){return r.getPath(r.getBounds(t,e))}}},t}),dv.behavior=dv.extend(function(){function t(){}return t}),dv.behavior.inspector=dv.behavior.extend(function(){function t(){this._size=void 0,this._lastX=0,this._visible=!1,this._inspector=null,this._thickness=3,this._orientation="bottom",this._currentValue=null,this._gutterPadding=-7,this._calloutPadding={left:8,top:7,right:8,bottom:7},this._label=this._defaultLabel(),this._underGeoms=!1}function e(){var t=[],e=this._chart.getTrainedScale("x"),n=!1,i=function(t,e){return n&&t&&e?t.getTime()===e.getTime():t===e},r=function(t){return e.mapValue(t)},a=this._chart.data(),o=-1,s=this._chart._layers.length;for(a.length&&t.concat(a[e.property()]);s>++o;){var l=this._chart._layers[o],u=l.getTrainedScale("x"),c=l.data()[u.property()];c!==a&&(t=t.concat(c)),n=n||u instanceof dv.scale.time||u instanceof dv.scale.time.utc}return t.length?dv.util.sortBy(dv.util.uniqueValues(t,i),r):t}function n(){this._chart.on("mousemove.inspector",dv.util.bind(r,this)),this._chart.on("mouseout.inspector",dv.util.bind(a,this)),this._chart.on("touchstart.inspector",dv.util.bind(r,this)),this._chart.on("touchmove.inspector",dv.util.bind(r,this)),this._chart.on("touchend.inspector",dv.util.bind(a,this))}function i(t,e,n){var i=0,r=0;if(this._lastX!==n){this._inspector.attr("opacity",1),this._inspector.select(".inspector-tip-label").text(e).each(function(){var t=this.getBBox();i=Math.max(t.width,i),r=Math.max(t.height,r)});var a,o=this._chart.facet().getPanel(0).bounds();i+=this._calloutPadding.left+this._calloutPadding.right,r+=this._calloutPadding.top+this._calloutPadding.bottom,a=n-i/2,o.left+this._gutterPadding>a&&(a=o.left+this._gutterPadding),a+i>o.right-this._gutterPadding&&(a=o.right-this._gutterPadding-i),this._inspector.select(".inspector-marker").attr("transform","translate("+a+",0)"),this._inspector.select(".inspector-tip-background").attr("width",i).attr("height",r);var s=n-a;this._inspector.select(".inspector-line-container").attr("transform","translate("+s+",0)")}}function r(t){if(t){t=t.touches?t.touches[0]:t;var e=this._chart.getTrainedScale("x"),n=t.pageX-t.target.getBoundingClientRect().left+t.target.getBBox().x,r=dv.util.binaryCompare(this._domain,n,function(t){return e.mapValue(t)}),a=Math.min(Math.max(r||0,0),this._domain.length-1),o=this._domain[a],s=this._label.call(this,o,a),l=e.mapValue(o);this._currentValue!=o&&(this._inspectorMove&&this._inspectorMove.call(this,s,a,l,o),i.call(this,o,s,l)),this._currentValue=o,dv.cancelEvent(d3.event)}}function a(){this._inspector.attr("opacity",1e-6),this._inspectorOut&&this._inspectorOut.call(this),this._currentValue=null,dv.cancelEvent(d3.event)}return t._render=function(t){this._domain=e.call(this);var n=this._chart.facet().getPanel(0)._bounds;void 0===this._size&&(this._size=n.bottom-n.top),this._xGuide=dv.util.clone(this._chart._axes._get("x")[0]),this._selection=t,this._inspector=t.selectAll(".inspector").data([0]),this._inspector.call(this._createInspector,this._orientation,n,this._calloutPadding,this._thickness)},t._createInspector=function(t,e,n,i,r){var a=t,o=t.enter();o=o.append("g").classed("inspector",!0),a.style("pointer-events","none").attr("opacity",1e-6).attr("transform","translate(0,"+n.top+")");var s=o.append("g").classed("inspector-marker",!0),l=s.append("g").classed("inspector-line-container",!0);l.append("path").classed("inspector-callout",!0),a.select(".inspector-callout").attr("d",function(){var t=-3,i=t+5;return"bottom"===e&&(t=n.bottom-n.top+2,i=t-5),"M-5,"+t+"L5,"+t+"L0,"+i+"Z"}),l.append("line").classed("inspector-line",!0),a.select(".inspector-line").attr("y1","bottom"===e?0:4).attr("y2","bottom"===e?n.bottom-n.top-6:n.bottom-n.top).style("stroke-width",r);var u=s.append("g").classed("inspector-tip",!0);a.select(".inspector-tip").attr("transform","translate(0,"+("bottom"===e?n.bottom-n.top+2:-30)+")"),u.append("rect").classed("inspector-tip-background",!0),u.append("text").classed("inspector-tip-label",!0),a.select(".inspector-tip-label").attr("x",i.left).attr("y","1em").attr("dy",i.top)},t.moveToIndex=function(t){var e=this._chart.getTrainedScale("x"),n=this._domain[t],r=this._label.call(this,n,t),a=e.mapValue(n);i.call(this,n,r,a)},t.hide=function(){return this._inspector.attr("opacity",1e-6),this._visible=!1,this},t.show=function(){return this._inspector.attr("opacity",1),this._visible=!0,this},t._removeEvents=function(){this._chart.on("mousemove.inspector",null),this._chart.on("mouseout.inspector",null),this._chart.on("touchstart.inspector",null),this._chart.on("touchmove.inspector",null),this._chart.on("touchend.inspector",null)},t.inspectorMove=function(t){return arguments.length?(this._inspectorMove=t,this):this._inspectorMove},t.inspectorOut=function(t){return arguments.length?(this._inspectorOut=t,this):this._inspectorOut},t.label=function(t){return arguments.length?(this._label=d3.functor(t),this):this._label},t.thickness=function(t){return arguments.length?(this._thickness=t,this):this._thickness},t.size=function(t){return arguments.length?(this._size=t,this):this._size},t.chart=function(t){return arguments.length?(this._chart&&this._removeEvents(),this._chart=t,this._chart&&n.call(this),this):this._chart},t.orientation=function(t){return arguments.length?(this._orientation=t,this):this._orientation},t._defaultLabel=function(){var t=this;return function(e){var n=t._xGuide.tickFormat?t._xGuide.tickFormat():function(t){return t};return n(e)}},t.label=function(t){return arguments.length?(this._label=d3.functor(t),this):this._label},t.underGeoms=function(t){return arguments.length?(this._underGeoms=t,this):this._underGeoms},t.gutterPadding=function(t){return arguments.length?(this._gutterPadding=t,this):this._gutterPadding},t}),dv.behavior.brush=dv.behavior.extend(function(){function t(t){arguments.length&&!dv.util.isArray(t)&&(this._dimensions=[this._dimensions]),this._fluidDimensions=t||["x","y"],this._snap=!1,this._resizing=!1}return t.initializeBrush=function(t){var e=this;this._brush=dv.brush(t).on("brushstart.brush",function(){e._onBrushStart.call(e),e._brushStart&&e._brushStart.call(this,"start",e._brush.extent(),e)}).on("brush.brush",function(){e._onBrushMove.call(e),e._brushMove&&e._brushMove.call(this,"move",e._brush.extent(),e)}).on("brushend.brush",function(){e._onBrushEnd.call(e),e._brushEnd&&e._brushEnd.call(this,"end",e._brush.extent(),e)})},t._removeEvents=function(){this._brush.on("brushstart.brush",null).on("brush.brush",null).on("brushend.brush",null)},t._onBrushStart=function(){!this.snap()||this._fluidDimensions.length>1||(this._startPos=d3.mouse(this._brushContainer.node()),this._moving=d3.select(d3.event.sourceEvent.target).classed("extent"))},t._onBrushMove=function(){if(this.snap()&&!(this._fluidDimensions.length>1)){var t=d3.mouse(this._brushContainer.node());(this._startPos[0]!==t[0]||this._startPos[1]!==t[1])&&this._snapToDataPoints()}},t._onBrushEnd=function(){if(this.snap()&&!(this._fluidDimensions.length>1)){var t=d3.mouse(this._brushContainer.node());this._moving||this._startPos[0]!==t[0]||this._startPos[1]!==t[1]?this._brushContainer.selectAll(".resize").style("display",null):this.clear()}},t._snapToDataPoints=function(){var t=this._brush.extent(),e=[],n=this._chart.getTrainedScale(this._fluidDimensions[0]),i=[this._snapToNearestPoint(n,t[0],0),this._snapToNearestPoint(n,t[1],1)];this._brush.extent([i[0].value,i[1].value]);var r=this._chart.plotBounds();"x"===this._fluidDimensions?(e[0]=[i[0].rangeValue,0],e[1]=[i[1].rangeValue,r.bottom-r.top]):(e[0]=[0,i[0].rangeValue],e[1]=[r.right-r.left,i[1].rangeValue]),this._adjustBounds(this._brushContainer,e)},t._snapToNearestPoint=function(t,e,n){var i,r={};if(t instanceof dv.scale.ordinal||t instanceof dv.scale.identity){var a=dv.util.scaleRangeNoReverse(t),o=a[1]-a[0];domain=t.domain(),i=Math.round(t.invertValue(e)/o-1)}else domain=dv.util.uniq(this._chart.data()[t.mapping()]),index=dv.util.binaryCompare(domain,e,function(t){return t}),i=Math.min(Math.max(index||0,0),domain.length-1);var s=domain[i];if(r.value=s,0===n)if(0===i)r.rangeValue=t.mapValue(s);else{var l=domain[i-1],u=t.mapValue(l);valueRange=t.mapValue(s),r.rangeValue=valueRange-(valueRange-u)/2}else if(i===domain.length-1)r.rangeValue=t.mapValue(s);else{var c=domain[i+1],h=t.mapValue(c);valueRange=t.mapValue(s),r.rangeValue=valueRange+(h-valueRange)/2}return r},t._adjustBounds=function(t,e){"x"===this._fluidDimensions&&this._adjustBoundsX(t,e),"y"===this._fluidDimensions&&this._adjustBoundsY(t,e),t.selectAll(".resize").attr("transform",function(t){return"translate("+e[+/e$/.test(t)][0]+","+e[+/^s/.test(t)][1]+")"})},t._adjustBoundsX=function(t,e){t.select(".extent").attr("x",e[0][0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",e[1][0]-e[0][0])},t._adjustBoundsY=function(t,e){t.select(".extent").attr("y",e[0][1]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",e[1][1]-e[0][1])},t._setScales=function(){if(this._fluidDimensions.indexOf("x")>=0){var t=this._chart.getTrainedScale("x");this._brush.x(t._d3Scale)}if(this._fluidDimensions.indexOf("y")>=0){var e=this._chart.getTrainedScale("y");this._brush.y(e._d3Scale)}},t._render=function(){this._brushContainer=this._chart._parent.select(".interaction-group"),this._brush.empty()&&this._brushContainer.classed("brush",!0).call(this._brush);var t=this._chart.plotBounds();if(!this._brush.y()){var e=t.bottom-t.top;this._brushContainer.selectAll(".extent").attr("height",e).attr("y",0),this._brushContainer.selectAll(".resize rect").attr("height",e).attr("y",0)}if(!this._brush.x()){var n=t.right-t.left;this._brushContainer.selectAll(".extent").attr("width",n).attr("x",0),this._brushContainer.selectAll(".resize rect").attr("width",n).attr("x",0)}},t.empty=function(){return this._brush.empty()},t.clear=function(){this._brushContainer.call(this._brush.clear())},t.extent=function(t){return arguments.length?(this._brushContainer.call(this._brush.extent(t)),this):this._brush?this._brush.extent():null},t.snap=function(t){return arguments.length?(this._snap=this._fluidDimensions.length>1?!1:t,this):this._snap},t.brushStart=function(t){return arguments.length?(this._brushStart=t,this):this._brushStart},t.brushMove=function(t){return arguments.length?(this._brushMove=t,this):this._brushMove},t.brushEnd=function(t){return arguments.length?(this._brushEnd=t,this):this._brushEnd},t.chart=function(t){return arguments.length?(this._chart=t,this.initializeBrush(this._chart),this._chart&&this._setScales(),this):this._chart},t}),dv.brush=function(t){function e(o){o.each(function(){var o,s=d3.select(this),h=s.selectAll(".background").data([0]),d=s.selectAll(".extent").data([0]),p=s.selectAll(".resize").data(c,String);t.on("mousedown.brush",a).on("touchstart.brush",a)._g.style("cursor","crosshair"),s.style("pointer-events","all"),d.enter().append("rect").attr("class","extent").style("cursor","move"),p.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return I[t]}).append("rect").attr("x",function(t){return/[e]$/.test(t)?-10:/[w]$/.test(t)?2:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",10).attr("height",6).style("visibility","hidden"),p.style("display",e.empty()?"none":null),p.exit().remove(),l&&(o=dv.util.scaleRangeNoReverse(l),h.attr("x",o[0]).attr("width",o[1]-o[0]),i(s)),u&&(o=dv.util.scaleRangeNoReverse(u),h.attr("y",o[0]).attr("height",o[1]-o[0]),r(s)),n(s)})}function n(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+h[+/e$/.test(t)][0]+","+h[+/^s/.test(t)][1]+")"})}function i(t){t.select(".extent").attr("x",h[0][0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",h[1][0]-h[0][0])}function r(t){t.select(".extent").attr("y",h[0][1]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1][1]-h[0][1])}function a(){function t(){var t=d3.event.changedTouches;return t?d3.touches(v,t)[0]:d3.mouse(v)}function a(){32==d3.event.keyCode&&(P||(g=null,S[0]-=h[1][0],S[1]-=h[1][1],P=2),D())}function c(){32==d3.event.keyCode&&2==P&&(S[0]+=h[1][0],S[1]+=h[1][1],P=0,D())}function d(){var e=t(),a=!1;m&&(e[0]+=m[0],e[1]+=m[1]),P||(d3.event.altKey?(g||(g=[(h[0][0]+h[1][0])/2,(h[0][1]+h[1][1])/2]),S[0]=h[+(e[0]<g[0])][0],S[1]=h[+(e[1]<g[1])][1]):g=null),A&&p(e,l,0)&&(i(x),a=!0),k&&p(e,u,1)&&(r(x),a=!0),a&&(n(x),y({type:"brush",mode:P?"move":"resize"}))}function p(t,e,n){var i,r,a=dv.util.scaleRangeNoReverse(e),s=a[0],l=a[1],u=S[n],c=h[1][n]-h[0][n];return P&&(s-=u,l-=c+u),i=Math.max(s,Math.min(l,t[n])),P?r=(i+=u)+c:(g&&(u=Math.max(s,Math.min(l,2*g[n]-i))),i>u?(r=i,i=u):r=u),h[0][n]!==i||h[1][n]!==r?(o=null,h[0][n]=i,h[1][n]=r,!0):void 0}function f(){d(),x.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),d3.select("body").style("cursor",null),w.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),y({type:"brushend"}),D()}var g,m,v=this,_=d3.select(d3.event.target),y=s.of(v,arguments),x=d3.select(v),b=_.datum(),A=!/^(n|s)$/.test(b)&&l,k=!/^(e|w)$/.test(b)&&u,P=_.classed("extent"),S=t(),w=d3.select(window).on("mousemove.brush",d).on("mouseup.brush",f).on("touchmove.brush",d).on("touchend.brush",f).on("keydown.brush",a).on("keyup.brush",c);if(P)S[0]=h[0][0]-S[0],S[1]=h[0][1]-S[1];else if(!b||"e"!==b&&"w"!==b&&"s"!==b&&"n"!==b&&"nw"!==b&&"ne"!==b&&"sw"!==b&&"se"!==b)d3.event.altKey&&(g=S.slice());else{var M=+/w$/.test(b),T=+/^n/.test(b);m=[h[1-M][0]-S[0],h[1-T][1]-S[1]],S[0]=h[M][0],S[1]=h[T][1]}x.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",_.style("cursor")),y({type:"brushstart"}),d(),D()}var o,s=E(e,"brushstart","brush","brushend"),l=null,u=null,c=B[0],h=[[0,0],[0,0]];return e.x=function(t){return arguments.length?(l=t,c=B[!l<<1|!u],e):l},e.y=function(t){return arguments.length?(u=t,c=B[!l<<1|!u],e):u},e.extent=function(t){var n,i,r,a,s;return arguments.length?(o=[[0,0],[0,0]],l&&(n=t[0],i=t[1],u&&(n=n[0],i=i[0]),o[0][0]=n,o[1][0]=i,l.invert&&(n=l(n),i=l(i)),n>i&&(s=n,n=i,i=s),h[0][0]=0|n,h[1][0]=0|i),u&&(r=t[0],a=t[1],l&&(r=r[1],a=a[1]),o[0][1]=r,o[1][1]=a,u.invert&&(r=u(r),a=u(a)),r>a&&(s=r,r=a,a=s),h[0][1]=0|r,h[1][1]=0|a),e):(t=o||h,l&&(n=t[0][0],i=t[1][0],o||(n=h[0][0],i=h[1][0],l.invert&&(n=l.invert(n),i=l.invert(i)),n>i&&(s=n,n=i,i=s))),u&&(r=t[0][1],a=t[1][1],o||(r=h[0][1],a=h[1][1],u.invert&&(r=u.invert(r),a=u.invert(a)),r>a&&(s=r,r=a,a=s))),l&&u?[[n,r],[i,a]]:l?[n,i]:u&&[r,a])},e.clear=function(){return o=null,h[0][0]=h[0][1]=h[1][0]=h[1][1]=0,e},e.empty=function(){return l&&h[0][0]===h[1][0]||u&&h[0][1]===h[1][1]},d3.rebind(e,s,"on")};var I={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},B=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];T.prototype.on=function(t,e){var n=t.indexOf("."),i="";return n>0&&(i=t.substring(n+1),t=t.substring(0,n)),2>arguments.length?this[t].on(i):this[t].on(i,e)},dv.behavior.zoom=dv.behavior.extend(function(){function t(t){arguments.length&&!dv.util.isArray(t)&&(this._dimensions=[this._dimensions]),this._fluidDimensions=t||["x","y"],this._zoom=d3.behavior.zoom(),this.scaleExtent([0,1/0]),this._underGeoms=!1}return t.initializeZoom=function(){var t=this;this._cacheAxes(),this._zoom.on("zoomstart.zoom",function(){t._zoomStart&&t._zoomStart.call(this,"start",d3.event.scale,d3.event.translate,t)}).on("zoom.zoom",function(){t._zoomMove&&t._zoomMove.call(this,"move",d3.event.scale,d3.event.translate,t),t._refresh(d3.event.scale,d3.event.translate)}).on("zoomend.zoom",function(){t._zoomEnd&&t._zoomEnd.call(this,"end",d3.event.scale,d3.event.translate,t)})},t.underGeoms=function(t){return arguments.length?(this._underGeoms=t,this):this._underGeoms},t._cacheAxes=function(){this._axisCache={};for(var t in this._chart._axes._axes)this._axisCache[t]=this._chart._axes._axes[t]},t._removeEvents=function(){this._zoom.on("zoomstart.zoom",null).on("zoom.zoom",null).on("zoomend.zoom",null)},t._refresh=function(t,e){var n=this,i=[0,this._bounds.width-this._bounds.width*t],r=[0,this._bounds.height-this._bounds.height*t];t>=1?(e[0]=Math.min(i[0],Math.max(e[0],i[1])),e[1]=Math.min(r[0],Math.max(e[1],r[1]))):(e[0]=e[0]<i[0]?i[0]:e[0]>i[1]?i[1]:e[0],e[1]=e[1]<r[0]?r[0]:e[1]>r[1]?r[1]:e[1]),this._zoom.translate(e),setTimeout(function(){n._chart._axes._axes=n._axisCache,n._chart.duration(0),n._chart._finalizePlotBounds(),n._chart._facet._render()},0)},t._setScales=function(){if(this._fluidDimensions.indexOf("x")>=0){var t=this._chart.getTrainedScale("x");this._zoom.x(t._d3Scale)}if(this._fluidDimensions.indexOf("y")>=0){var e=this._chart.getTrainedScale("y");this._zoom.y(e._d3Scale)}},t._render=function(t){this._zoomContainer=t.selectAll(".zoom-container").data([0]),this._zoomContainer.enter().append("g").classed("zoom-container");var e=this._zoomContainer.selectAll(".zoom-pane").data([0]);e.enter().append("rect").classed("zoom-pane",!0);var n=this._chart.facet().getPanel(0),i=n.bounds();e.attr("x",i.left).attr("y",i.top).attr("width",i.width).attr("height",i.height).call(this._zoom),this._bounds=i},t.scale=function(t){return arguments.length?(this._zoom.scale(t),this._refresh(t,this._zoom.translate()),this):this._zoom.scale()},t.scaleExtent=function(t){return arguments.length?(this._zoom.scaleExtent(t),this):this._zoom.scaleExtent()},t.translate=function(t){return arguments.length?(this._zoom.translate(t),this._refresh(this._zoom.scale(),t),this):this._zoom.translate()},t.zoomStart=function(t){return arguments.length?(this._zoomStart=t,this):this._zoomStart},t.zoomMove=function(t){return arguments.length?(this._zoomMove=t,this):this._zoomMove},t.zoomEnd=function(t){return arguments.length?(this._zoomEnd=t,this):this._zoomEnd},t.chart=function(t){return arguments.length?(this._chart=t,this.initializeZoom(this._chart),this._chart&&(this._setScales(),this._chart.clipPlot(!0)),this):this._chart},t}),dv.behavior.rollover=dv.behavior.extend(function(){function t(){this._selection=null,this._showTooltip=this._defaultShowTooltip,this._hideTooltip=this._defaultHideTooltip,this._orientation="right",this._tooltipPadding=10,this._content=this._defaultContent}return t._render=function(t){this._xGuides=this.__geom._chart._axes._get("x"),this._yGuides=this.__geom._chart._axes._get("y"),this._isPolar=this.__geom.coord()instanceof dv.coord.polar,this._selection=t,this.addEvents()},t.addEvents=function(){var t=this;this.__geom.on("mouseover",function(e,n,i){t._showTooltip.call(this,e,n,i,d3.event,t),t._mouseOver&&t._mouseOver.call(this,e,n,i)}).on("mouseout",function(e,n,i){t._hideTooltip.call(this,e,n,i,d3.event,t),t._mouseOut&&t._mouseOut.call(this,e,n,i)})},t._defaultShowTooltip=function(t,e,n,i,r){r._darkenGeom.call(this,t,e,n,r),r._showTip.call(this,t,e,n,r)},t._defaultHideTooltip=function(t,e,n,i,r){r._brightenGeom.call(this,t,e,n,r),r._removeTip.call(this,t,e,n,r)},t._darkenGeom=function(t,e,n,i){var r=d3.select(this),a=function(t,e,n){if(e[t]){var r=i.__geom.getScale(t).mapValue(e[t]);n.style(t,""+d3.rgb(r).darker(1))}};a("fill",t,r),a("stroke",t,r)},t._brightenGeom=function(t,e,n,i){var r=d3.select(this),a=function(t,e,n){if(e[t]){var r=i.__geom.getScale(t).mapValue(e[t]);n.style(t,r)}};a("fill",t,r),a("stroke",t,r)},t._showTip=function(t,e,n,i){var r=d3.select(i.__geom.chart()._chartContainer.node()),a=this.getBBox(),o=dv.absoluteCoordinates(i.__geom.chart(),[a.x,a.y],t.panel),s={height:a.height,width:a.width,x:o[0],y:o[1]};dv.showTooltip(s,r.select(".plot").node().getBBox(),i.content().call(i,t,e,n),i._orientation,i._tooltipPadding,r)},t._removeTip=function(t,e,n,i){dv.removeTooltip(d3.select(i.__geom.chart()._chartContainer.node()))},t._defaultContent=function(t){var e=this.__geom.getExplicitScale("group"),n=t.panel.xScale(t),i=t.panel.yScale(t),r=this._xGuides[n.scaleIndex()],a=this._yGuides[i.scaleIndex()],o=r.__scale&&r.tickFormat()?r.tickFormat():String,s=a.__scale&&a.tickFormat()?a.tickFormat():String,l='<span class="metric-value">'+s(t.data[i.mapping()])+'</span><span class="metric-name">'+i.mapping()+"</span>"+'<span class="metric-value">'+o(t.data[n.mapping()])+'</span><span class="metric-name">'+n.mapping()+"</span>";return e&&e.mapping()&&(l='<span class="series-name">'+t.data[e.mapping()]+"</span>"+l),l},t.content=function(t){return arguments.length?(this._content=d3.functor(t),this):this._content},t.tooltipPadding=function(t){return arguments.length?(this._tooltipPadding=t,this):this._tooltipPadding},t.orientation=function(t){return arguments.length?(this._orientation=t,this):this._orientation},t.mouseOver=function(t){return arguments.length?(this._mouseOver=t,this):this._mouseOver},t.mouseOut=function(t){return arguments.length?(this._mouseOut=t,this):this._mouseOut},t.showTooltip=function(t){return arguments.length?(this._showTooltip=t,this):this._showTooltip
},t.hideTooltip=function(t){return arguments.length?(this._hideTooltip=t,this):this._hideTooltip},t._geom=function(t){return arguments.length?(this.__geom=t,this):this.__geom},t}),dv.behavior.voronoiRollover=dv.behavior.rollover.extend(function(){function t(){this._super(),this._voronoiContainer=null,this._points=null,this._pointDetectionRadius=12,this._numHitAreaVertices=12,this._isPolar=!1}return t._render=function(t){this._xGuides=this.__geom._chart._axes._get("x"),this._yGuides=this.__geom._chart._axes._get("y"),this._isPolar=this.__geom.coord()instanceof dv.coord.polar,this._selection=t,this._createTooltipContainer(),this._renderPolygons(this._getPolygonData(),t)},t._createTooltipContainer=function(){this._voronoiContainer=this._selection.selectAll(".voronoiSelection-container").data([this]),this._voronoiContainer.enter().append("g").classed("voronoiSelection-container",!0)},t._getPolygonData=function(){var t=[],e=(this.__geom._nestData,this);this._points=[];var n=e.__geom.coord()._point().x(function(t){return t.x}).y(function(t){return t.y}).defined(function(){return!0});return dv.util.each(this.__geom._nestData,function(i,r){dv.util.each(i.values,function(i,a){var o={},s=i.panel.xScale(i),l=i.panel.yScale(i);o.x=s.mapPropToPercent(i)||0,o.y=l.mapValueToPercent(l.mapValue(i.hasOwnProperty("y0")?i.y+i.y0:i.y),a)||0,o.panel=i.panel;var u=n.getBounds(o,a);if(e._isPolar){var c=e.__geom.coord()._transformAngleRadiusToXY(u.bounds.x,u.bounds.y);range.bounds.x=c[0],range.bounds.y=c[1]}e._points.push({data:u,rawData:i,seriesIndex:r,index:a}),t.push([u.bounds.x,u.bounds.y])})}),d3.geom.voronoi(t)},t._renderPolygons=function(t,e){var n,i=this,r=(this.__geom._nestData.length,this.__geom._nestData[0].values.length,d3.select(e.node().parentNode),0),a=0;if(this._isPolar){var o=this.__geom._nestData[0].values[0].panel,s=dv.util.scaleRangeNoReverse(o.xOuterScale()),l=dv.util.scaleRangeNoReverse(o.yOuterScale());r=(s[0]+s[1])/2,a=(l[0]+l[1])/2}this._voronoiContainer.attr("transform","translate("+r+","+a+")");var u=this._voronoiContainer.selectAll("path").data(t);u.exit().remove(),u.enter().append("path").attr("id",function(t,e){return"path-"+e}).classed("voronoi-overlay",!0),u.attr("d",function(t,e){return i._getPolygonPath(t,e,i)}).on("mouseover.voronoiSelection",function(t,e){n=i._points[e],i._showTooltip.call(this,n.rawData,n.index,n.seriesIndex,d3.event,i),i._mouseOver&&i._mouseOver.call(this,n.rawData,n.index,n.seriesIndex)}).on("mouseout.voronoiSelection",function(t,e){n=i._points[e],i._hideTooltip.call(this,n.rawData,n.index,n.seriesIndex,d3.event,i),i._mouseOut&&i._mouseOut.call(this,n.rawData,n.index,n.seriesIndex)}).call(this._removeRegisteredEvents,this).call(this._addRegisteredEvents,this),u.exit().on("mouseover.voronoiSelection",null).on("mouseover.voronoiSelection",null)},t._addRegisteredEvents=function(t,e){e||(e=this),e.__geom&&(t=t||e._voronoiContainer.selectAll(".voronoi-overlay"),dv.util.each(e.__geom.eventMap,function(n,i){t.on(i,function(t,n){e.__geom.eventMap[i].callback.call(this,t,n,d3.event)},n.capture)}),dv.util.each(e.__geom._chart.eventMap,function(n,i){t.on(i+".dvchart",function(){var t=d3.event,n=e.__geom._chart._interactionGroup.node();e._shouldDispatchChartEvent(t,n)&&e.__geom._chart.eventMap[i].callback.call(n,t)},n.capture)}))},t._removeRegisteredEvents=function(t,e){e||(e=this),e.__geom&&(t=t||e._voronoiContainer.selectAll(".voronoi-overlay"),dv.util.each(e.unregisterEventMap,function(e,n){t.on(n,null,e)}),dv.util.each(e.__geom._chart.unregisterEventMap,function(e,n){t.on(n+".dvchart",null,e)}))},t._shouldDispatchChartEvent=function(t,e){var n=!0;if("mouseout"===t.type||"mouseover"===t.type){var i=t.relatedTarget;i||(i="mouseout"===t.type?t.toElement:t.fromElement);var r=d3.select(i);r&&!r.empty()&&(r.attr("class"),n=!(r.node()===e||r.classed("voronoi-overlay")))}return n},t._getPolygonPath=function(t,e,n){if(!t)return null;var i=(dv.util.clone(t),n._points[e]),r=d3.geom.polygon(n._getPolygonPoints(i.data.bounds.x,i.data.bounds.y)),a=r.clip(t);return a.length?"M"+a.join("L")+"Z":null},t._getPolygonPoints=function(t,e){for(var n=[],i=360;i>0;i-=360/this._numHitAreaVertices){var r=i*Math.PI/180,a=Math.cos(r)*this._pointDetectionRadius+t,o=Math.sin(r)*this._pointDetectionRadius+e;n.push([a,o])}return n},t._defaultShowTooltip=function(t,e,n,i,r){r._showPoint.call(this,t,e,n,r),r._showTip.call(this,t,e,n,r)},t._defaultHideTooltip=function(t,e,n,i,r){r._removePoint.call(this,t,e,n,r),r._removeTip.call(this,t,e,n,r)},t._showPoint=function(t,e,n,i){var r=10,a=i.getGeomFromVoronoiIndex.call(i,t,e,n);if(!a.empty()){var o=a.node().getBoundingClientRect(),s={height:o.height,width:o.width,x:o.x,y:o.y};r=Math.max(s.height,s.width)/2+2.5}i._voronoiContainer.append("circle").classed("hover-point",!0).attr("id","point-"+n+"-"+e).attr("cx",t.bounds.x).attr("cy",t.bounds.y).attr("r",0).style("stroke",function(){return i.__geom.getHighlightColor(t,e)}).style("pointer-events","none").transition().duration(350).attr("r",r)},t._removePoint=function(t,e,n,i){i._voronoiContainer.selectAll("#point-"+n+"-"+e).transition().duration(350).attr("r",0).remove()},t._showTip=function(t,e,n,i){var r,a=d3.select(i.__geom.chart()._chartContainer.node()),o=i.getGeomFromVoronoiIndex.call(i,t,e,n);if(o.empty()){var s=dv.absoluteCoordinates(i.__geom.chart(),[t.bounds.x,t.bounds.y],t.panel),l=10,u=10;r={height:l,width:u,y:s[1]-l/2,x:s[0]-u/2}}else{var c=o.node().getBBox();r={height:c.height,width:c.width,x:c.x,y:c.y}}dv.showTooltip(r,a.select(".panels").node().getBBox(),i.content().call(i,t,e,n),i._orientation,i._tooltipPadding,a)},t.getGeomFromVoronoiIndex=function(t,e,n){return this.__geom.chart()._g.selectAll(".datum-"+e+".series-"+n).filter(function(e){return t===e})},t.pointDetectionRadius=function(t){return arguments.length?(this._pointDetectionRadius=t,this):this._pointDetectionRadius},t.numHitAreaVertices=function(t){return arguments.length?(this._numHitAreaVertices=t,this):this._numHitAreaVertices},t}),dv.log=dv.log||{},dv.log.NOCONSOLE=!1,dv.log.LVL_ERROR=0,dv.log.ERROR="error",dv.log.LVL_WARN=1,dv.log.WARN="warn",dv.log.LVL_DEBUG=2,dv.log.DEBUG="debug",dv.log.LOGLEVEL=dv.log.LVL_DEBUG,dv.log.error=function(t){return dv.log._message(dv.log.ERROR,t)},dv.log.warn=function(t){return dv.log._message(dv.log.WARN,t)},dv.log.debug=function(t){return dv.log._message(dv.log.DEBUG,t)},dv.log.noConsole=function(t){dv.log.NOCONSOLE=t||!1,dv.log.console=window.console||dv.util.noop,(!dv.log.console.log||dv.log.NOCONSOLE)&&(dv.log.console.log=dv.util.noop),(!dv.log.console.error||dv.log.NOCONSOLE)&&(dv.log.console.error=dv.log.console.log),(!dv.log.console.warn||dv.log.NOCONSOLE)&&(dv.log.console.warn=dv.log.console.log),(!dv.log.console.debug||dv.log.NOCONSOLE)&&(dv.log.console.debug=dv.log.console.log)},dv.log._message=function(t,e){if(dv.log._isValidType(t)){if(dv.log.LOGLEVEL>=dv.log["LVL_"+t.toUpperCase()]&&dv.log.console[t](e.msg,e.data),t===dv.log.ERROR)throw e.msg+" Context Data: "+JSON.stringify(e.data)}else dv.log.console.log("Logging message with invalid type: "+t)},dv.log._isValidType=function(t){return t===dv.log.ERROR||t===dv.log.WARN||t===dv.log.DEBUG},dv.log.noConsole(!1),dv.panel=dv.extend(function(){function t(){this._margins={left:0,top:0,right:0,bottom:0},this._trainedScales={}}return t.getTrainedScale=function(t){return"x"===t?this.xScale():"y"===t?this.yScale():this._trainedScales[t]},t.getOuterScale=function(t){return"x"===t?this._xScale:"y"===t?this._yScale:null},t._updateRanges=function(t){var e=[t.left,t.right],n=[t.bottom,t.top];this._facet._chart.coord().flip()?(this._xScale.range(n),this._yScale.range(e)):(this._xScale.range(e),this._yScale.range(n))},t.bounds=function(t){return arguments.length?(this._bounds=t,this._updateRanges(this._bounds),this):this._bounds},t.margins=function(t){return arguments.length?(this._margins=t,this):this._margins},t.visibleAxisLabelOrientations=function(t){return arguments.length?(this._visibleAxisLabelOrientations=t,this):this._visibleAxisLabelOrientations},t.columnIndex=function(t){return arguments.length?(this._columnIndex=t,this):this._columnIndex},t.rowIndex=function(t){return arguments.length?(this._rowIndex=t,this):this._rowIndex},t.facetIndex=function(t){return arguments.length?(this._facetIndex=t,this):this._facetIndex},t.facetKey=function(t){return arguments.length?(this._facetKey=t,this):this._facetKey},t.xFacetTitle=function(t){return arguments.length?(this._xFacetTitle=t,this):this._xFacetTitle},t.yFacetTitle=function(t){return arguments.length?(this._yFacetTitle=t,this):this._yFacetTitle},t.xOuterScale=function(t){return arguments.length?(this._xScale=t,this):this._xScale},t.yOuterScale=function(t){return arguments.length?(this._yScale=t,this):this._yScale},t.xScale=function(t){var e=0;return t&&t.hasOwnProperty("x-index")&&(e=t["x-index"]),this._xScale.innerScaleGroup()[e]},t.yScale=function(t){var e=0;return t&&t.hasOwnProperty("y-index")&&(e=t["y-index"]),this._yScale.innerScaleGroup()[e]},t.facet=function(t){return arguments.length?(this._facet=t,this._trainedScales={},this):this._facet},t}),dv.facet=dv.extend(function(){function t(){this._numColumns=0,this._numRows=0,this._hGap=10,this._vGap=10,this._panelsWithAxisLabels=[]}return t._prerender=function(){var t=this;this._trainedScales={},this._panels=[],this._rows=[],this._columns=[],dv.util.each(t._chart._layers,function(e){e._prerender(t._chart),t._trainFacetGroups(e)}),this._configureFacets(),dv.util.each(t._chart._layers,function(e){e._nestData=t._nestFacet(e),e._handlePositions(),e._trainScales(),e._createDefaultScales()}),this._trainScales()},t._trainScales=function(){var t,e=this,n=function(t){return function(n){return e._getFacetFromFacetKey(n)!==t.facetKey()}},i=function(){return function(t,e,n){return 2>arguments.length&&(e=0),3>arguments.length?void 0===this._globalScales[t]?null:this._globalScales[t][e]:(this._globalScales[t]||(this._globalScales[t]={}),this._globalScales[t][e]=n,n)}};this._globalScales={},this._positionScales={},dv.util.each(this._panels,function(r){dv.util.each(e._chart._layers,function(a){for(var o in a._aes){var s=a._aes[o];for(var l in s){var u=a.getScale(o,l);u instanceof dv.scale.constant||(t=e._isFree.call(e,o)?e._trainFreeScale(a,r,o,l,n(r)):e._trainScale(a,i(a),o,l),r._trainedScales[o]||(r._trainedScales[o]={}),r._trainedScales[o][l]=t,s[l].unionDomain(t.domain(),t.reverse()),s[l].range(t.range()))}}})})},t._isFree=function(t){var e="x"===t||"xMin"===t||"xMax"===t,n="y"===t||"yMin"===t||"yMax"===t;return e&&("free"===this._scales||"free_x"===this._scales)||n&&("free"===this._scales||"free_y"===this._scales)},t._trainScale=function(t,e,n,i,r){var a,o=e.call(this,n,i),s={stack:"stack"===t.position()&&"y"===n,fill:"fill"===t.position()&&"y"===n,filter:r};return o?(a=t._aes[n][i],o.unionDomain(a.calculateDomain(t._nestData,s),o.reverse()),o.unionRange(a.range())):(t._aes[n][i].trainDomain(t._nestData,s),o=t._aes[n][i].copy(),e.call(this,n,i,o)),o},t._render=function(){this._axes=this._chart._axes;var t=this._ensureColumnsAndRows();this._adjustPlotBounds(t[0],t[1]),this._configurePanels(t[0],t[1]),this._axes._initializeAxisRenderers(),this._axes._measureTitles(this._chart._plotBounds);var e=this._measureMargins(t[0],t[1]);this._layoutPanels(t[0],t[1],e),this._renderAxisTitles(),this._renderPanels()},t._setVisibleAxisLabelOrientations=function(t,e,n,i){var r=t.rowIndex(),a=t.columnIndex(),o={left:0===a,top:0===r,right:a===n||t.facetIndex()===i-1,bottom:r===e||a>n&&r===e-1};t.visibleAxisLabelOrientations(o)},t._changeScaleRangeToLocal=function(t){var e=t.range(),n=t.innerScaleGroup();for(var i in n)dv.util.scaleRange(n[i],[e[0],e[1]]).applyRangePadding();return n},t._measureMargins=function(t){var e=this._panels.length,n=~~((e-1)/t),i=(e-1)%t,r=this._axes._getAllOrientations(),a={rows:[],cols:[]},o=this._isFree("x"),s=this._isFree("y"),l=this._panels[0];l&&(this._changeScaleRangeToLocal(l.getOuterScale("x")),this._changeScaleRangeToLocal(l.getOuterScale("y")));for(var u=-1;e>++u;){var c=this._panels[u],h=c.columnIndex(),d=c.rowIndex();this._setVisibleAxisLabelOrientations(c,n,i,e),c.margins({left:0,top:0,right:0,bottom:0}),d>=a.rows.length&&(a.rows[d]={left:0,top:0,right:0,bottom:0}),h>=a.cols.length&&(a.cols[h]={left:0,top:0,right:0,bottom:0}),this._panelsWithAxisLabels.push(c),this._axes._measure(c);var p=c.margins();void 0!==r.right&&!s&&u===e-1&&t-1>h&&(p.right=0),void 0!==r.bottom&&!o&&h>=i&&d===n-1&&(p.bottom=0);for(var f in a){var g="rows"===f?d:h,m=a[f][g];m.left=Math.max(p.left,m.left),m.top=Math.max(p.top,m.top),m.right=Math.max(p.right,m.right),m.bottom=Math.max(p.bottom,m.bottom)}}return a},t._layoutPanels=function(t,e,n){var i,r,a,o,s=this._chart._plotBounds,l=s.right-s.left-(t-1)*this._hGap,u=s.bottom-s.top-(e-1)*this._vGap,c={x:0,y:0},h=this;for(a=-1,o=n.cols.length;o>++a;)l-=n.cols[a].left+n.cols[a].right;for(a=-1,o=n.rows.length;o>++a;)u-=n.rows[a].bottom+n.rows[a].top;i=Math.max(l/t,0),r=Math.max(u/e,0);var d=this._chart._chartContainer.select(".axes-labels"),p=d.selectAll(".panel-labels").data(this._panelsWithAxisLabels);p.enter().append("div"),p.exit().remove(),p.attr("class",function(t){return"panel-labels panel-"+t.facetIndex()});var f=this._chart._panelContainer.selectAll(".panel").data(this._panels);f.enter().append("g").classed("panel",!0),f.exit().remove(),f.each(function(a,o){h._drawPanel.call(this,h,a,o,s,n,i,r,t,e,c),h._axes._render.call(h._axes,d3.select(this),d.select(".panel-labels.panel-"+a.facetIndex()),a)})},t._renderAxisTitles=function(){var t=this.getColumn(0)[0].bounds(),e=this.getRow(0)[0].bounds(),n=this.getColumn(this._columns.length-1)[0].bounds(),i=this.getRow(this._rows.length-1)[0].bounds(),r=(i.bottom-e.top)/2+e.top,a=(n.right-t.left)/2+t.left,o=this._chart.plotBounds();this._axes._renderTitles({left:[o.left,r],right:[o.right,r],top:[a,o.top],bottom:[a,o.bottom]})},t._renderPanels=function(){var t=this._chart,e=(t._plotBounds,t._g.select(".plot"));t._plotBounds;var n=function(t){t.attr("transform","translate(0,0)").each(function(t){this.__previousData__&&this.__previousData__._dataPointStyleClass!=t._dataPointStyleClass&&this.__previousData__.exit(this),t._render(this),this.__previousData__=t})},i=function(t){t.each(function(e){e.exit(this,function(){t.remove()})})},r=e.selectAll(".geom").data(t._layers);r.exit().call(i),r.enter().append("g").classed("geom",!0),r.call(n)},t._updatePanelTitle=function(t,e,n,i,r,a,o){var s={left:0,top:0,width:0,height:0},l=d3.select(this);if(dv.util.isUndefined(e))return t._removePanelTitle.call(this,n),s;var u=l.selectAll(".panel-title."+n).data([0]),c=u.enter().append("g").classed("panel-title "+n,!0).attr("transform","translate("+i+","+r+")"),h=c.append("rect").classed("panel-title-bg",!0),d=c.append("text").classed("panel-title-label",!0).attr("text-anchor","middle");dv.ANIMATION?u.transition().duration(t._chart._duration).attr("transform","translate("+i+","+r+")"):u.attr("transform","translate("+i+","+r+")");var p=u.selectAll(".panel-title-label").text(e),f=u.selectAll(".panel-title-bg"),g=p.node().getBBox(),m=0;switch(dv.ANIMATION&&(p=p.transition().duration(t._chart._duration),f=f.transition().duration(t._chart._duration)),n){case"top":x=a/2,y=g.height,s.left=0,s.top=0,s.width=a,s.height=g.height+6;break;case"right":x=o/2,y=-a+g.height,s.left=a-(g.height+6),s.top=0,s.width=g.height+6,s.height=o,m=90;break;case"bottom":x=a/2,y=o-6,s.left=0,s.top=o-(g.height+6),s.width=a,s.height=g.height+6;break;case"left":x=-o/2,y=0+g.height,s.left=0,s.top=0,s.width=g.height+6,s.height=o,m=270}return h.attr("x",s.left).attr("y",s.top).attr("width",s.width).attr("height",s.height),d.attr("transform","rotate("+m+" 0,0)").attr("x",x).attr("y",y),p.attr("transform","rotate("+m+" 0,0)").attr("x",x).attr("y",y),f.attr("x",s.left).attr("y",s.top).attr("width",s.width).attr("height",s.height),s},t._removePanelTitle=function(t){d3.select(this).selectAll(".panel-title."+t).remove()},t._updatePanelBackground=function(t,e,n,i,r){var a=d3.select(this).selectAll(".plot-bg").data([0]);a.enter().append("rect").classed("plot-bg",!0).style("opacity",1e-6).attr("x",e).attr("y",n).attr("width",i).attr("height",r),dv.ANIMATION&&(a=a.transition().duration(t._chart._duration)),a.attr("x",e).attr("width",i).attr("height",r).style("opacity",1)},t._addToCollection=function(t,e,n){t[e]||(t[e]=[]),t[e].push(n)},t.getPanel=function(t){return this._panels&&this._panels.length>t?this._panels[t]:null},t.getRow=function(t){return this._rows[t]},t.getColumn=function(t){return this._columns[t]},t.getTrainedScale=function(t){return this._panels.length>0?this.getPanel(0).getTrainedScale(t):this._trainedScales[t]},t.scales=function(t){return arguments.length?(this._scales=t,this):this._scales},t.space=function(t){return arguments.length?(this._space=t,this):this._space},t.titleFormat=function(t){return arguments.length?(this._titleFormat=d3.functor(t),this):this._titleFormat},t.hGap=function(t){return arguments.length?(this._hGap=t,this):this._hGap},t.vGap=function(t){return arguments.length?(this._vGap=t,this):this._vGap},t.chart=function(t){return arguments.length?(this._chart=t,this):this._chart},t}),dv.facet.scale=dv.extend(function(){function t(){}return t.domain=function(){return this._innerScale.domain()},t.range=function(t){return arguments.length?(this._range=t,this):this._range},t._applyPercentage=function(t,e){return this._range[0]+(this._range[1]-this._range[0])*t.apply(this._innerScale,e)},t.mapPropToPercent=function(t){return this._innerScale.mapPropToPercent(t)},t.mapValueToPercent=function(t){return this._innerScale.mapValueToPercent(t)},t.mapToProp=function(t,e){return this._applyPercentage(this._innerScale.mapPropToPercent,[t,e])},t.mapValue=function(t,e){return this._applyPercentage(this._innerScale.mapValueToPercent,[t,e])},t.rangeBand=function(){return this._applyPercentage(this._innerScale.rangeBand)},t.innerScaleGroup=function(t){return arguments.length?(this._innerScaleGroup=t,this):this._innerScaleGroup},t}),dv.facet.wrap=dv.facet.extend(function(){function t(){this._super(),this._facetScale=null,this._preferredAspectRatio=1,this._titleOrientation="top"}return t._prerender=function(){this._facetScale=dv.scale.ordinal().mapping(this._group).domain([]),this._super()},t._trainFacetGroups=function(t){var e=t.data()[this._facetScale.mapping()];e&&this._facetScale.domain(this._facetScale.domain().concat(e))},t._trainFreeScale=function(t,e,n,i,r){var a=function(t,n,i){return 2>arguments.length&&(n=0),3>arguments.length?e._trainedScales[t]?e._trainedScales[t][n]:void 0:(e._trainedScales[t]||(e._trainedScales[t]={}),e._trainedScales[t][n]=i,i)};return this._trainScale(t,a,n,i,r)},t._showAllPanelLabelsIfFree=function(){return!0},t._configureFacets=function(){this._facetKeys=this._facetScale.domain(),this._facetMap={}},t._nestFacet=function(t){var e,n,i=this,r=t.normalizedData(),a=dv.util.filterAndZip(r),o=t.getScale("group"),s=this._group,l=this._facetScale.domain();o&&(e=o.property(),n=e?r[e]:null);for(var u=-1,c=a.length;c>++u;){var h,d=0,p=a[u];p.data.hasOwnProperty(s)&&(d=l.indexOf(p.data[s]),d>=0&&(h=l[d]+""));var f=this._facetMap[d];f||(f=dv.panel().facetIndex(d).facetKey(h).xFacetTitle(h).facet(this),this._facetMap[d]=f,this._panels.push(f)),p.panel=f}return d3.nest().key(function(t){var n="";return n+=(t.data.hasOwnProperty(s)?t.data[s]:".")+" ~ ",n+=t.hasOwnProperty(e)?t[e]:"."}).sortKeys(function(t,e){var r=i._getGroupFromFacetKey(t),a=i._getGroupFromFacetKey(e),o=-1,s=-1;return"."!==r&&(o=n.indexOf(r),0>o&&(o=n.indexOf(Number(r)))),"."!==a&&(s=n.indexOf(a),0>s&&(s=n.indexOf(Number(a)))),o>s?1:-1}).entries(a)},t._getGroupFromFacetKey=function(t){return/.* ~ (.*)/g.exec(t)[1]},t._getFacetFromFacetKey=function(t){return/(.*) ~ .*/g.exec(t)[1]},t._ensureColumnsAndRows=function(){var t=this._panels.length,e=Math.min(this._numColumns,t),n=Math.min(this._numRows,t);if(1>e&&1>n){var i=this._chart._plotBounds,r=i.right-i.left,a=i.bottom-i.top,o=Math.min(t,Math.ceil(Math.sqrt(1*t*r/(a*this._preferredAspectRatio))));return o=isNaN(o)?1:o,[o,Math.ceil(t/o)]}return 1>e&&n>=1&&(e=Math.ceil(t/n)),e>=1&&1>n&&(n=Math.ceil(t/e)),[e,n]},t._adjustPlotBounds=function(){},t._configurePanels=function(t,e){for(var n=this._chart._plotBounds,i=n.right-n.left,r=n.bottom-n.top,a=(i-(t-1)*this._hGap)/t,o=(r-(e-1)*this._vGap)/e,s=-1,l=this._panels.length;l>++s;){var u=this._panels[s],c=dv.facet.scale().innerScaleGroup(u._trainedScales.x),h=dv.facet.scale().innerScaleGroup(u._trainedScales.y),d=s%t,p=~~(s/t),f={left:0,top:0,right:a,bottom:o,width:a,height:o};this._panels[s].xOuterScale(c).yOuterScale(h).columnIndex(d).rowIndex(p).bounds(f),this._addToCollection(this._rows,p,u),this._addToCollection(this._columns,d,u)}},t._drawPanel=function(t,e,n,i,r,a,o,s,l,u){var c=e.columnIndex(),h=e.rowIndex(),d=r.rows[h],p=r.cols[c],f=t._titleOrientation;0===c&&(u.x+=i.left,0===h&&(u.y+=i.top));var g=u.y+d.top,m=u.x+p.left,v=t._titleFormat?t._titleFormat.call(this,e.xFacetTitle(),n):e.xFacetTitle(),_=t._updatePanelTitle.call(this,t,v,f,m,g,a,o);e.bounds({width:a,height:o,top:g+("top"===f?_.height:0),left:m+("left"===f?_.width:0),right:m+a+("right"===f?-_.width:0),bottom:g+o+("bottom"===f?-_.height:0)}),t._updatePanelBackground.call(this,t,m,g,a,o),c===s-1?(u.x=0,u.y+=d.top+o+d.bottom+t._vGap):u.x+=p.left+a+p.right+t._hGap},t.group=function(t){return arguments.length?(this._group=t,this):this._group},t.numColumns=function(t){return arguments.length?(this._numColumns=t,this):this._numColumns},t.numRows=function(t){return arguments.length?(this._numRows=t,this):this._numRows},t.preferredAspectRatio=function(t){return arguments.length?(this._preferredAspectRatio=t,this):this._preferredAspectRatio},t}),dv.facet.grid=dv.facet.extend(function(){function t(){this._super(),this._xFacetScale=null,this._yFacetScale=null}return t._prerender=function(){this._xFacetScale=dv.scale.ordinal().mapping(this._xGroup).domain([]),this._yFacetScale=dv.scale.ordinal().mapping(this._yGroup).domain([]),this._super()},t._trainFacetGroups=function(t){var e=t.data()[this._xFacetScale.mapping()];e&&this._xFacetScale.domain(this._xFacetScale.domain().concat(e));var n=t.data()[this._yFacetScale.mapping()];n&&this._yFacetScale.domain(this._yFacetScale.domain().concat(n))},t._trainFreeScale=function(t,e,n,i,r){var a=this,o=function(t,n,i){2>arguments.length&&(n=0),a._positionScales[t]||(a._positionScales[t]={});var r=a._positionScales[t];r[n]||(r[n]=[]);var o=r[n],s=t.indexOf("x")>=0?e.columnIndex():e.rowIndex();return 3>arguments.length?o[s][n]:(o[s][n]=i,i)};return this._trainScale(t,o,n,r)},t._showAllPanelLabelsIfFree=function(){return!1},t._configureFacets=function(){var t,e,n,i=this._xFacetScale.domain(),r=this._yFacetScale.domain();this._numColumns=Math.max(this._xFacetScale.domain().length,1),this._numRows=Math.max(this._yFacetScale.domain().length,1);for(var a=-1,o=this._numRows,s=0;o>++a;){yFacetIndex=a,r&&r.length>a&&(e=r[a]);for(var l=-1,u=this._numColumns;u>++l;){xFacetIndex=l,i&&i.length>l&&(t=i[l]),n=(r.length?e:".")+" ~ "+(i.length?t:".");var c=dv.panel().facetIndex(s++).facetKey(n).columnIndex(xFacetIndex).rowIndex(yFacetIndex).xFacetTitle(t).yFacetTitle(e).facet(this);this._panels.push(c),this._addToCollection(this._rows,yFacetIndex,c),this._addToCollection(this._columns,xFacetIndex,c)}}},t._nestFacet=function(t){var e,n,i=this,r=t.normalizedData(),a=dv.util.filterAndZip(r),o=t.getScale("group"),s=this._xFacetScale.domain(),l=this._yFacetScale.domain();o&&(e=o.property(),n=e?r[e]:null);for(var u=-1,c=a.length;c>++u;){var h=a[u],d=0,p=0;h.data.hasOwnProperty(this._xGroup)&&(p=s.indexOf(h.data[this._xGroup]),0>p&&(p=0)),h.data.hasOwnProperty(this._yGroup)&&(d=l.indexOf(h.data[this._yGroup]),0>d&&(d=0)),panelIndex=d*this._numColumns+p;var f=this._panels[panelIndex];h.panel=f}return d3.nest().key(function(t){var n="";return n+=(t.data.hasOwnProperty(i._yGroup)?t.data[i._yGroup]:".")+" ~ ",n+=(t.data.hasOwnProperty(i._xGroup)?t.data[i._xGroup]:".")+" ~ ",n+=t.hasOwnProperty(e)?t[e]:"."}).sortKeys(function(t,e){var r=i._getGroupFromFacetKey(t),a=i._getGroupFromFacetKey(e),o=-1,s=-1;return"."!==r&&(o=n.indexOf(r),0>o&&(o=n.indexOf(Number(r)))),"."!==a&&(s=n.indexOf(a),0>s&&(s=n.indexOf(Number(a)))),o>s?1:-1}).entries(a)},t._getGroupFromFacetKey=function(t){return/.* ~ .* ~ (.*)/g.exec(t)[1]},t._getFacetFromFacetKey=function(t){return/(.* ~ .*) ~ .*/g.exec(t)[1]},t._ensureColumnsAndRows=function(){return[this._numColumns,this._numRows]},t._adjustPlotBounds=function(){var t=this._measureTitles(this._xFacetScale.domain(),"temp-column-titles",this._chart._g)+3,e=this._measureTitles(this._yFacetScale.domain(),"temp-row-titles",this._chart._g)+3;this._chart._plotBounds,this._xTitleHeight=t,this._yTitleWidth=e,this._chart._plotBounds.top+=t,this._chart._plotBounds.right-=e},t._measureTitles=function(t,e){var n=this._createTitlesContainer(e,this._chart._g),i=n.selectAll(".panel-title").data(t);i.enter().append("text").text(function(t){return t});var r=n.node().getBBox();return n.remove(),r.height},t._createTitlesContainer=function(t,e){var n=e.selectAll("."+t).data([0]);return n.enter().append("g").classed(t,!0),n.exit().remove(),n},t._configurePanels=function(t,e){for(var n=this._chart._plotBounds,i=n.right-n.left,r=n.bottom-n.top,a=(i-(t-1)*this._hGap)/t,o=(r-(e-1)*this._vGap)/e,s=0,l=0,u=0,c=-1,h=this._panels.length;h>++c;){var d=this._panels[c],p=dv.facet.scale().innerScaleGroup(d._trainedScales.x),f=dv.facet.scale().innerScaleGroup(d._trainedScales.y),g={left:0,top:0,right:0+a,bottom:0+o,width:a,height:o};this._panels[c].xOuterScale(p).yOuterScale(f).bounds(g),s+=a+this._hGap,u++,u>=t&&(s=0,l+=o+this._vGap,u=0)}},t._drawPanel=function(t,e,n,i,r,a,o,s,l,u){var c=e.columnIndex(),h=e.rowIndex(),d=r.rows[h],p=r.cols[c];if(u.x+=p.left,0===c&&(u.x+=i.left),0===h){var f=t._titleFormat?t._titleFormat.call(this,e.xFacetTitle(),n):e.xFacetTitle();u.y=d.top+i.top,t._updatePanelTitle.call(this,t,f,"top",u.x,u.y-t._xTitleHeight,a,o)}else t._removePanelTitle.call(this,"top");if(c===t._numColumns-1){var g=t._titleFormat?t._titleFormat.call(this,e.yFacetTitle(),n):e.yFacetTitle();t._updatePanelTitle.call(this,t,g,"right",u.x+t._yTitleWidth,u.y,a,o)}else t._removePanelTitle.call(this,"right");e.bounds({width:a,height:o,top:u.y,left:u.x,right:u.x+a,bottom:u.y+o}),t._updatePanelBackground.call(this,t,u.x,u.y,a,o),u.x+=a+p.right+t._hGap,c===t._numColumns-1&&(u.x=0,u.y+=d.top+o+d.bottom+t._vGap)},t.xGroup=function(t){return arguments.length?(this._xGroup=t,this):this._xGroup},t.yGroup=function(t){return arguments.length?(this._yGroup=t,this):this._yGroup},t.aggregate=function(t){return arguments.length?(this._aggregate=t,this):this._aggregate},t}),dv.chart=dv.container.extend(function(){function t(){this._super(),this._firstRender=!1,this._data={},this._coord=dv.coord.cartesian(),this._facet=dv.facet.wrap().chart(this),this._layers=[],this._behaviors=[],this._legends=dv.guide.legends(),this._axes=dv.guide.axes()._chart(this),this._delay=d3.functor(0),this._duration=d3.functor(1e3),this._ease="cubic-in-out",this._parent=null,this._chartContainer=null,this._svgContainer=null,this._g=null,this._axisLabelContainer=null,this._panelContainer=null,this._interactionGroup=null,this._prerenderFunc=null,this._postrenderFunc=null,this._clipPlot=!1,this._width=0/0,this._height=0/0,this._plotWidth=0/0,this._plotHeight=0/0,this._calcWidth=0/0,this._calcHeight=0/0,this._calcPlotWidth=0/0,this._calcPlotHeight=0/0,this._defaultPadding=this._padding=this._plotBounds=this._guidesBounds={top:0,left:0,right:0,bottom:0},this._position="identity"}return t.render=function(){if(dv.util.isUndefined(this._data)||dv.util.isEmpty(this._data))for(var t=0;this._layers.length>t;t++)(dv.util.isUndefined(this._layers[t]._data)||dv.util.isEmpty(this._layers[t]._data))&&dv.log.error({msg:"Cannot render a chart with no data provided.",data:{chartData:this._data,geom:this._layers[t]}});return this._resolvePercentDimensions(),this._createChartContainer(),this._prerender(),this._renderLegends(),this._prerenderFunc&&this._prerenderFunc.call(this),this._facet._render(),this._postrenderFunc&&this._postrenderFunc.call(this),this._renderBehaviors(),this._clipGeoms(),this._cleanupGuides(),this.unregisterEventMap=null,this},t._resolvePercentDimensions=function(){this._calcWidth=dv.util.getPercentValue(this._width,this._parent.node().offsetWidth),this._calcHeight=dv.util.getPercentValue(this._height,this._parent.node().offsetHeight),dv.util.isFinite(this._calcWidth)?this._calcPlotWidth=dv.util.getPercentValue(this._plotWidth,this._calcWidth):(this._calcPlotWidth=dv.util.getPercentValue(this._plotWidth,this._parent.node().offsetWidth),dv.util.isFinite(this._calcPlotWidth)||(this._calcWidth=this._parent.node().offsetWidth)),dv.util.isFinite(this._calcHeight)?this._calcPlotHeight=dv.util.getPercentValue(this._plotHeight,this._calcHeight):(this._calcPlotHeight=dv.util.getPercentValue(this._plotHeight,this._parent.node().offsetHeight),dv.util.isFinite(this._calcPlotHeight)||(this._calcHeight=this._parent.node().offsetHeight))},t._finalizePlotBounds=function(){var t=this._legends._allowedDimensions(),e=this._legends._getWidth(),n=this._legends._getHeight(),i={left:Math.max(t.left,this._padding.left),top:Math.max(t.top,this._padding.top)};dv.util.isFinite(this._calcWidth)?dv.util.isFinite(this._calcPlotWidth)||(this._calcPlotWidth=this._calcWidth-this._padding.left-this._padding.right-e):this._calcWidth=this._calcPlotWidth+e+this._padding.left+this._padding.right,dv.util.isFinite(this._calcHeight)?dv.util.isFinite(this._calcPlotHeight)||(this._calcPlotHeight=this._calcHeight-this._padding.top-this._padding.bottom-n):this._calcHeight=this._calcPlotHeight+n+this._padding.top+this._padding.bottom,this._calcPlotWidth=Math.min(this._calcPlotWidth,this._calcWidth-this._padding.left-this._padding.right-e),this._calcPlotHeight=Math.min(this._calcPlotHeight,this._calcHeight-this._padding.top-this._padding.bottom-n),i.right=i.left+this._calcPlotWidth,i.bottom=i.top+this._calcPlotHeight,this.plotBounds(i),this._coord instanceof dv.coord.cartesian&&(this._plotBounds.right-=this._coord.endX(),this._plotBounds.left+=this._coord.startX()),this._chartContainer.style("width",this._calcWidth+"px").style("height",this._calcHeight+"px")},t._prerender=function(){this._trainedScales={},this._calculateStats(),this._facet._prerender();var t=this._normalizeData(this.data());this.data(t),this._axes._get("x")||this._axes._add("x",dv.guide.axis()),this._axes._get("y")||this._axes._add("y",dv.guide.axis())},t._createChartContainer=function(){this._chartContainer=this._parent.selectAll(".dv-chart-container").data([0]),this._chartContainer.enter().append("div").classed("dv-chart-container",!0),this._svgContainer=this._chartContainer.selectAll("svg").data([0]),this._svgContainer.enter().append("svg").style("height","100%").style("width","100%"),this._g=this._svgContainer.select(".group"),this._g.empty()&&(this._firstRender=!0,this._g=this._svgContainer.append("g").classed("group",!0),this._panelContainer=this._g.append("g").classed("panels",!0),this._interactionGroup=this._g.append("g").classed("interaction-group",!0),this._g.append("g").classed("behavior-under-geom",!0),this._g.append("g").classed("plot",!0),this._g.append("g").classed("behavior",!0),this._g.append("g").classed("legends",!0),this._interactionGroup.append("rect").classed("interaction-canvas",!0).classed("background",!0)),this._panelContainer||(this._panelContainer=this._g.select(".panels")),this._interactionGroup||(this._interactionGroup=this._g.select(".interaction-group")),this._axisLabelContainer=this._chartContainer.selectAll(".axes-labels").data([0]),this._axisLabelContainer.enter().append("div").classed("axes-labels",!0)},t._addRegisteredEvents=function(){var t=this;dv.util.each(t.eventMap,function(e,n){t._interactionGroup.on(n,function(){var e=d3.event,i=t._interactionGroup.node();t._shouldDispatchChartEvent(e,i)&&t.eventMap[n].callback.call(t._interactionGroup.node(),d3.event)
},e.capture)}),dv.util.each(t._layers,function(t){t._addRegisteredEvents()})},t._removeRegisteredEvents=function(){var t=this;dv.util.each(t.unregisterEventMap,function(e,n){t._interactionGroup&&t._interactionGroup.on(n,null,e)}),dv.util.each(t._layers,function(t){t._removeRegisteredEvents()})},t._shouldDispatchChartEvent=function(t){var e=!0;if("mouseout"===t.type||"mouseover"===t.type){var n=d3.select(t.relatedTarget);if(n&&!n.empty()){var i=n.attr("class");e=!(i&&i.indexOf("-geom")>=0)}}return e},t._calculateStats=function(){},t._renderLegends=function(){var t=dv.util.isFinite(this._calcWidth)?this._calcWidth-this._padding.left-this._padding.right:this._calcPlotWidth,e=dv.util.isFinite(this._calcHeight)?this._calcHeight-this._padding.top-this._padding.bottom:this._calcPlotHeight,n={left:this._padding.left,top:this._padding.top,width:t,height:e},i={el:this._g,scales:this._facet._globalScales,firstRender:this._firstRender,duration:this._duration,delay:this._delay,ease:this._ease};this._legends._allowedDimensions(n)._render(i),this._finalizePlotBounds()},t._cleanupGuides=function(){this._legends._empty(),this._axes._empty()},t._setRanges=function(){var t=this.plotBounds(),e=this.getTrainedScale("y"),n=this.getTrainedScale("x"),i=this.coord().flip()?[t.bottom-t.top,0]:[0,t.right-t.left],r=this.coord().flip()?[0,t.right-t.left]:[t.bottom-t.top,0];dv.util.scaleRange(n,i),dv.util.scaleRange(e,r)},t.plotBounds=function(t){return arguments.length?(this._plotBounds=t,this):this._plotBounds},t._renderBehaviors=function(){var t=this._facet.getPanel(0),e=t._bounds,n=this._g.select(".behavior").attr("transform","translate(0,0)"),i=this._g.select(".behavior-under-geom").attr("transform","translate(0, 0)");this._interactionGroup.attr("transform","translate(0,0)").select(".interaction-canvas").attr("visibility","hidden").attr("width",e.right-e.left).attr("height",e.bottom-e.top).attr("x",e.left).attr("y",e.top);var r=this;dv.util.each(this._behaviors,function(t){t.underGeoms&&t.underGeoms()?t.chart(r)._render(i):t.chart(r)._render(n)})},t.guide=function(t,e,n){if(!t||""===t)throw Error("Property argument cannot be null or empty");if("all"===t){if("none"!==e)throw Error("'all' can only be used to set all guides to 'none' (e.g. turn off all guides)");this._legends._hide(!0),this._axes._add("x","none",0),this._axes._add("y","none",0)}t=dv.util.isArray(t)?t:[t],n=dv.util.isUndefined(n)?0:n;for(var i=dv.guide.legend(),r="",a=0;t.length>a;a++){var o=e,s=this._isPositionProperty(t[a]);if(r){if(s&&"axis"!=r)throw Error("Cannot mix positional and non-positional guide types")}else r=s?"axis":"legend";if(o?!this._isValidGuideType(t[a],o)&&dv.util.isObject(o)&&(o=this._buildCustomGuide(o)):o=s?dv.guide.axis():i,this._isValidGuideType(t[a],o))if("none"!==o&&o.scaleIndex(n),s)this._axes._add(t[a],o,n);else{if("none"!==o){this._legends._add({props:t,guide:o});break}this._legends._remove(t)}}return this},t._isPositionProperty=function(t){return"x"===t||"y"===t},t._isValidGuideType=function(t,e){var n=this._isPositionProperty(t);return e&&("none"===e||e instanceof dv.guide.custom)||n&&e instanceof dv.guide.axis||!n&&e instanceof dv.guide.legend},t._buildCustomGuide=function(t){var e=dv.guide.custom();for(var n in t)e.setFunc(n,t[n]);return e},t.getScale=function(t,e){return 2>arguments.length&&(e=0),"group"===t?this._getGroup():this._aes.hasOwnProperty(t)?this._aes[t][e]:void 0},t._getGroup=function(){if(this._aes.hasOwnProperty("group"))return this._aes.group[0];for(var t=-1,e=dv.DEFAULT_CATEGORICAL_AES.length-1;e>t++;){var n=this._aes[dv.DEFAULT_CATEGORICAL_AES[t]];if(n&&n[0]&&!dv.util.isUndefined(n[0].mapping()))return n[0]}return null},t._clipGeoms=function(){var t=this,e=this._parent.selectAll(".panel").selectAll("defs").data(function(e){return t._clipPlot?[e]:[]});e.enter().append("defs"),e.exit().remove();var n=e.selectAll("clipPath").data(function(t){return[t]});n.enter().append("clipPath").classed("dv-clip",!0),n.exit().remove(),n.attr("id",function(t){return"dv-clip"+t._facetIndex});var i=n.selectAll("rect").data(function(t){return[t]});i.enter().append("rect"),i.exit().remove(),i.attr("x",function(t){return t._bounds.left}).attr("y",function(t){return t._bounds.top}).attr("width",function(t){return t._bounds.width}).attr("height",function(t){return t._bounds.height});var r=this._parent.selectAll(".series");r.attr("clip-path",function(t){return"url(#dv-clip"+t.values[0].panel._facetIndex+")"})},t.getTrainedScale=function(t){return this._facet.getTrainedScale(t)},t.getExplicitScale=function(t,e){return void 0===e&&(e=0),this._aes[t][e]},t.parent=function(t){if(!arguments.length)return this._parent?this._parent.node():null;if(this._parent=d3.select(t),this._parent.empty())throw Error("The DV parent element was not found.");return this},t.layers=function(t){return arguments.length?(this._layers=t,this):this._layers},t.behaviors=function(t){return arguments.length?(this._behaviors=t,this):this._behaviors},t.data=function(t){return arguments.length?(this._data=t,this):this._data},t.coord=function(t){return arguments.length?(this._coord=t,this):this._coord},t.facet=function(t){return arguments.length?(this._facet=t,this._facet.chart(this),this):this._facet},t.getPlotBounds=function(){return this._plotBounds},t.plotWidth=function(t){return arguments.length?(this._plotWidth=t,this):this._plotWidth},t.plotHeight=function(t){return arguments.length?(this._plotHeight=t,this):this._plotHeight},t.width=function(t){return arguments.length?(this._width=t,this):this._width},t.height=function(t){return arguments.length?(this._height=t,this):this._height},t.padding=function(t){return arguments.length?(this._padding=dv.util.merge(this._defaultPadding,t),this):this._padding},t.prerender=function(t){return arguments.length?(this._prerenderFunc=t,this):this._prerenderFunc},t.postrender=function(t){return arguments.length?(this._postrenderFunc=t,this):this._postrenderFunc},t.clipPlot=function(t){return arguments.length?(this._clipPlot=t,this):this._clipPlot},t})}(),function(t){"use strict";function e(t,n){if(this instanceof e)return this;var i,r,a,o,s,l,u,c,h,d,p,f,g,m,v,_,y,x,b,A,k,P=n||{},S=0,w=P.displayCount||-1,M=P.showNone,T={},O=T.value=[],E=T.origValue=[],D=T.lowerBound=[],L=T.upperBound=[],F=T.series=[],z=T.date=[],V=T.category=[],C=T.label=[],N=T.groups=[],R=T.facets=[],I=T.cell=[],B=T.filter=[],G=P.showMetrics||!1,H=T.metric=[],j=t.metrics.length>1,q=!1,Y=!1;for(t.filters.length>1&&t.filters.some(function(t,e,n){return e>0&&!Y&&(Y=t.data_store!==n[e-1].data_store),e>0&&!q&&(q=(t.info&&t.info.name||"")!==(n[e-1].info&&n[e-1].info.name||"")),q&&Y}),d=0,p=t.metrics.length;p>d;++d)for(o=t.metrics[d],u=(o.name||o.id||"")+"",i=o.filter_ref,r=o.date_ref,g=w>=0?Math.min(w,i.length):i.length,f=0;g>f;++f){for(s=t.filters[i[f]],s.facet_ref||(s.facet_ref=[]),A=[],k=[],y=0,x=s.facet_ref.length;x>y;++y)b=t.facets[s.facet_ref[y]],A.push(b),k.push(b.info&&b.info.name||"");if(!s.info||0!==s.info.id||M)for(l=(s.info&&s.info.name||"")+"",h=s.data_store_name||s.data_store&&s.data_store.replace("dms/","")||"",m=0,v=r.length;v>m;++m)c=t.dates[r[m]],a=t.data[i[f]][r[m]][d],O[S]=0!==+a.val||"invalid"!==a.status&&"transform_error"!==a.status?+a.val||0:void 0,E[S]="invalid"===a.status?void 0:+a.orig_val||0,D[S]="invalid"===a.status||"transform_error"===a.status?void 0:+a.lower_bound||0,L[S]="invalid"===a.status||"transform_error"===a.status?void 0:+a.upper_bound||0,z[S]=new Date(c.val),V[S]=l,C[S]=u,_=[],Y&&_.push(h),V[S].length&&_.push(V[S]),F[S]=_.join("   "),0===F[S].length?F[S]=u:(G||j||!q)&&u.length&&(F[S]+=" ("+u+")"),N[S]=k,B[S]=s,H[S]=o,I[S]=a,R[S]=A,++S;else i.length>g&&++g}return T}var n=t.rs2dv;e.noConflict=function(){return t.rs2dv=n,this},e.prototype.convert=function(){return e.apply(null,arguments)},t.rs2dv=e,"function"==typeof define&&define.amd?define(function(){return e}):"undefined"==typeof exports?t.rs2dv=e:"object"==typeof module&&module.exports?module.exports=e:exports.rs2dv=e}(this),function(t){"use strict";var e={},n=t.dv||{},i=t.d3||{},r={};r._options=null,r._changedOptions=null,r.init=function(t){return this._initDefaultOptions(),this.setOptions(t),this},r._initDefaultOptions=function(t){var e={dataAdapter:"standard",data:null,height:null,parent:null,width:null,autoResize:!1,locale:"en_US",l10n:{}};t&&this._mergeOptions(e,t),this._options=e,this._changedOptions={};for(var n in e)this._changedOptions[n]=e[n];return this._options},r._mergeOption=function(t,e,n){switch(e){default:t[e]=n}return t},r._mergeOptions=function(t,e){for(var n in e)this._mergeOption(t,n,e[n]);return t},r._truncateLabel=function(t,e){var n=e||this.X_AXIS_LABEL_MAXLENGTH;return t.length>n?t.substring(0,n)+"...":t},r._formatNumber=function(t,e){var n,r,a,o="",s=this._dataAdapter.l10n.numberFormat;return"currency"==t||"percent"==t?(o=s[t].symbol,n=e>=0?s[t].positivePattern:s[t].negativePattern):n=e>=0?"{number}":s.negativePattern,"percent"==t&&(e*=100),e=Math.abs(e),a=e>=100?3:e>=10?e%1?3:2:e>=1?e%1?3:1:e%1?2:1,r=e>=1e3&&1e4>e?i.format(",.0f")(e):i.format("."+a+"s")(e),n.replace(/\{number\}/i,r).replace(/\{symbol\}/i,o).replace(/,/g,s.groupSeparator).replace(/\./,s.decimalSeparator)},r._getPropMapping=function(t){return this._dataAdapter.mappings()[t]},r.setOption=function(t,e){return t in this._options?(this._mergeOption(this._options,t,e),this._changedOptions||(this._changedOptions={}),this._changedOptions[t]=e,!0):!1},r.getOption=function(t){var e=this._options;return t in e?e[t]:null},r.setOptions=function(t){for(var e in t)this.setOption(e,t[e])},r._preRender=function(){if(this._clearErrorMessage(),"autoResize"in this._changedOptions&&this._updateWindowResize(),"dataAdapter"in this._changedOptions){var t=this._changedOptions.dataAdapter,n=e.dataAdapter[t];if(!n)throw Error("No data adapters were found for data adapter type "+t);var i=n[this._type]||n.base||e.dataAdapter.standard.base;this._dataAdapter=i()}this._dataAdapter.process(this._options,this._changedOptions)},r._render=function(){},r._postRender=function(){this._changedOptions={}},r.render=function(){return this.reset(),this._preRender(),this._render(),this._postRender(),this},r.reset=function(){},r._updateWindowResize=function(){this._options.autoResize?(this._autoResizeHandler=this._autoResizeHandler||n.util.bind(this._onAutoResize,this),e.windowResize.addHandler(this._autoResizeHandler)):e.windowResize.removeHandler(this._autoResizeHandler)},r._onAutoResize=function(){},r.handleError=function(t){var e="Oops! There was an error and the chart could not be rendered.";return"invaliddata"===t.code&&(e="The chart has no data"),this._setErrorMessage(e),this},r._setErrorMessage=function(t){t&&t.length?i.select(this._options.parent).html('<div class="cv-error">'+t+"</div>"):this._clearErrorMessage()},r._clearErrorMessage=function(){i.select(this._options.parent).select(".cv-error").remove()},r.destroy=function(){this.reset(),e.windowResize.removeHandler(this._autoResizeHandler)},t.cloudViz=e,e.d3=i,e.dv=n,e.rs2dv=t.rs2dv||{},e.core=r,e.localeDefinition=function(t,n,i){if(e._localeDefinitions=e._localeDefinitions||{},2===arguments.length)e._localeDefinitions[t]=n;else{if(3!==arguments.length){var r=e._localeDefinitions[t];if(!r)throw Error("Locale definition for "+t+" not found.");return r}e._localeDefinitions[t]===void 0&&(e._localeDefinitions[t]={}),e._localeDefinitions[t][i]=n}},"function"==typeof define&&define.amd?define(function(){return e}):"undefined"==typeof exports?t.cloudViz=e:"object"==typeof module&&module.exports?module.exports=e:exports.cloudViz=e}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.util=e.util||{};n.deepExtend=function(t){for(var e=Array.prototype.slice.call(arguments,1),i=-1,r=e.length;r>++i;){var a=e[i];if(a)for(var o in a)a[o]&&a[o].constructor&&a[o].constructor===Object?(t[o]=t[o]||{},n.deepExtend(t[o],a[o])):t[o]=a[o]}return t},n.createConstructor=function(t){function e(){var e=Object.create(t);return"function"==typeof e.init&&e.init.apply(e,arguments),e}return e.prototype=t,e},n.namespace=function(e,n){var i=e.split("."),r=n||t;return i.forEach(function(t){var e=r[t];e||(e=r[t]={}),r=e}),r}}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.core||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.RESPONSIVE_WIDTH_THRESHOLD=400,a.X_AXIS_LABEL_MAXLENGTH=25,a.VERT_LEGEND_WIDTH=110,a.VERT_LEGEND_TOTAL=120,a.LEGEND_ORIENTATIONS=["top","right","left"],a._chart=null,a.clipIdCounter={count:0},a.init=function(t){return this._initDefaultOptions(),this.setOptions(t),this},a._initDefaultOptions=function(t){var e={aspectRatio:null,colors:["#8cc350","#5a6eaa","#d755a5","#1ebed7","#f0a01e","#9b8ce6","#3cb5a0","#3287d2","#f0557d","#c3d250","#eb782d","#78b4f5","#5faf69","#aa5fa5","#fa5a50","#f5c841"],flip:!1,interactive:!1,legendOrientation:null,mappings:{x:"category",y:"value",fill:"series",stroke:"series",label:"label"},plotHeight:null,plotWidth:null,preRender:null};return t&&this._mergeOptions(e,t),Object.getPrototypeOf(a)._initDefaultOptions.call(this,e)},a.getChart=function(){return this._chart},a._getYTitleFromLabels=function(t){var e=i.util.uniq(t);return e&&1===e.length?e[0]:null},a._preRender=function(){Object.getPrototypeOf(a)._preRender.call(this),"data"in this._changedOptions&&(this._legendStates=null),this._options},a._postRender=function(){Object.getPrototypeOf(a)._postRender.call(this);var t=this._options,e=r.select(t.parent);this._updateYAxisHitBox(e),this._colorDualYAxes(t,e)},a._removeYAxisHitBox=function(t){t.selectAll(".axis-y .cv-axis-hitbox").remove()},a._colorDualYAxes=function(t,e){!t.dualYAxis||this._isNormalized&&this._isNormalized()||"identity"!==this._options.position&&"dodge"!==this._options.position||(e.selectAll(".axis-y.axis-index-0 span").style("color",t.colors[0]),e.selectAll(".axis-y.axis-index-1 span").style("color",t.colors[1]),e.selectAll(".axis-title-y.axis-title-index-0").style("color",t.colors[0]),e.selectAll(".axis-title-y.axis-title-index-1").style("color",t.colors[1]))},a._updateYAxisHitBox=function(t){var e=this,n=this._options,i=this._chart.facet().getPanel(0);if(i){var r=this._isSmallChart(),a=this._isNormalized&&this._isNormalized(),o=this._chart.getTrainedScale("y"),s=o&&0>=o.naturalDomain()[0],l=i.bounds().left,u=o.range()[1],c=o.range()[0],h=t.selectAll(".axes-labels .axis-y.axis-index-0"),d=h.selectAll(".cv-axis-hitbox").data([0]);!n.interactive||r||a||s||"identity"!==n.position?this._removeYAxisHitBox(t):(d.enter().append("div").classed("cv-axis-hitbox",!0),d.on("click",function(){n.interactive&&!r&&(e._dataAdapter._forceZero=!e._dataAdapter._forceZero,e._render(!0),e._postRender())}),d.style("width",l+"px").style("height",c-u+"px").style("top",u+"px").style("left",-l+"px"),d.exit().on("click",null))}else this._removeYAxisHitBox(t)},a._render=function(t){Object.getPrototypeOf(a)._render.apply(this,arguments);var e,n=this._options;try{if(!this._dataAdapter.isDataValid())throw e=Error("The chart data is invalid"),e.code="invaliddata",e;if(!n.parent)throw Error("The chart options did not contain a parent");return this._draw(t)}catch(i){this.handleError(i)}},a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments)},a.destroy=function(){return Object.getPrototypeOf(a).destroy.apply(this,arguments),this._options&&this._options.parent&&r.select(this._options.parent).select(".cv-wrapper").remove(),this},a._isMappedAndExistsInData=function(){var t=this._getPropMapping("forecast");return t&&this._options.data[t]},a._setChartCoreOptions=function(){var t=this._options,e=this._chart,n=t.aspectRatio,i=t.width,a=t.height,o=r.select(t.parent);if(e.data(this._dataAdapter.data()).width(null!==n&&null!==a?a*n:i).height(null!==n&&null!==i?i/n:a),!this._isSmallChart()){var s={left:10};t.dualYAxis&&(s.right=10),e.padding(s)}var l=o.selectAll(".cv-wrapper").data([0]);l.enter().insert("div",":first-child").classed("cv-wrapper",!0),l.classed("interactive",t.interactive),l.classed("right-overflow",this._adjustClipWidth),e.parent(l.node())},a._draw=function(t){var e=this._chart,n=(this._options,void 0===t?!1:t);if(!e)throw Error("DV Chart was not created");return this._setChartCoreOptions(),this._setChartTypeOptions(),this._isSmallChart()?this._drawSmall():this._drawLarge(),n?e.duration(1e3):e.duration(0),this._renderChart(),this},a._drawBackground=function(){var t=this._options;if(t.interactive){var e=r.select(t.parent).select(".cv-wrapper"),n=e.selectAll(".cv-bg").data([0]);n.enter().insert("div",":first-child").classed("cv-bg",!0);var i=this._chart,a=r.select(t.parent).select(".cv-legend"),o=this._legendIsVertical||!a[0][0]?0:1,s=1,l=i.padding(),u=i.facet().getPanel(i.facet()._panels.length-1).bounds(),c=i.plotBounds(),h=this._chart._legends&&this._chart._legends.hasOwnProperty("_w")?this._chart._legends._w:0,d=c.top-o-l.top,p=i._calcWidth-h,f=u.top+u.height-c.top+o+l.top;if(n.style("top",d+"px").style("left",h+"px").style("height",f+s+"px").style("width",p+"px"),this._legendIsVertical){var g=1,m=a[0][0]&&a.node().offsetHeight||0,v=m>=f-g;a.style("height",v?f-g+"px":null).classed("clipped",v)}}},a._drawClipping=function(){var t=this._chart,e=this._options,n=r.select(t._svgContainer[0][0]),i=n.selectAll("defs").data([0]);i.enter().insert("defs",":first-child");var a="cv-clip"+this.clipIdCounter.count++,o=i.selectAll(".cv-clip").data([0]);o.enter().append("clipPath").classed("cv-clip",!0).append("rect"),o.attr("id",a);var s=o.selectAll("rect"),l=t.padding(),u=t.facet().getPanel(t.facet()._panels.length-1).bounds(),c=t.plotBounds(),h=c.left-l.left,d=c.top,p=c.right-h+l.right,f=u.top+u.height-c.top;e.interactive&&(p-=1,f-=1),this._adjustClipHeight&&(f+=this._adjustClipHeight),this._adjustClipWidth&&(p+=this._adjustClipWidth),s.attr("x",h).attr("y",d).attr("width",Math.max(p,0)).attr("height",Math.max(f,0)),n.selectAll(".geom").attr("clip-path",null),n.selectAll(".geom:not(.no-clip)").attr("clip-path","url(#"+a+")")},a._renderChart=function(){var t=this._options;"function"==typeof t.preRender&&t.preRender(this.getChart()),this._chart.render(),this._drawBackground(),this._drawClipping()},a._onAutoResize=function(){this._draw(!1)},a._setChartTypeOptions=function(){},a._drawSmall=function(){},a._drawLarge=function(){},a._isSmallChart=function(){return this._getChartWidth()<this.RESPONSIVE_WIDTH_THRESHOLD},a._getChartWidth=function(){var t=this._options;if(null!==t.plotWidth&&!i.util.isPercentString(t.plotWidth))return t.plotWidth;if(null!==t.width&&!i.util.isPercentString(t.width))return t.width;var e=r.select(t.parent).node().offsetWidth,n=r.select(t.parent).node().offsetHeight;return null!==t.plotWidth?parseInt(t.plotWidth,10)/100*e:null!==t.width?parseInt(t.width,10)/100*e:null!==t.aspectRatio&&null!==n?n*t.aspectRatio:e},a._getChartHeight=function(){var t=this._options;if(null!==t.plotHeight&&!i.util.isPercentString(t.plotHeight))return t.plotWidth;if(null!==t.height&&!i.util.isPercentString(t.height))return t.height;var e=r.select(t.parent).node().offsetWidth,n=r.select(t.parent).node().offsetHeight;return null!==t.plotHeight?parseInt(t.plotHeight,10)/100*n:null!==t.height?parseInt(t.height,10)/100*n:null!==t.aspectRatio&&null!==e?e/t.aspectRatio:n},a._legendStates=null,a._legendMap=null,a._constructScale=function(t,e){var n=e||i.scale.linear(),r=this._options;return r.interactive&&(n=this._adjustLimits(n)),"y"===t&&this._dataAdapter._forceZero&&this._applyForceZero(n),n},a._applyForceZero=function(t){return t.lowerLimit(function(t){return 0>t?t:0}),t.upperLimit(function(t,e){return e>0?e:0}),t},a._adjustLimits=function(t){var e=this;return this._options,t.includeInDomain(function(t){if(null===e._legendStates)return!0;if(!e._valuesAreFilterable())return!0;var n=t.data[e._legendMap],i={};return e._legendStates.forEach(function(t){i[t.name]=t.enabled}),1===i[n]}),t},a._valuesAreFilterable=function(){return this._areSomeSeriesDisabled()&&!this._areAllSeriesDisabled()},a._areSomeSeriesDisabled=function(){var t=this._legendStates;return null!==t&&0===Math.min.apply(null,t.map(function(t){return t.enabled}))},a._areAllSeriesDisabled=function(){var t=this._legendStates;return null!==t&&0===Math.max.apply(null,t.map(function(t){return t.enabled}))},a._getEnabledValues=function(t){var e={},n=(this._options,this._dataAdapter.data()[this._getPropMapping(t)]);if(null===this._legendStates)return n;if(!this._valuesAreFilterable())return n;var i=this._dataAdapter.data()[this._legendMap];return this._legendStates.forEach(function(t){e[t.name]=t.enabled}),n=n.filter(function(t,n){return i[n]&&1===e[i[n]]})},a._updatePathStates=function(){var t,e=r.select(this._options.parent),n=this._legendStates,i=n.length;for(e.selectAll(".path-inactive").classed("path-inactive",!1),t=0;i>t;++t)e.selectAll('.series [legend-group="'+n[t].name+'"]').classed("path-inactive",1!==n[t].enabled)},a._buildLegend=function(t,e){var n=this._options,i=r.select(n.parent).select(".cv-wrapper");return n.interactive?this._buildInteractiveLegend(i,n,t,e):this._buildStandardLegend(i,n,t,e)},a._buildStandardLegend=function(t,e){t.selectAll(".cv-legend").remove(),t.selectAll(".cv-bg").remove();var n,r=this.LEGEND_ORIENTATIONS.indexOf(e.legendOrientation)>-1?e.legendOrientation:"top";switch(this._calculatedLegendOrientation){case"top":case"bottom":n={top:5,bottom:5,left:0,right:0};break;case"left":case"right":n={top:0,bottom:0,left:5,right:5}}var a=i.guide.legend().orientation(r).padding(n);return this._isSmallChart()&&a.hGap(10).vGap(2),a},a._buildInteractiveLegend=function(t,e,n,a){var o=this,s=110,l=250,u=this._dataAdapter.data()[this._getPropMapping(a)],c=u.some(function(t,e,n){return t!==n[e-1]});return c?{_render:function(t,n){var a=r.select(e.parent).select(".cv-wrapper"),u=a.selectAll(".cv-legend").data([0]);u.enter().append("div").classed("cv-legend",!0);var c=this._createLegendEntries(u,n),h=Math.min(Math.floor(this._getLegendContainingWidth()/c[0].length),l);switch(this._calculatedLegendOrientation=o.LEGEND_ORIENTATIONS.indexOf(e.legendOrientation)>-1?e.legendOrientation:"top",s>h&&("top"==this._calculatedLegendOrientation||"bottom"==this._calculatedLegendOrientation)&&(this._calculatedLegendOrientation="left"),this._calculatedLegendOrientation){case"top":case"bottom":u.style("height",null),o._legendIsVertical=!1;break;case"left":case"right":h=o.VERT_LEGEND_WIDTH,o._legendIsVertical=!0}o.LEGEND_ORIENTATIONS.forEach(i.util.bind(function(t){u.classed(t,this._calculatedLegendOrientation===t)},this)),this._sizeAndPositionLegendEntries(c,h),this._positionLegend(u)},_createLegendEntries:function(t,e){var i,a,s,l,u,c;for(i in e)a=e[i][0],c=a._mapping;l=a.domain(),s=t.selectAll(".cv-legend-entry").data(l),u=s.enter().append("div").classed("cv-legend-entry",!0),u.append("div").classed("cv-legend-title",!0),u.append("div").classed("cv-legend-marker",!0),u.append("div").classed("cv-legend-num",!0),s.exit().on("click",null).remove(),null===o._legendStates&&(o._legendMap=c,o._legendStates=Array.apply(null,Array(l.length)).map(function(t,e){return{name:l[e],enabled:1}})),o._updatePathStates();var h;return s.each(function(t,e){h=r.select(this),h.select(".cv-legend-title").text(t),"donut"===n&&o._formatNumber&&o._getCategoryTotal&&1===o.numFacets&&h.select(".cv-legend-num").text(o._getCategoryTotal(t)),h.select(".cv-legend-marker").attr("class","cv-legend-marker").classed(n,!0).style("background-color",a.mapValue(t)),h.select(".cv-legend-num").text(""),h.classed("inactive",1!==o._legendStates[e].enabled)}),s.on("click",function(t,e){var n=o._legendStates;n[e].enabled=+!n[e].enabled,r.select(this).classed("inactive",1!==n[e].enabled),o._render(!0),o._postRender(),setTimeout(function(){o._updatePathStates()},10)}),s},_positionLegend:function(t){var e={top:0,left:0};switch(this._calculatedLegendOrientation){case"bottom":e.top=o._getChartHeight()-t.node().offsetHeight;break;case"right":e.left=o._getChartWidth()-o.VERT_LEGEND_WIDTH}t.style("top",e.top+"px").style("left",e.left+"px")},_sizeAndPositionLegendEntries:function(t,e){if(o._legendIsVertical)t.each(function(){r.select(this).style("width",e+"px")});else{var n,i,a=0,s=!1,l=t[0].length,u=l*e,c=this._getLegendContainingWidth(),h=0;c>u&&u+l>c&&(h=c-u),t.each(function(){n=r.select(this);var t=e;h>0&&(t+=1,h-=1),n.style("width",t+"px"),i=n.select(".cv-legend-title").style("height",null).node().offsetHeight,i!==a&&(s=!0,a=Math.max(i,a))}),s&&t.selectAll(".cv-legend-title").style("height",a+"px")}},_getLegendContainingWidth:function(){return o._getChartWidth()-o._chart.padding().right},_getAdjustedDimensions:function(t){var n=r.select(e.parent).select(".cv-legend").node();switch(this._calculatedLegendOrientation){case"top":t.top+=n.offsetHeight||0;break;case"right":t.width-=o.VERT_LEGEND_TOTAL;break;case"left":t.left+=o.VERT_LEGEND_TOTAL;break;case"bottom":t.height-=n.offsetHeight||0}return t},_getUsedWidth:function(){return o._legendIsVertical?o.VERT_LEGEND_TOTAL:0},_getUsedHeight:function(){if(o._legendIsVertical)return 0;var t=r.select(e.parent),n=t.select(".cv-wrapper");return n.select(".cv-legend").node().offsetHeight||0}}:(t.selectAll(".cv-legend").remove(),t.selectAll(".path-inactive").classed("path-inactive",!1),"none")},a._yTitleFormat=function(t,e){var n,r,a=this._dataAdapter,o=a.yAxisTitle(),s=a.l10n,l=a.formats().y,u=void 0!==t&&l?this._dataAdapter.formats().y[t]:this._dataAdapter.formats().y;return"time"===u&&(e||(e=this._getEnabledValues("y")),n=this._yTimeGranularity(e,i.guide.axis().ticks()()),n=s.time[n.gran+"s"],n=n.charAt().toUpperCase()+n.slice(1),r=o?s.labels.yAxisTimeWithTitle:s.labels.yAxisTimeNoTitle,o=r.replace(/\{time\}/i,n).replace(/\{title\}/i,o)),o},a._yTickFormat=function(t,e){var n,r=this,a=r._dataAdapter.formats().y,o=void 0!==t&&a?r._dataAdapter.formats().y[t]:r._dataAdapter.formats().y;return"time"===o&&(e||(e=this._getEnabledValues("y")),n=r._yTimeGranularity(e,i.guide.axis().ticks()())),function(t){return t?(n&&n.divisor>0&&(t/=n.divisor),r._formatNumber(o,t)):""}},a._yTimeGranularity=function(t,e){t=t&&t.filter(function(t){return isFinite(t)})||[];var n=Math.max.apply(null,t),i=Math.min.apply(null,t),a=r.scale.linear().domain([i,n]).ticks(e),o=a.length>1?a[1]-a[0]:n-a[0],s=1e3*(o/a.length),l=this._dataAdapter.getTimeGranularity(s);return{gran:l.gran,divisor:l.divisor/1e3}},a._xTickAnchor=function(t){return function(e){var n=t.getTrainedScale("x"),r=i.util.scaleRange(n),a=20,o=n.mapValue(e)+n.rangeBand()/2;return a>o-r[0]?"start":a>r[1]-o?"end":"middle"}},a._checkNormalized=function(){var t=this._chart,e=this._dataAdapter.l10n;this._isNormalized&&this._isNormalized()&&(t.guide("y","none",1),t.guide("y",i.guide.axis().ticks(0).tickFormat(function(){return""}).title(e.labels.normalized)),t.padding({}))},a._formatTime=function(t,e,n){for(var i=this._dataAdapter.l10n.calendar,a={a:function(t){return i.weekdayAbbreviations[t.getDay()]},A:function(t){return i.weekdays[t.getDay()]},b:function(t){return i.monthAbbreviations[t.getMonth()]},B:function(t){return i.months[t.getMonth()]},p:function(t){return i.ampm[Math.floor(t.getHours()/12)]}},o="",s=-1,l=0,u=e.length,c=function(){var n=e.substring(l,s);n.length&&(o+=r.time.format(n)(t))};u>++s;)if(37==e.charCodeAt(s)){var h=e.charAt(s+1),d=a[h];d&&(c(),o+=d(t),s++,l=s+1)}return c(),"hour"===n&&0===o.indexOf("0")&&(o=o.slice(1)),o},a._timeGranTemplate=function(t,e){var n;switch(t){case"hour":n=e.hour;break;case"day":n=e.day;break;case"week":n=e.week;break;case"month":n=e.month;break;case"quarter":n=e.quarter;break;case"year":n=e.year;break;default:n=e.fallback}return n},a._timeXTickFormat=function(){var t=this,e=(t._options,this._chart,t._dataAdapter),n=new Date(0),i="",r="",a=e.l10n.dateFormat,o=a.mediumFormat,s=e?e.dateGranularity():"*",l=this._timeGranTemplate(s,a.shortFormat);return function(e,a){var u,c,h,d;return 0===a&&(n=new Date(0)),"hour"===s&&n.getDate()!==e.getDate()&&(u=o.day),"day"!==s&&"week"!==s||n.getMonth()===e.getMonth()||(u=o.month),"month"!==s&&"quarter"!==s||n.getYear()===e.getYear()||(u=o.year),n=e,c=t._formatTime(e,l,s),u&&(h="<br/>"+t._formatTime(e,u)),d=c!==i||h!==r&&h?h?c+h:c:"",i=c,r=h,d}},t.cloudViz.dvcore=a}(this),function(t){"use strict";var e,n=[],i=function(t,e){var n=-1;return function(){n>-1&&window.clearTimeout(n),n=window.setTimeout(t,e)}},r=i(function(){n.forEach(function(t){t()})},30),a=function(t){-1==n.indexOf(t)&&n.push(t),e||(window.addEventListener("resize",r),e=!0)},o=function(t){var i=n.indexOf(t);i>-1&&n.splice(i,1),0===n.length&&e&&(window.removeEventListener("resize",r),e=!1)};t.cloudViz.windowResize={addHandler:a,removeHandler:o}}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.dvcore||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.init=function(t){return this._type="line",this._chart=i.chart(),this._displayPoints=null,this._adjustClipHeight=6,this._adjustClipWidth=6,this._minTrendTickSpace=80,this._minLineTickSpace=30,this._showRibbons=!1,this._uniqueGroups=null,this._initDefaultOptions(),this.setOptions(t),this},a._initDefaultOptions=function(){var t={filled:!1,position:"identity",forceZero:null,dualYAxis:!1,showAnomalies:!1,mappings:{x:"date",y:"value",group:"series",fill:"series",stroke:"series",label:"label",upperRangeBand:"upper",lowerRangeBand:"lower",forecast:"forecast"}};return Object.getPrototypeOf(a)._initDefaultOptions.call(this,t)},a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments);var t=this._options,e=r.select(t.parent);e.selectAll(".behavior").text(""),e.selectAll(".behavior-under-geom").text(""),this._chart.on("mousemove.inspector",null),this._chart.on("mouseout.inspector",null),e.selectAll(".axis-y.axis-index-1").remove()},a._setChartTypeOptions=function(){var t=this._chart,e=this._options,n=this,a=[i.geom.line().each("start",function(t){r.select(this).attr("legend-group",t[0].stroke)}).map("stroke",this._getPropMapping("stroke"),i.scale.color().values(e.colors))];this._uniqueGroups=i.util.uniq(t.data()[this._getPropMapping("group")]),this._showRibbons=1==this._uniqueGroups.length&&this._isMappedAndExistsInData("upperRangeBand")&&this._isMappedAndExistsInData("lowerRangeBand"),this._showRibbons&&(a.unshift(i.geom.ribbon().map("yMin",this._getPropMapping("lowerRangeBand")).map("yMax",this._getPropMapping("upperRangeBand")).set("alpha",.15).interpolate("cardinal")),e.filled=!1),this._isMappedAndExistsInData("forecast")&&a.push(i.geom.line().map("y",this._getPropMapping("forecast")).set("alpha",.5).set("linetype","dotted").interpolate("cardinal")),e.filled&&a.push(i.geom.area().baseline(void 0).each("start",function(t){r.select(this).attr("legend-group",t[0].fill)}).map("fill",this._getPropMapping("fill"),i.scale.color().values(e.colors)).set("alpha",.2));var o=i.geom.point().map("stroke",this._getPropMapping("stroke"),i.scale.color().values(e.colors)).set("fill","#fff").set("size",7);a.push(o),t.layers(a).guide("stroke",this._buildLegend("line","stroke")).map("group",this._getPropMapping("group")).set("linetype",function(t){return/::incomplete::$/.test(t.data.rsgroup)?"0,4,7,0":"solid"}).position(e.position),o.each("start",function(t){r.select(this).classed("point-hidden",!n._shouldDisplayPoint.call(n,t)).attr("legend-group",t.stroke).classed("line-point",!0)}),this._addBehaviors(t,e),this._mapPositionScales(t,e)},a._shouldDisplayPoint=function(t){return this._showRibbons?this._isAnomalousDataPoint(t):this._shouldDisplayPoints()},a._shouldDisplayPoints=function(){if(null!==this._displayPoints)return this._displayPoints;var t=this._options,e=this._chart,n=e.layers()[0]._nestData,i=Math.max.apply(null,n.map(function(t){return t.values.length})),r=e.getTrainedScale("x").range();return this._displayPoints=t.showAnomalies&&this._showRibbons||(r[1]-r[0])/i>=60},a._isAnomalousDataPoint=function(t){return t.data[this._getPropMapping("y")]>t.data[this._getPropMapping("upperRangeBand")]||t.data[this._getPropMapping("y")]<t.data[this._getPropMapping("lowerRangeBand")]},a._addBehaviors=function(t,e){var n=this,a=r.select(e.parent),o=this._dataAdapter;!this._isSmallChart()&&e.interactive&&t.behaviors([i.behavior.inspector().gutterPadding(0).orientation("bottom").thickness(2).label(function(t){if(o.isOvertime()){var e=o.dateGranularity(),i=o.l10n.dateFormat.fullFormat;
return n._formatTime(t,n._timeGranTemplate(e,i),e)}return n._formatNumber(o.formats().x,t)}).inspectorMove(function(e,i,r,o){var s=t.getTrainedScale("stroke")[0];n._highlightHoveredPoints.call(n,a,o,s),a.selectAll(".axis-x .axis-label").style("opacity",0),a.selectAll(".axis-x-title").style("opacity",0)}).inspectorOut(function(){var e=t.getTrainedScale("stroke")[0];n._highlightHoveredPoints.call(n,a,null,e),a.selectAll(".axis-x .axis-label").style("opacity",1),a.selectAll(".axis-x-title").style("opacity",1)}).underGeoms(!0)])},a._highlightHoveredPoints=function(t,e,n){var a={},o=this;t.selectAll(".line-point").each(function(t){var i=r.select(this),s=n.mapValue(t.stroke),l=o._dataValuesEqual.call(o,t.x,e),u=i.datum();i.classed("point-hidden",l?!1:!o._shouldDisplayPoint.call(o,t)),i.style("fill",l?s:"#FFF").style("opacity",l?1:""),l&&(a[i.attr("legend-group")]={yVal:u.y,scaleIndex:u["y-index"]?u["y-index"]:0})}),t.selectAll(".cv-legend-entry").each(function(t){var e=a[t],n=r.select(this).select(".cv-legend-num");if(!e||!a[t])return n.text("");var s,l=o._dataAdapter.formats().y[e.scaleIndex],u=a[t].yVal;if("time"===l){var c=o._dataAdapter.l10n,h=o._yTimeGranularity(o._dataAdapter.getUniqueStrokeExtentByStroke(t),i.guide.axis().ticks()()),d=c.time[h.gran+"s"],p=c.labels.legendTime;h&&h.divisor>0&&(u/=h.divisor),s=p.replace(/\{time\}/i,d).replace(/\{value\}/i,o._formatNumber(l,u))}else s=o._formatNumber(l,u);n.text(s)})},a._dataValuesEqual=function(t,e){return t&&e?this._dataAdapter.isOvertime()&&t.getTime()===e.getTime()?!0:t===e:!1},a._mapPositionScales=function(t,e){var n=[0,this._isSmallChart()?24:6],r=this._constructScale("y").rangePadding(n),a=this._getPropMapping("stroke"),o=this._getPropMapping("y"),s=this._getPropMapping("x"),l=this;if(null===l._dataAdapter._forceZero&&e.filled&&(l._dataAdapter._forceZero=!0,this._applyForceZero(r)),!e.dualYAxis||"identity"!==e.position&&"dodge"!==e.position){var u=t.getExplicitScalesMap().y;u&&delete u[1]}else{var c=l._dataAdapter.uniqueStrokeValues();c.forEach(function(e,n){var i=0===n?r:r.copy();i.includeInDomain(function(t){return t.data[a]===l._dataAdapter.uniqueStrokeValues()[n]}),n>0&&t.map("y",o,i,n)})}var h=this._dataAdapter.isOvertime()?i.scale.time():i.scale.linear();this._isSmallChart()||h.rangePadding([10,10]),t.map("y",o,r,0),t.map("x",s,this._constructScale("x",h))},a._xTickFormat=function(){var t=this,e=this._dataAdapter.formats().x;return function(n){return t._formatNumber(e,n)}},a._drawSmall=function(){var t=this._options,e=this._chart,n=this,a=this._computeExtents(),o=r.extent(this._getEnabledValues("x")),s=i.guide.axis().tickSize(0).title(this._dataAdapter.xAxisTitle()).tickDy(a.y.length>1?-26:-8).tickAnchor(function(t,e){return e>0?"end":"start"}),l=i.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()),u=t.dualYAxis||"stack"===t.position&&this._uniqueGroups.length>1;if(!u){var c=[i.geom.point().data(a).set("stroke","none").map("y","y",i.scale.linear()).map("x","x",this._dataAdapter.isOvertime()?i.scale.time():i.scale.linear()).each("start",function(t){r.select(this).attr("legend-group",t.fill)}).map("fill","fill",i.scale.color().values(t.colors)).set("size",6),i.geom.text().data(a).set("stroke","none").map("y","y",i.scale.linear()).map("x","x",this._dataAdapter.isOvertime()?i.scale.time():i.scale.linear()).each("start",function(t){r.select(this).attr("legend-group",t.fill),r.select(this.parentNode.parentNode).classed("no-clip",!0).attr("clip-path",null)}).map("fill","fill",i.scale.color().values(t.colors)).set("size","11px").set("label",function(t){var e=n._yTickFormat(0)(t.y);if("time"===n._dataAdapter.formats().y[0]){var r=n._yTimeGranularity(n._getEnabledValues("y"),i.guide.axis().ticks()());e+=" "+n._dataAdapter.l10n.time[r.gran+"s"]}return e}).textAnchor(function(t){return t.data&&t.data.anchor||"middle"}).dy(function(t){return 1===a.y.length||t.y===a.y[1]?-8:15}).dx(function(t){return t.data&&"end"==t.data.anchor?3:0})];e.layers(e.layers().concat(c))}if(e.map("fill",this._getPropMapping("fill"),i.scale.color().values(t.colors)),this._dataAdapter.isOvertime())s.tickValues(o).tickFormat(r.time.format("%x")),u?l.tickFormat(this._yTickFormat(0)):l.tickFormat(function(){return""});else if(t.dualYAxis){var h=i.guide.axis().tickFormat(this._yTickFormat(1)).orientation("right").tickSize(15).tickDy(-8).tickAnchor("end").tickDx(4).ticks(3);l.tickSize(15).tickDy(-8).tickAnchor("start").tickDx(4).ticks(3),e.guide("y",h,1)}else{var d=r.extent(this._dataAdapter.data()[this._getPropMapping("x")]);s.tickValues(d).tickFormat(this._xTickFormat()),l.tickFormat(this._yTickFormat(0)),e.guide("y","none",1)}e.guide("x",s).guide("y",l),this._checkNormalized()},a._drawLarge=function(){var t,e=this._options,n=this._chart,a=this,o=(r.select(e.parent),n._data[this._getPropMapping("x")].length),s=!1,l=a._dataAdapter.getUniqueStrokeExtent(0),u=a._dataAdapter.getUniqueStrokeExtent(1),c=function(t){var e=t/o,n=a._dataAdapter.isOvertime()?a._minTrendTickSpace:a._minLineTickSpace;return n>e&&(e=n),Math.max(Math.min(Math.floor(t/e),o),2)},h=i.guide.axis().ticks(c).title(this._dataAdapter.xAxisTitle()).tickDy(-8).tickAnchor(this._xTickAnchor(n)),d=i.guide.axis().htmlLabels(!0);if(this._dataAdapter.isOvertime()?h.tickFormat(this._timeXTickFormat()).htmlLabels(!0):h.tickFormat(this._xTickFormat()),!e.dualYAxis||"identity"!==e.position&&"dodge"!==e.position)t=this._yTickFormat(0),d.title(this._yTitleFormat(0)),n.guide("y","none",1);else{t=this._yTickFormat(0,l),d.title(this._yTitleFormat(0,l));var p=i.guide.axis().tickFormat(this._yTickFormat(1,u)).title(this._yTitleFormat(1,u)).orientation("right").tickSize(15);d.tickSize(15),n.guide("y",p,1)}d.tickFormat(function(n,a){var o=r.select(this),l=d._scale();if(l instanceof i.scale.linear&&n>0&&(0===a||1===a&&s)){if(!(l.mapValue(n)<l.range()[0]-10)&&e.interactive)return s=!0,o.classed("arrow-container",!1),"";o.classed("arrow-container",!0)}else o.classed("arrow-container",!1);return t.call(this,n,a)}),n.guide("x",h).guide("y",d),this._checkNormalized()},a._preRender=function(){Object.getPrototypeOf(a)._preRender.call(this),this._displayPoints=null},a._computeExtents=function(){var t=-1,e=this._options,n=this._getEnabledValues("y"),i=this._getEnabledValues("x"),r=this._getEnabledValues("stroke"),a=n.length,o={x:[void 0,void 0],y:[void 0,void 0],fill:[void 0,void 0],anchor:[void 0,void 0]},s=null,l=null;for(i.forEach(function(t){s=null===s||s>t?t:s,l=null===l||t>l?t:l});a>++t;){var u=n[t],c=i[t],h=r?r[t]:e.colors[0];(void 0===o.y[0]||o.y[0]>u)&&(o.y[0]=u,o.x[0]=c,o.fill[0]=h,o.anchor[0]=+c==+s?"start":+c==+l?"end":"middle"),(void 0===o.y[1]||u>o.y[1])&&(o.y[1]=u,o.x[1]=c,o.fill[1]=h,o.anchor[1]=+c==+s?"start":+c==+l?"end":"middle")}return 0===o.y[0]&&(o.y.splice(0,1),o.x.splice(0,1),o.fill.splice(0,1),o.anchor.splice(0,1)),o},a._isNormalized=function(){var t=this._options,e=this._isSmallChart()?1:2;return t.dualYAxis&&this._dataAdapter.uniqueStrokeValues().length>e&&("identity"===t.position||"dodge"===t.position)},t.cloudViz.line=e.util.createConstructor(a)}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.dvcore||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.init=function(t){return this._type="point",this._chart=i.chart(),this._initDefaultOptions(),this.setOptions(t),this},a._setChartTypeOptions=function(){var t=this._chart,e=this._options,n=[];n[0]=i.geom.point().each("start",function(t){r.select(this).attr("legend-group",t.fill)}),t.layers(n).map("x",this._getPropMapping("x"),this._constructScale("x").rangePadding([this._isSmallChart()?10:20,this._isSmallChart()?10:20])).map("y",this._getPropMapping("y"),this._constructScale("y").rangePadding([this._isSmallChart()?10:20,this._isSmallChart()?10:20])).map("fill",this._getPropMapping("fill"),i.scale.color().values(e.colors)).guide("fill",this._buildLegend("point","fill")).padding({left:10});var a=this._getPropMapping("size");a?n[0].map("size",a,i.scale.linear().to([9,60])):n[0].set("size",10).set("alpha",.6),this._addBehaviors(n[0],e)},a._addBehaviors=function(t,e){var n,a=r.select(e.parent),o=this._dataAdapter.sizeMetricName(),s=function(t,e,n){return t.data.hasOwnProperty(e.mapping())?'<span class="metric-value">'+n(t.data[e.mapping()])+'</span><span class="metric-name">'+e.mapping()+"</span>":""};!this._isSmallChart()&&e.interactive&&t.behaviors([i.behavior.voronoiRollover().pointDetectionRadius(25).content(function(t){var e=this.__geom.getExplicitScale("group"),n=t.panel.xScale(t),i=t.panel.yScale(t),r=this._xGuides[n.scaleIndex()],a=this._yGuides[i.scaleIndex()],l=r.__scale&&r.tickFormat()?r.tickFormat():String,u=a.__scale&&a.tickFormat()?a.tickFormat():String,c=s(t,i,u)+s(t,n,l);if(o){var h=t.panel.getTrainedScale("size")[0];c+=s(t,h,String)}return e&&e.mapping()&&(c='<span class="series-name">'+t.data[e.mapping()]+"</span>"+c),c}).mouseOver(function(t){clearTimeout(n),a.selectAll(".point-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(e){return t!==e}),a.selectAll(".cv-legend-marker").classed("unselected",function(e){return e!==t.fill}).classed("cv-medium-duration",!1)}).mouseOut(function(){n=setTimeout(function(){a.selectAll(".point-geom").classed("cv-unselected",!1).classed("cv-medium-duration",!0),a.selectAll(".cv-legend-marker").classed("unselected",!1).classed("cv-medium-duration",!0)},400)})])},a._drawSmall=function(){var t=this._chart,e=r.extent(this._getEnabledValues("x")),n=this;t.guide("x",i.guide.axis().tickSize(0).tickValues(e).title(this._dataAdapter.xAxisTitle()).tickFormat(function(t){return n._formatNumber(n._dataAdapter.formats().x,t)}).tickAnchor(function(t,e){return e>0?"end":"start"})).guide("y",i.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()).tickDy(-8).tickFormat(function(t){return t?n._formatNumber(n._dataAdapter.formats().y,t):""}))},a._drawLarge=function(){var t=this._chart,e=function(t){return Math.max(t/120,2)},n=function(t){return Math.max(2,Math.min(5,t/70))},r=this;t.guide("x",i.guide.axis().ticks(e).title(this._dataAdapter.xAxisTitle()).tickFormat(function(t){return r._formatNumber(r._dataAdapter.formats().x,t)})).guide("y",i.guide.axis().ticks(n).title(this._dataAdapter.yAxisTitle()).tickDy(-8).tickFormat(function(t){return t?r._formatNumber(r._dataAdapter.formats().y,t):""}))},a._postRender=function(){Object.getPrototypeOf(a)._postRender.call(this);var t=this._options,e=this._chart,n=5,i=r.select(t.parent).select(".cv-wrapper"),o=i.selectAll(".cv-bubble-size-metric").data([0]);this._dataAdapter.sizeMetricName()?(o.enter().append("div").classed("cv-bubble-size-metric",!0).html("<span>"+this._dataAdapter.sizeMetricName()+"</span>  <i></i> &ndash; <i></i>"),setTimeout(function(){var t=e.padding(),i=e.facet().getPanel(e.facet()._panels.length-1).bounds(),r=e.plotBounds(),a=(o.selectAll("span"),r.right+t.right),s=i.top+i.height,l=a-o.node().offsetWidth-n,u=s-o.node().offsetHeight;o.style("top",u+"px").style("left",l+"px")},300)):o.remove()},t.cloudViz.point=e.util.createConstructor(a)}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.dvcore||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.init=function(t){return this._type="bar",this._chart=i.chart(),this._initDefaultOptions(),this.setOptions(t),this._minTickSpace=60,this},a._initDefaultOptions=function(){var t={position:"dodge",dualYAxis:!1,clickHandler:null};return Object.getPrototypeOf(a)._initDefaultOptions.call(this,t)},a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments);var t=this._options,e=r.select(t.parent);e.selectAll(".axis-y.axis-index-1").remove()},a._setChartTypeOptions=function(){var t=this._chart,e=this._options;t.layers([i.geom.bar().each("start",function(t){r.select(this).attr("legend-group",t.fill)})]).map("fill",this._getPropMapping("label"),i.scale.color().values(e.colors)).guide("fill",this._buildLegend("bar","label")).position(e.position).coord(i.coord.cartesian().flip(e.flip)),e.clickHandler?t._layers[0].on("click",e.clickHandler):t._layers[0].on("click",null),this._addBehaviors(t.layers()[0],e),this._mapPositionScales(t,e)},a._mapPositionScales=function(t,e){var n=this._isSmallChart(),r=[0,n?10:15],a=this._applyForceZero(this._constructScale("y")).rangePadding(r),o=this._getPropMapping("label"),s=this._getPropMapping("y"),l=(this._getPropMapping("x"),n?.8:Math.min(.6,Math.max(.05,this._getChartWidth()/4e3))),u=n?0:.5,c=this;if(!e.dualYAxis||"identity"!==this._options.position&&"dodge"!==this._options.position){var h=t.getExplicitScalesMap().y;h&&delete h[1]}else{var d=c._dataAdapter.uniqueFillValues();d.forEach(function(e,n){var i=0===n?a:a.copy();i.includeInDomain(function(t){return t.data[o]===c._dataAdapter.uniqueFillValues()[n]}),n>0&&t.map("y",s,i,n)})}t.map("y",s,a,0),t.map("x",this._getPropMapping("x"),i.scale.ordinal().padding(l).outerPadding(u).reverse(e.flip))},a._addBehaviors=function(t,e){var n,a=r.select(e.parent),o=this;!this._isSmallChart()&&e.interactive&&t.behaviors([i.behavior.rollover().content(function(t){var e=this.__geom.getExplicitScale("group"),n=t.panel.xScale(t),r=t.panel.yScale(t),a=this._xGuides[n.scaleIndex()],s=this._yGuides[r.scaleIndex()],l=t.hasOwnProperty("y-index")?t["y-index"]:0,u=o._dataAdapter.l10n,c=o._dataAdapter.formats().y[l],h=o._dataAdapter.getUniqueFillExtentByFill(t.fill)||o._getEnabledValues("y"),d="time"===c?u.time[o._yTimeGranularity(h,i.guide.axis().ticks()()).gran+"s"]:"",p=(a.__scale&&a.tickFormat()?a.tickFormat():String,s.__scale&&s.tickFormat()?s.tickFormat():String),f='<span class="metric-value">'+p(t.y)+" "+d+'</span><span class="metric-name">'+t.data[e.mapping()]+"</span>",g=o._dataAdapter.dateGranularity(),m=u.dateFormat.fullFormat,v=i.util.isDate(t.x)?o._formatTime(t.x,o._timeGranTemplate(g,m),g):t.x;return e&&e.mapping()&&(f='<span class="series-name">'+v+"</span>"+f),f}).showTooltip(function(t,e,i,o,s){var l=r.select(this);l.classed("path-inactive")||(s._showTip.call(this,t,e,i,s),clearTimeout(n),a.selectAll(".bar-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(e){return t!==e}),a.selectAll(".cv-legend-marker").classed("unselected",function(e){return e!==t.fill}).classed("cv-medium-duration",!1))}).hideTooltip(function(t,e,i,o,s){var l=r.select(this);l.classed("path-inactive")||(s._removeTip.call(this,t,e,i,s),n=setTimeout(function(){a.selectAll(".bar-geom").classed("cv-unselected",!1).classed("cv-medium-duration",!0),a.selectAll(".cv-legend-marker").classed("unselected",!1).classed("cv-medium-duration",!0)},400))})])},a._drawSmall=function(){var t,e=this._chart,n=this._options,a=n.flip?void 0:10,o=this;t=n.flip?i.guide.axis().tickDx(function(){return r.select(this).select("span").node().offsetWidth}).tickDy(function(){return-r.select(this).select("span").node().offsetHeight}).tickSize(0):i.guide.axis().tickSize(0).tickDy(function(t,e){return 0===e%2?-8:-26}),this._dataAdapter.isOvertime()?t.tickValues(r.extent(this._dataAdapter.data()[this._getPropMapping("x")])).tickFormat(r.time.format("%x")).tickAnchor(function(t,e){return e>0?"end":"start"}).tickDy(-8):t.tickFormat(function(t){return o._truncateLabel(t,a)}),e.guide("x",t.title(this._dataAdapter.xAxisTitle())).guide("y",i.guide.axis().ticks(0).tickSize(0).tickFormat(function(){return""}).title(this._dataAdapter.yAxisTitle())),this._checkNormalized()},a._drawLarge=function(){var t,e=this._chart,n=this._options,r=this,a=function(t){return Math.max(2,Math.min(5,t/75))},o=i.guide.axis().tickSize(0),s=i.guide.axis().ticks(a);if(!n.dualYAxis||"identity"!==this._options.position&&"dodge"!==this._options.position)s.tickFormat(this._yTickFormat(0)).title(this._yTitleFormat(0)),e.guide("y","none",1);else{var l=r._dataAdapter.getUniqueFillExtent(0),u=r._dataAdapter.getUniqueFillExtent(1);s.tickSize(15).tickFormat(this._yTickFormat(0,l)).title(this._yTitleFormat(0,l)),t=i.guide.axis().ticks(a).tickFormat(this._yTickFormat(1,u)).title(this._yTitleFormat(1,u)).orientation("right").tickSize(15),e.guide("y",t,1)}if(n.flip?o.tickDx(-10):(o.tickDy(function(t,e){return 0===e%2?-8:-26}),s.tickDx(-10),t&&t.tickDx(-10)),this._dataAdapter.isOvertime()){var c={},h=0;e._data[this._getPropMapping("x")].forEach(function(t){c[+t]||(h++,c[+t]=1)}),o.tickDy(-8).tickFormat(this._timeXTickFormat(h)).htmlLabels(!0)}else o.tickFormat(function(t){return r._truncateLabel(t)});e.guide("x",o.title(this._dataAdapter.xAxisTitle())).guide("y",s),this._checkNormalized()},a._determineTickMod=function(t,e){var n=t.getTrainedScale("x"),r=i.util.scaleRange(n),a=r[1]-r[0];return Math.ceil(this._minTickSpace/(a/e))},a._timeXTickFormat=function(t){var e=this,n=this._chart,i=e._dataAdapter,r=new Date(0),a="",o="",s=i.l10n.dateFormat,l=s.mediumFormat,u=i?i.dateGranularity():"*",c=this._timeGranTemplate(u,s.shortFormat),h=null;return function(i,s){var d,p,f,g;0===s&&(r=new Date(0)),h||(h=e._determineTickMod(n,t));var m=0===s%h;return m?("hour"===u&&r.getDate()!==i.getDate()&&(d=l.day),"day"!==u&&"week"!==u||r.getMonth()===i.getMonth()||(d=l.month),"month"!==u&&"quarter"!==u||r.getYear()===i.getYear()||(d=l.year),r=i,p=e._formatTime(i,c,u),d&&(f="<br/>"+e._formatTime(i,d)),g=p!==a||f!==o&&f?f?p+f:p:"",a=p,o=f,g):""}},a._isNormalized=function(){var t=this._options,e=this._isSmallChart()?1:2;return t.dualYAxis&&this._dataAdapter.uniqueFillValues().length>e&&("identity"===t.position||"dodge"===t.position)},t.cloudViz.bar=e.util.createConstructor(a)}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.dvcore||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.init=function(t){return this._type="donut",this._chart=i.chart(),this._totalFacets=3,this._sliceLabelDecimal=1,this._initDefaultOptions(),this.setOptions(t),this},a._initDefaultOptions=function(){var t={maxSlices:6,innerRadius:"50%",outerRadius:"25%",clickHandler:null};return Object.getPrototypeOf(a)._initDefaultOptions.call(this,t)},a._preRender=function(){Object.getPrototypeOf(a)._preRender.call(this),"data"in this._changedOptions&&this._updateDataMappings()},a._mungeData=function(t,e,n){var i,r,a,o=this._options.data,s=[],l=o[t].length,u=[],c={};for(i=0;l>i;++i){s[i]={};for(r in o){if(a=o[r][i],r===e)if(u.length){if(a!==u[u.length-1]){if(u.length===this._totalFacets){l--,i--,s.pop();break}u[u.length]=a,c[a]=u.length}}else u=[a],c[a]=u.length;s[i][r]=a}}this.numFacets=u.length,s.sort(function(n,i){return n[e]===i[e]?i[t]-n[t]:c[n[e]]-c[i[e]]});for(r in o)o[r]=[];o.cvdonutorder=[];var h,d,p=0,f=this._options.maxSlices;for(this._otherIncluded=!1,i=0,l=s.length;l>i;++i)if(d=s[i][e],d!==h&&(p=0,h=d),p==f-1&&l>i+1&&s[i+1][e]===d){for(r in o)o[r]||(o[r]=[]),o[r][i]=s[i][r];this._otherIncluded=!0,o[n][i]="Other",++p,o.cvdonutorder[i]=i}else if(p>=f)o[t][i-1]+=s[i][t],s.splice(i,1),l=s.length,--i,++p;else{++p;for(r in o)o[r][i]=s[i][r];o.cvdonutorder[i]=i}},a._updateDataMappings=function(){var t=this._options.data,e=t[this._getPropMapping("label")],n=t[this._getPropMapping("y")];e&&e.length&&n&&n.length&&(this._mungeData(this._getPropMapping("y"),this._getPropMapping("label"),this._getPropMapping("x")),this._updateLabelsData())},a._updateLabelsData=function(){var t=this._options.data,e={},n={},i=this,r=t[this._getPropMapping("label")],a=t[this._getPropMapping("y")],o=t[this._getPropMapping("x")],s=null;null!==i._legendStates&&i._valuesAreFilterable()&&(s={},i._legendStates.forEach(function(t){s[t.name]=t.enabled})),r.forEach(function(t,i){void 0===e[t]&&(e[t]=0),void 0===n[t]&&(n[t]=0),e[t]+=a[i],s&&1!==s[o[i]]||(n[t]+=a[i])});var l,u,c,h,d=t.cvtextvalue=[],p=t.cvtextperclabel=[],f=t.cvtextvallabel=[],g={};a.forEach(function(a,m){var v=null;t.metric&&t.metric[m]&&(v=t.metric[m].type),l=r[m],u=100*(parseFloat(a)/e[l]),f[m]=i._formatNumber(v,a),p[m]=(0!==u%1?u.toFixed(i._sliceLabelDecimal):u)+"%",h=!s||1===s[o[m]],c=100*(parseFloat(a)/n[l]),void 0===g[l]&&(g[l]=0),d[m]=h?g[l]+c/2:0,g[l]+=h?c:0})},a._getLabelTotal=function(t){var e,n,i=this._options.data,r=i[this._getPropMapping("y")],a=i[this._getPropMapping("label")],o=a.length,s=0;for(e=0;o>e;++e)a[e]===t&&(s+=r[e],i.metric&&i.metric[e]&&(n=i.metric[e].type));return this._formatNumber(n,s)},a._getCategoryTotal=function(t){var e,n,i=this._options.data,r=i[this._getPropMapping("y")],a=i[this._getPropMapping("x")],o=a.length,s=0;for(e=0;o>e;++e)a[e]===t&&(s+=r[e],i.metric&&i.metric[e]&&(n=i.metric[e].type));return this._formatNumber(n,s)},a._shouldHideLabels=function(){return this._isSmallChart()&&this.numFacets>1},a._setChartTypeOptions=function(){var t=this._chart,e=this._options,n=this,a=e.colors.slice(0);this._otherIncluded&&a.splice(e.maxSlices-1,0,"#ccc");var o=[i.geom.bar().position("fill").set("stroke","#fff").each("start",function(t){r.select(this).attr("legend-group",t.fill)})];e.clickHandler&&o[0].on("click",e.clickHandler),this._shouldHideLabels()||(this._updateLabelsData(),o.push(i.geom.text().map("y","cvtextvalue",i.scale.linear().lowerLimit(0).upperLimit(100)).map("label","cvtextperclabel").set("stroke","none").map("fill",this._getPropMapping("x"),i.scale.color().values(a)).textAnchor(function(t){var e=t.y;return e>95||5>e?"middle":45>e?"start":e>55?"end":"middle"}).each("start",function(t){r.select(this).classed("slice-label",!0).attr("legend-group",t.fill)}).dx(function(t){var n=t.panel.xOuterScale().range(),r=Math.abs(n[1]-n[0])/2,a=i.util.getPercentValue(e.outerRadius,r),o=r+a;return t.y>=35&&65>=t.y&&(o+=120),o})));var s=this._buildLegend("donut","x");1!=this.numFacets||e.interactive||s.values(e.data.cvtextvallabel),t.layers(o).map("group","cvdonutorder").map("x",this._getPropMapping("label"),i.scale.ordinal()).map("y",this._getPropMapping("y"),this._constructScale("y")).map("fill",this._getPropMapping("x"),i.scale.color().values(a)).guide("fill",s).guide(["x","y"],"none").coord(i.coord.polar().innerRadius(e.innerRadius).outerRadius(e.outerRadius)).postrender(function(){var t=r.select(e.parent).select(".cv-wrapper"),a=t.selectAll(".cv-donut-facet-labels").data([0]);a.enter().append("div").classed("cv-donut-facet-labels",!0),a.exit().remove();var o=a.selectAll(".cv-donut-facet-label").data(this.facet()._panels);o.enter().append("div").classed("cv-donut-facet-label",!0),o.each(function(t){var a=n._shouldHideLabels(),o=t.bounds(),s=r.select(this),l=t.xOuterScale().range(),u=Math.abs(l[1]-l[0])/2,c=i.util.getPercentValue(e.innerRadius,u),h=2*c,d=o.left+o.width/2-h/2,p=a?o.top-10:o.top+o.height/2-27;s.style("top",p+"px").style("left",d+"px").style("width",h+"px").classed("cv-donut-small-facet",a);var f=s.selectAll(".cv-donut-label-number").data([0]);f.enter().append("div").classed("cv-donut-label-number",!0),f.text(n._getLabelTotal(t.xFacetTitle()));var g=s.selectAll(".cv-donut-label-title").data([0]);g.enter().append("div").classed("cv-donut-label-title",!0),g.text(t.xFacetTitle())}),o.exit().remove()}),this._addBehaviors(o[0],e)},a._addBehaviors=function(t,e){var n,a=r.select(e.parent);!this._isSmallChart()&&e.interactive&&t.behaviors([i.behavior.rollover().content(function(t){var e=this.__geom.getExplicitScale("group"),n=t.panel.xScale(t),i=t.panel.yScale(t),r=this._xGuides[n.scaleIndex()],a=this._yGuides[i.scaleIndex()],o=(r.__scale&&r.tickFormat()?r.tickFormat():String,a.__scale&&a.tickFormat()?a.tickFormat():String,'<span class="metric-value">'+t.data.cvtextvallabel+'</span><span class="metric-name">'+t.x+"</span>");return e&&e.mapping()&&(o='<span class="series-name">'+t.fill+"</span>"+o),o}).showTooltip(function(t,e,i,o,s){var l=r.select(this);l.classed("path-inactive")||(s._showTip.call(this,t,e,i,s),clearTimeout(n),a.selectAll(".bar-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(e){return t!==e}),a.selectAll(".text-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(e){return t.group!==e.group}),a.selectAll(".cv-legend-marker").classed("unselected",function(e){return e!==t.fill}).classed("cv-medium-duration",!1))}).hideTooltip(function(t,e,i,o,s){var l=r.select(this);l.classed("path-inactive")||(s._removeTip.call(this,t,e,i,s),n=setTimeout(function(){a.selectAll(".bar-geom").classed("cv-unselected",!1).classed("cv-medium-duration",!0),a.selectAll(".text-geom").classed("cv-unselected",!1).classed("cv-medium-duration",!0),a.selectAll(".cv-legend-marker").classed("unselected",!1).classed("cv-medium-duration",!0)},400))})])},a._drawSmall=function(){var t=this._chart,e=this._options;this._shouldHideLabels()&&e.interactive&&t.padding({top:10}),t.facet(i.facet.wrap().group("label").scales("free").numColumns(1).titleFormat(void 0))},a._drawLarge=function(){var t=this._chart;this._options,t.facet(i.facet.wrap().group("label").scales("free").numColumns(3).titleFormat(void 0))},t.cloudViz.donut=e.util.createConstructor(a)}(this),function(){"use strict";d3.anomaly=function(){function t(t,e){for(var n in e)t[n]=e[n];return t}function e(){var t=X.append("g").classed("temp-axis",!0);y(t,$[0],$[1]),D=n(t),I=$[0]-D.left-D.right,R=$[1]-D.top-D.bottom,t.remove()}function n(t){var e=t.node().getBBox(),n=Math.abs(e.x),i=Math.abs(e.y);return{left:n,top:i,right:e.width-$[0]-n,bottom:e.height-$[1]-i}}function i(){var t=r(E,function(t){return Date.parse(t[Y])},[C,V]),e=r(E,function(t){return t[W]});ae.domain(t);var n=ae.ticks(ie,z),i=+n[1]-+n[0];t[1]=i+ +n[n.length-1],t[0]=+n[0]>t[0]?+n[0]-i:t[0],ae.domain(t),q=ae.ticks(ie,z);var a=Math.max(Math.abs(e[0]),Math.abs(e[1]));ee?(oe.domain([0,a]),N=d3.scale.linear().domain([-a,a])):(oe.domain([-a,a]),N=d3.scale.linear().domain(oe.domain())),N.domain([0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1].map(N.invert)),N.range(["#3C476F","#485485","#53659C","#6C7CAF","#99A2BC","#C5C5C5","#ACC997","#90C867","#7CBC4B","#6FA744","#64913E"])}function r(t,e,n){var i=[];return 3>arguments.length||void 0===n[0]&&void 0===n[1]?i=d3.extent(t,e):(i[0]=void 0===n[0]?d3.min(t,e):n[0],i[1]=void 0===n[1]?d3.max(t,e):n[1]),i}function a(){j=d3.svg.brush().x(ae).y(oe).on("brushstart",o).on("brush",s).on("brushend",l)}function o(){u()}function s(){X.selectAll(".extent").style("opacity",1),u()}function l(){X.selectAll(".extent").style("opacity",0),u()}function u(){var t=j.extent(),e={left:Math.min(ae(t[0][0]),ae(t[1][0])),right:Math.max(ae(t[0][0]),ae(t[1][0])),top:Math.min(oe(t[0][1]),oe(t[1][1])),bottom:Math.max(oe(t[0][1]),oe(t[1][1]))},n=X.selectAll(".anom-anomaly").filter(function(t){return h({left:t.bounds.x,right:t.bounds.x+t.bounds.width,top:t.bounds.y,bottom:t.bounds.y+t.bounds.height},e)});J&&c(n[0],J[0])||(J=n,re.select(n))}function c(t,e){if(t.length!=e.length)return!1;for(var n=0,i=t.length;i>n;n++)if(-1===e.indexOf(t[n]))return!1;return!0}function h(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}function d(){U=d3.select(ne);var t=U.selectAll("svg").data([E]);t.enter().append("svg"),t.exit().remove(),t.attr("width",$[0]).attr("height",$[1]);var e=t.selectAll(".anom-container").data([0]);return e.enter().append("g").classed("anom-container",!0),e}function p(){H=oe.ticks(te);var t=H[1]-H[0];H.push(t+H[H.length-1]),ee||H.unshift(H[0]-t),E=f(E),g(E);var e=m(E);return v(H,e),e}function f(t){var e=ae.domain();return t.filter(function(t){var n=new Date(t[Y]);return n>=e[0]&&e[1]>n})}function g(t){t.sort(function(t,e){return t=new Date(t[Y]),e=new Date(e[Y]),e>t?-1:t>e?1:0})}function m(t){return d3.nest().key(function(t){for(var e=Date.parse(t[Y]),n=0,i=-1,r=q.length;r>++i&&!(+q[i]>+e);)n=i;return+q[n]}).entries(t)}function v(t,e){e.forEach(function(e){e.values=d3.layout.histogram().bins(t).value(function(t){return ee?Math.abs(t[W]):t[W]})(e.values),G=e.values[0].dx})}function _(t){var e=new Date(0),n=q.length,i=Math.max(Math.ceil((q.length-1)/(t/70)),1),r=d3.time.format("%b %e, %Y"),a=d3.time.format("%b %e"),o=d3.time.format("%a %e"),s=d3.time.format("%I:%M %p");return function(t,l){var u="";return l===n-1||0!==l%i?"":(0===l||e.getYear()!==t.getYear()?u=r(t):e.getMonth()!==t.getMonth()?u=a(t):e.getDate()!==t.getDate()?u=o(t):e.getHours()!==t.getHours()&&(u=s(t)),e=t,u)}}function y(t,e,n){var i=q.length,r=q.length>1&&ue>=+q[1]-+q[0];ae.rangeRound([0,e]),oe.rangeRound([n,0]);var a=t.selectAll(".anom-axes").data([0]);a.enter().append("g").classed("anom-axes",!0);var o=a.selectAll(".anom-axis").data(["x","y"]);o.enter().append("g").attr("class",function(t){return"anom-"+t+" anom-axis"});var s=a.selectAll(".anom-x").attr("transform","translate(0,"+n+")").call(d3.svg.axis().scale(ae).ticks(ie,z).orient("bottom").tickSize(-n).tickPadding(20).tickFormat(_(e)));s.selectAll("text").style("text-anchor","start"),s.selectAll("line").style("opacity",function(t,e){return e===i-1?0:r&&(6===t.getDay()||1===t.getDay())&&0===t.getHours()&&i-1>e?.3:null});var l=a.selectAll(".anom-y").call(d3.svg.axis().scale(oe).tickValues(H).orient("left").tickSize(-e).tickPadding(10).tickFormat(function(t,e){return 0===e||e===Math.floor(H.length/2)||e===H.length-1?Math.round(1e5*t)/1e5+"%":""}));ee||l.selectAll("line").filter(function(t){return 0===t}).style("stroke-dasharray","4 4").style("opacity",.7)}function x(){var t=Math.round(H.length>1?oe(H[0])-oe(H[1]):R)-1,e=Math.round(P(t))-1,n=X.selectAll(".anom-plot").data([B]);n.enter().append("g").classed("anom-plot",!0),n.exit().remove();var i=n.selectAll(".anom-column").data(function(t){return t});i.enter().append("g").classed("anom-column",!0),i.exit().remove(),i.attr("transform",function(t){return"translate("+ae(+t.key)+",0)"});var r=i.selectAll(".anom-row").data(function(t){return t.values});r.enter().append("g").classed("anom-row",!0),r.exit().remove(),r.attr("transform",function(e,n){return"translate(0,"+(oe(H[n])-t)+")"});var a=r.selectAll(".anom-anomaly").data(function(t){return t}),o=a.enter().append("g").classed("anom-anomaly",!0);a.attr("transform",function(n,i){var r=k(ee?Math.abs(n[W]):n[W]);return n[W]>=0&&(r+=G),n.bounds={x:ae(Date.parse(n[Y]))+(i*(e+le)+le),y:oe(r),width:e,height:t},"translate("+(i*(e+le)+le)+",0)"}),a.exit().remove(),o.append("rect").classed("anom-cell",!0).attr("x",e/2).attr("y",t/2).attr("width",0).attr("height",0),a.selectAll(".anom-cell").attr("fill",function(t){var e=k(ee?Math.abs(t[W]):t[W]);return ee&&0>t[W]&&(e*=-1),N(e)}).transition().duration(500).attr("x",0).attr("y",0).attr("width",e).attr("height",t);var s=o.append("g").classed("anom-select",!0);s.append("path").classed("outer-border",!0),s.append("path").classed("inner-border",!0);var l=a.selectAll(".anom-select");l.select(".outer-border").attr("d",A(0,0,e+.5,t+.5,1)),e>3&&l.select(".inner-border").attr("d",A(0,0,e+1,t+1,2));var u=o.append("rect").classed("anom-hit-area",!0);u.on("mouseover",function(t,e){re.mouseover(this,t,e)}).on("mouseout",function(t,e){re.mouseout(this,t,e)}).on("mousedown",function(){j.clear();var t=d3.mouse(X.node()),e=ae.invert(t[0]),n=oe.invert(t[1]);j.extent([[e,n],[e,n]])}).on("click",function(){re.select(d3.select(this))}).style("cursor","crosshair").style("opacity",0).attr("x",0).attr("y",0).attr("width",e).attr("height",t)}function b(){var t=X.selectAll(".anom-plot").data([0]);t.enter().append("g").classed("anom-plot",!0),t.exit().remove(),t.call(j)}function A(t,e,n,i,r){return"M"+r+","+r+"L"+(n-2*r)+","+r+"L"+(n-2*r)+","+(i-2*r)+"L"+r+","+(i-2*r)+"z"}function k(t){for(var e=-1,n=H.length;n>++e;){if(t>=0&&H[e]+G>t)return H[e];if(0>t&&H[e]+G>t)return H[e]+G}return H[0]}function P(t){var e=(q.length>1?ae(q[1])-ae(q[0]):I)-se,n=S();return L=e/n,L>t?t:L}function S(){var t=0;return B.forEach(function(e){e.values.forEach(function(e){t=Math.max(e.length,t)})}),t}function w(t){if(void 0===K[t])throw new M(t);return K[t]}function M(t){this.type="MappingNotDefinedException",this.message="The mapping for property "+t+" was not defined.",this.toString=function(){return this.type+" - "+this.message}}function T(){this.type="EmptyDataException",this.message="The data is empty or null",this.toString=function(){return this.type+" - "+this.message}}function O(){this.type="ParentNotSpecifiedException",this.message="A p was not specified for this visualization",this.toString=function(){return this.type+" - "+this.message}}var E,D,L,F,z,V,C,N,R,I,B,G,H,j,q,Y,W,U,X,J,Z={},K={x:"date",y:"deviation"},$=[50,25],Q=!0,te=6,ee=!1,ne=null,ie=7,re=d3.dispatch("select","mouseover","mouseout"),ae=d3.time.scale(),oe=d3.scale.linear(),se=8,le=1,ue=864e5;
return d3.rebind(Z,re,"on"),Z.data=function(t){return arguments.length?(E=t,J=null,Z):E},Z.mappings=function(e){return arguments.length?(K=t(K,e),Z):K},Z.xUpperLimit=function(t){return arguments.length?(V=t,Z):V},Z.xLowerLimit=function(t){return arguments.length?(C=t,Z):C},Z.normalizePositive=function(t){return arguments.length?(ee=t,Z):ee},Z.xTicks=function(t,e){if(!arguments.length)return void 0!==e?[ie,z]:this.xTicks;var n=!!(t&&t.constructor&&t.call&&t.apply);return ie=n?d3.functor(t):t,z=n?e:void 0,this},Z.bins=function(t){return arguments.length?(te=t,Z):te},Z.size=function(t){return arguments.length?($=t,Z):$},Z.interactive=function(t){return arguments.length?(Q=t,Z):Q},Z.parent=function(t){return arguments.length?(ne=t,Z):ne},Z.anomalyWidth=function(){return L},Z.anomalyHeight=function(){return F},Z.layout=function(){if(!Z.data()||!Z.data().length)throw new T;if(!Z.parent())throw new O;return Y=w("x"),W=w("y"),i(),a(),X=d(),B=p(),oe.domain([H[0],H[H.length-1]]),e(),X.attr("transform","translate("+D.left+","+D.top+")"),y(X,I,R),b(),x(),Z},Z.nodes=function(t){if(!U)throw Error("layout must be called before nodes may be requested.");U.selectAll(".anom-anomaly").each(t)},Z}}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.core||{},i=t.dv||{},r=t.d3||{},a=Object.create(n),o=400;a.init=function(t){return this._type="pathing",this._initDefaultOptions(),this.setOptions(t),this._pathLocked=null,this._pathedObj=null,this._activePaths=[],this._lineLocked=null,this._lastSide=0,this},a._initDefaultOptions=function(){var t="Visits",e={colors:["#3287d2","#9b8ce6","#d755a5","#fa5a50","#f0a01e","#c3d250","#5faf69","#1ebed7","#5a6eaa","#78b4f5","#aa5fa5","#f0557d","#e8782d","#f5c841","#8cc350","#3cb5a0","#286eaf","#826ee1","#b93282","#f04641","#e18c00","#a0b400","#50965a","#00a0be","#465a87","#4196e6","#964196","#dc3c69","#dc5f00","#e6b43c","#7daf4b","#32a08c"],nodeWidth:100,minNodeHeight:1,avgNodeHeight:30,padding:{top:80,left:30,right:30,bottom:20},metricName:t,minNodeHorzPadding:80,nodeVertPadding:34,iterations:32,pivotNode:null,collapseNode:null,expandNode:null,pathSelected:null};return Object.getPrototypeOf(a)._initDefaultOptions.call(this,e)},a._onAutoResize=function(){this.render()},a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments)},a._preRender=function(){Object.getPrototypeOf(a)._preRender.apply(this);var t=this._options,e=r.select(t.parent),n=t.padding,i=e.selectAll(".pathing-cv-info-wrapper").data([0]);i.enter().insert("div",":first-child").classed("pathing-cv-info-wrapper",!0);var o=i.selectAll(".pathing-cv-wrapper").data([0]);o.enter().insert("div",":first-child").classed("pathing-cv-wrapper",!0);var s=o.selectAll(".pathing-cv-container").data([0]);s.enter().insert("div",":first-child").classed("pathing-cv-container",!0);var l=s.selectAll(".pathing-svg").data([0]);l.enter().append("svg").classed("pathing-svg",!0);var u=l.selectAll(".pathing-svg-container").data([0]);u.enter().append("g").classed("pathing-svg-container",!0),u.attr("transform","translate("+n.left+","+n.top+")");var c=i.selectAll(".pathing-cv-info-pane").data([0]);c.enter().append("div").classed("pathing-cv-info-pane",!0),c.exit().remove();var h=c.selectAll(".info-pane-content").data([0]);h.enter().append("div").classed("info-pane-content",!0),h.exit().remove();var d=h.selectAll(".pathing-cv-info-title").data([0]);d.enter().append("div").classed("pathing-cv-info-title",!0),d.exit().remove();var p=h.selectAll(".pathing-cv-info-value").data([0]);p.enter().append("div").classed("pathing-cv-info-value",!0),p.exit().remove();var f=h.selectAll(".pathing-cv-info-paths").data([0]);f.enter().append("div").classed("pathing-cv-info-paths",!0),f.exit().remove(),this._sizeChart(),this._createGradients(l);var g=this._pathedObj;this._changedOptions&&this._changedOptions.data&&g?this._isDataObjNode(g.data)?this._unlockNode(g.data,g.elem)():this._unlockLink(g.data,g.elem)():(s.on("mousemove.node",null).on("mouseup.node",null).on("touchend.node",null).on("mouseup.link",null).on("touchend.link",null),this._removePathOverlays(s),this._removeNodeOptions(!0),this._defaultInformation())},a._render=function(){Object.getPrototypeOf(a)._render.apply(this),this._createDiagram();var t=this._pathedObj;this._activePaths.length&&t&&(this._isDataObjNode(t.data)?(this._renderNodePaths(t.data,t.elem,!0),this._showNodeOptions(t.data,t.elem)):this._renderLinkPaths(t.data,t.elem,!0))},a._postRender=function(){Object.getPrototypeOf(a)._postRender.apply(this)},a._sizeChart=function(){clearTimeout(this._wrapperAnimation),clearTimeout(this._scrollAnimation);var t=this._options,e=this._dataAdapter.data(),n=r.select(t.parent),a=n.selectAll(".pathing-cv-info-wrapper"),o=a.selectAll(".pathing-cv-wrapper"),s=o.selectAll(".pathing-cv-container"),l=a.selectAll(".pathing-cv-info-pane"),u=t.parent.offsetWidth,c=t.parent.offsetHeight,h=i.util.getPercentValue(t.width,u),d=i.util.getPercentValue(t.height,c),p=h-parseInt(l.style("width"),10),f=t.padding,g=e&&e.nodes||[],m=this._numColumns=g.length&&Math.max.apply(null,g.map(function(t){return t.column}))+1||1,v=[],_=0;e.nodes.forEach(function(t){v[t.column]?v[t.column]++:v[t.column]=1}),_=v.length&&Math.max.apply(null,v)||0;var y=p-2,x=d-2,b=m*t.nodeWidth+(m-1)*t.minNodeHorzPadding+f.left+f.right,A=_*t.avgNodeHeight+_*t.nodeVertPadding+f.top+f.bottom,k=b>p,P=A>d;o.classed("is-wider",k),k&&(y=b,x-=20),o.classed("is-taller",P),P&&(x=A,y-=20),a.style("width",h+"px").style("height",d+"px"),o.style("width",p+"px").style("height",d+"px"),s.style("width",y+"px").style("height",x+"px")},a._getInnerDimensions=function(){var t=this._options,e=t.padding,n=r.select(t.parent).select(".pathing-cv-container"),i=parseInt(n.style("width"),10),a=parseInt(n.style("height"),10);return[i-e.right-e.left,a-e.top-e.bottom]},a._createDiagram=function(){var t=this._options,e=this._dataAdapter.data(),n=r.select(t.parent).selectAll(".pathing-cv-container"),i=parseInt(n.style("width"),10),a=parseInt(n.style("height"),10),o=this._path=r.pathing().nodeWidth(t.nodeWidth).nodePadding(t.nodeVertPadding).size(this._getInnerDimensions()).nodes(e.nodes).links(e.links).minNodeHeight(t.minNodeHeight).layout(t.interations);if(!e.nodes.some(function(t){return 0!==t.column})){var s=o.nodeWidth(),l=t.padding;e.nodes.forEach(function(t){t.x+=(i-l.left-l.right)/2-s/2})}var u=this._updateLinks(o,e.links);this._updateNodes(o,e.nodes,u,a);var c=r.select(t.parent).select(".pathing-svg").node();c.style.display="none",c.offsetHeight,c.style.display=""},a._updateNodes=function(t,e,n,i){var a=this,s=this._options,l=r.select(s.parent).select(".pathing-svg-container"),u=(this._options.onNodeSelect,this._options.padding,!this._changedOptions||!this._changedOptions.data),c=u?0:o,h=l.selectAll(".node-container").data([0]);h.enter().append("g").classed("node-container",!0),h.exit().remove();var d=h.selectAll(".node").data(e,this._dataAdapter.nodeKey()),p=t.nodeWidth();d.enter().append("g").classed("hide-node",!0).attr("transform",function(t){return"translate("+t.x+",0)"}),d.on("mouseover.node",function(t){a._showNodePaths(t,this)}).on("mouseout.node",function(){a._hideNodePaths()}).on("mouseup.node",function(t){a._activateNode(t,this)}).on("touchend.node",function(t){a._activateNode(t,this)});var f=d.exit();f.classed("hide-node",!0).on("mouseover.node",null).on("mouseout.node",null).on("mouseup.node",null).on("touchend.node",null).transition().duration(c).style("opacity",0).attr("transform",function(t){return"translate("+t.x+",0)"}),setTimeout(function(){f.remove()},c),d.transition().duration(c).attr("transform",function(t){return"translate("+t.x+","+t.y+")"});var g=this._numColumns;d.each(function(e){function n(t){var e=!0,n=!1,i=!1;g>1&&(n=0===t.column,i=g-1===t.column,e=!(n||i)),r.select(this).attr("x",e?p/2:n?2:p-4).attr("text-anchor",e?"middle":n?"start":"end")}function i(t){var e=20,n=10,i="";return e>t.length?t:t.slice(0,e-n)+i+t.slice(t.length-n)}var a=r.select(this),o=a.classed("hide-node");a.attr("class","node"),a.classed("hide-node",o),a.classed("filter","E_0"===e.id),a.classed("exit-filter","X_0"===e.id),e.classname&&a.classed(e.classname,!0);var s=a.selectAll(".node-bg").data([e]);s.enter().append("rect").classed("node-bg",!0),s.exit().remove(),s.attr("width",p),s.transition().duration(c).attr("height",function(t){return t.dy});var l=a.selectAll(".node-title").data([e]);l.enter().append("text").classed("node-title",!0).attr("y",-5).attr("transform",null),l.exit().remove(),l.each(n),l.text(function(t){return i(t.label)});var u=a.selectAll(".node-total").data([e]);u.enter().append("text").classed("node-total",!0).attr("y",15).attr("transform",null),u.exit().remove(),u.each(n),u.text(function(t){return r.format(",.0f")(t.value)});var h=a.selectAll(".node-hit-area").data([e]);h.enter().append("rect").classed("node-hit-area",!0),h.exit().remove(),h.attr("height",function(t){return t.dy+4}).attr("y",-4).attr("width",t.nodeWidth()).style("opacity",0),setTimeout(function(){a.classed("hide-node",!1)},c)})},a.gradientCounter={count:0},a._updateLinks=function(t,e){var n=this._options,i=this,a=r.select(n.parent).select(".pathing-svg-container"),s=r.select(n.parent).selectAll("svg"),l=s.selectAll("defs").data([0]),u=!this._changedOptions||!this._changedOptions.data,c=u?0:o;l.enter().append("defs");var h=l.selectAll(".path-fills").data([0]);h.enter().append("g").classed("path-fills",!0);var d=a.selectAll(".link-container").data([0]);d.enter().append("g").classed("link-container",!0),d.exit().remove();var p=a.selectAll(".path-overlay-container").data([0]);p.enter().append("g").classed("path-overlay-container",!0),p.exit().remove();var f=d.selectAll("path").data(e,this._dataAdapter.linkKey());f.enter().append("path").classed("hide-link",!0),f.on("mouseover.link",function(t){i._showLinkPaths(t,this)}).on("mouseout.link",function(){i._hideLinkPaths()}).on("mouseup.link",function(t){i._activateLink(t,this)}).on("touchend.link",function(t){i._activateLink(t,this)});var g=f.exit();return g.classed("hide-link",!0).on("mouseup.link",null).on("touchend.link",null).on("mouseover.link",null).on("mouseout.link",null),setTimeout(function(){g.remove()},c),f.each(function(e){var n=r.select(this),i=n.classed("hide-link");n.attr("class",function(t){return t.source?t.target?"link":"exit":"entry"}),n.classed("hide-link",i),n.classed("hide-link")?(n.attr("d",t.link()(e)),setTimeout(function(){n.classed("hide-link",!1)},c)):n.transition().duration(c).attr("d",t.link()(e)),e.source&&"E_0"===e.source.id?n.classed("entry-path",!0):e.target&&"X_0"===e.target.id&&n.classed("exit-path",!0);var a=e.source&&"E_0"===e.source.id,o=e.target&&"X_0"===e.target.id;n.classed("filter",a),n.classed("exit-filter",o)}),f},a._createGradients=function(t){var e=t.selectAll("style").data([0]);e.enter().append("style"),e.text(function(){var t=".pathing-svg .exit { fill: url(#exitFill); } \n";return t+=".pathing-svg .entry { fill: url(#entryFill); } \n",t+=".pathing-svg .exit:hover { fill: url(#exitHighlightFill); } \n",t+=".pathing-svg .entry:hover { fill: url(#entryHighlightFill); } \n",t+=".pathing-svg .pivot-entry { mask: url(#pivotEnterMask); } \n",t+=".pathing-svg .pivot-exit { mask: url(#pivotExitMask); } \n",t+=".pathing-svg .link-container .entry-path { fill: url(#entryGradient); } \n",t+=".pathing-svg .link-container .exit-path { fill: url(#exitGradient); } \n"});var n=t.selectAll("defs").data([0]);n.enter().append("defs");var i=n.selectAll(".bounce-fills").data([0]),r=i.enter().append("g").classed("bounce-fills",!0),a=r.append("linearGradient").attr("id","pivotEnterGrad");a.append("stop").attr("offset","0%").style("stop-color","#fff").style("stop-opacity",0),a.append("stop").attr("offset","50%").style("stop-color","#fff").style("stop-opacity",0),a.append("stop").attr("offset","70%").style("stop-color","#fff").style("stop-opacity",.5),a.append("stop").attr("offset","100%").style("stop-color","#fff").style("stop-opacity",1);var o=r.append("mask").attr("id","pivotEnterMask").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("maskUnits","objectBoundingBox").attr("maskContentUnits","objectBoundingBox");o.append("rect").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("fill","url(#pivotEnterGrad)");var s=r.append("linearGradient").attr("id","pivotExitGrad").attr("x1","100%").attr("y1","0%").attr("x2","0%").attr("y2","0%");s.append("stop").attr("offset","0%").style("stop-color","#fff").style("stop-opacity",0),s.append("stop").attr("offset","50%").style("stop-color","#fff").style("stop-opacity",0),s.append("stop").attr("offset","70%").style("stop-color","#fff").style("stop-opacity",.5),s.append("stop").attr("offset","100%").style("stop-color","#fff").style("stop-opacity",1);var l=r.append("mask").attr("id","pivotExitMask").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("maskUnits","objectBoundingBox").attr("maskContentUnits","objectBoundingBox");l.append("rect").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("fill","url(#pivotExitGrad)");var u=r.append("linearGradient").attr("id","entryGradient").attr("x1","0%").attr("y1","100%").attr("x2","100%").attr("y2","100%");u.append("stop").attr("offset","0%").style("stop-color","#8cc350"),u.append("stop").attr("offset","100%").style("stop-color","#3287D2");var c=r.append("linearGradient").attr("id","exitGradient").attr("x1","0%").attr("y1","100%").attr("x2","100%").attr("y2","100%");c.append("stop").attr("offset","0%").style("stop-color","#3287D2"),c.append("stop").attr("offset","100%").style("stop-color","#cc2539");var h=r.append("linearGradient").attr("id","exitFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");h.append("stop").attr("offset","0%").style("stop-color","#FA5A50").style("stop-opacity",.5),h.append("stop").attr("offset","85%").style("stop-color","#FA5A50").style("stop-opacity",.5),h.append("stop").attr("offset","100%").style("stop-color","#FA5A50").style("stop-opacity",.1);var d=r.append("linearGradient").attr("id","exitHighlightFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");d.append("stop").attr("offset","0%").style("stop-color","#FA5A50").style("stop-opacity",1),d.append("stop").attr("offset","85%").style("stop-color","#FA5A50").style("stop-opacity",1),d.append("stop").attr("offset","100%").style("stop-color","#FA5A50").style("stop-opacity",.1);var p=r.append("linearGradient").attr("id","entryFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");p.append("stop").attr("offset","0%").style("stop-color","#58AF5E").style("stop-opacity",.1),p.append("stop").attr("offset","15%").style("stop-color","#58AF5E").style("stop-opacity",.5),p.append("stop").attr("offset","100%").style("stop-color","#58AF5E").style("stop-opacity",.5);var f=r.append("linearGradient").attr("id","entryHighlightFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");f.append("stop").attr("offset","0%").style("stop-color","#58AF5E").style("stop-opacity",.1),f.append("stop").attr("offset","15%").style("stop-color","#58AF5E").style("stop-opacity",1),f.append("stop").attr("offset","100%").style("stop-color","#58AF5E").style("stop-opacity",1)},a._setOptionContainerContent=function(t,e){var n,i=this._options,r="",a=0,o=t.classed("is-last-column"),s=this._dataAdapter,l=[{id:"expand",label:"Expand",valid:i.expandNode&&s.canExpandNode(e)},{id:"pivot",label:"Focus",valid:i.pivotNode&&s.canPivotNode(e)},{id:"collapse",label:"Collapse",valid:i.collapseNode&&s.canCollapseNode(e)}];if(o&&l.reverse(),l=l.filter(function(t){return t.valid}),i.expandNode||i.collapseNode||i.pivotNode)for(var u=0,c=l.length;c>u;++u)n=l[u],r+='<a class="cv-node-option cv-node-option'+(o?c-a-1:a)+" cv-node-"+n.id+'"><i class="'+n.id+'"></i><span>'+n.label+"</span></a>",++a;r='<div class="cv-node-options num-options-'+a+'">'+r+"</div>",t.html(r)},a._activateNode=function(t,e){var n=this;if(this._pathLocked&&t===this._pathLocked.data){n._unlockNode(t,e)();var i=r.mouse(e)[0]>=n._options.nodeWidth/2?1:-1;if(!t.isPivot||i===n._lastSide)return}this._setPathLocked({data:t,elem:e}),r.select(n._options.parent).select(".pathing-cv-container").on("mouseup.node",null).on("touchend.node",null).on("mouseup.link",null).on("touchend.link",null),r.selectAll(".cv-node-active").classed("cv-node-active",!1),r.selectAll(".cv-link-active").classed("cv-link-active",!1),r.select(e).classed("cv-node-active",!0),this._renderNodePaths(t,e),this._showNodeOptions(t,e),this._showInformation(t,e),this._scrollToElem(e),setTimeout(function(){r.select(n._options.parent).select(".pathing-cv-container").on("mouseup.node",n._unlockNode(t,e)).on("touchend.node",n._unlockNode(t,e))},10)},a._showNodePaths=function(t,e){this._pathLocked||this._renderNodePaths(t,e)},a._renderNodePaths=function(t,e,n){function i(){l=c._activePaths=h.filter(function(e){var n=e.nodes.indexOf(t._pid);return u>0&&e.nodes.length>n+1||0>u&&n>0}),s=c._dataAdapter.nodePathData(l,t,u),c._createPathOverlays(s)}function a(){var t=r.mouse(e)[0]>=c._options.nodeWidth/2?1:-1;t!==u&&(c._lastSide=u=t,i())}var o=r.select(this._options.parent).select(".pathing-cv-container");if(clearTimeout(this._hidePathOverlaysTimer),o.on("mousemove.node",null),!this._pathedObj||this._pathedObj.data!==t||n){this._setPathedObj({data:t,elem:e});var s,l,u=0,c=this,h=this._dataAdapter.nodePaths(t);t.isPivot?n?(u=c._lastSide,i()):(a(),c._pathLocked||o.on("mousemove.node",function(){a()})):(c._lastSide=0,c._activePaths=h,s=this._dataAdapter.nodePathData(h,t,u),c._createPathOverlays(s)),setTimeout(function(){o.classed("path-overlays",!0)},1)}},a._showNodeOptions=function(t,e){var n=this._numColumns,i=r.select(this._options.parent).select(".pathing-cv-container"),a=i.node(),o=this._options,s=50,l=r.select(e).select(".node-bg").node(),u=a.getBoundingClientRect(),c=l.getBoundingClientRect(),h=c.top-u.top,d=c.left-u.left+o.nodeWidth/2,p=i.select(".cv-path-node-options");p.empty()?p=i.append("div").classed("cv-path-node-options",!0).attr("node",t._pid):p.attr("node")==t._pid&&p.classed("is-open")||(this._removeNodeOptions(),s=300,p=i.append("div").classed("cv-path-node-options",!0).attr("node",t._pid)),p.classed("is-last-column",n>1&&n-1===t.column).style("top",h+"px").style("left",d+"px"),this._setOptionContainerContent(p,t),setTimeout(function(){p.classed("is-open",!0)},s)},a._formatMetricValue=function(t){return this._formatNumber("decimal",t.value)+" "+this._options.metricName},a._formatPathInformation=function(t){var e=this._options,n=this,i=e.colors;return function(e,r){var a=n._dataAdapter.getPathEnd(e),o=a?a.value?a.value:t:t,s="",l=e.values[0],u=l/o;return r%=i.length,s+='<span class="pathing-path-marker" style="background-color: '+i[r]+'"></span>',s+='<span class="pathing-path-value"><span class="pathing-path-num">'+n._formatNumber("decimal",l)+'</span> <span class="pathing-path-perc">'+n._formatNumber("percent",u)+"</span></span>"}},a._highlightPath=function(t,e,n){var i=this._options,a=i.parent,o=r.event,s=!o||o&&("mouseup"===o.type||"touchend"===o.type),l=r.select(a).selectAll(".path-overlay-container"),u=r.select(a).selectAll(".pathing-cv-info-pane"),c=l.selectAll(".link.path"+e),h=l.selectAll(".link:not(.path"+e+")");if(s){if(this._lineLocked===t)return this._setLineLock(null),this._removeHightlightPath();this._setLineLock(t),u.selectAll(".locked").classed("locked",!1),r.select(n).classed("locked",!0)}else if(this._lineLocked)return;l.selectAll(".link.inactive").classed("inactive",!1),h.classed("inactive",!0),c.classed("active",!0)},a._setLineLock=function(t){this._options,this._lineLocked!==t&&(this._lineLocked=t,this._callPathSelected(t))},a._setPathedObj=function(t){this._pathedObj=t},a._setPathLocked=function(t){this._options,this._pathLocked!==t&&(this._pathLocked=t,this._callPathSelected())},a._callPathSelected=function(t){var e={},n=this._options,i=this._pathLocked&&this._pathLocked.data||{};t&&(e.path=t.nodes+""),i._pid!==void 0&&(e.node=i._pid,e.side=this._lastSide),(i.source!==void 0||i.target!==void 0)&&(e.source=i.source?i.source._pid:null,e.target=i.target?i.target._pid:null),"function"==typeof n.pathSelected&&n.pathSelected(e,this._pathLocked,t)},a._removeHightlightPath=function(){if(!this._lineLocked){var t=this._options,e=t.parent,n=r.select(e).selectAll(".pathing-cv-info-pane"),i=r.select(e).selectAll(".path-overlay-container").selectAll(".link");i.classed("inactive",!1).classed("active",!1),n.selectAll(".locked").classed("locked",!1)}},a._showInformation=function(t){var e=this,n=(this._options,this._isDataObjNode(t)),i=r.select(this._options.parent).select(".pathing-cv-info-pane"),a=i.selectAll(".pathing-cv-info-title"),o=i.selectAll(".pathing-cv-info-value"),s=i.selectAll(".pathing-cv-info-paths");this._setLineLock(null),this._removeHightlightPath();var l,u=this._formatMetricValue(t),c=!1;if(n)l=t.label,u=this._formatMetricValue(t),c=t.column==this._numColumns-1;else if(t.source)if(t.target){var h=this._dataAdapter,d=h.getPathDirection(h.data().paths[t.paths[0]]),p=0>d?t.target:t.source;l=t.source.label+"  "+t.target.label,u=this._formatMetricValue(t)+'<span class="perc">'+this._formatNumber("percent",t.value/p.value)+" of "+p.label+"</span>"}else l=t.source.label+" Exits",u=this._formatMetricValue(t)+'<span class="perc">'+this._formatNumber("percent",t.value/t.source.value)+" of "+t.source.label+"</span>";else l=t.target.label+" Entries",u=this._formatMetricValue(t)+'<span class="perc">'+this._formatNumber("percent",t.value/t.target.value)+" of "+t.target.label+"</span>";i.classed("is-last-column",c),a.html(l),o.html(u);var f=s.selectAll(".pathing-cv-path-title").data([0]);f.enter().append("span").classed("pathing-cv-path-title",!0),f.html(this._dataAdapter.activePathsTitle(this._activePaths));var g=s.selectAll(".pathing-cv-path-info").data(this._activePaths);g.enter().append("span").classed("pathing-cv-path-info",!0),g.on("mouseup.line",function(t,n){e._highlightPath(t,n,this)}).on("touchend.line",function(t,n){e._highlightPath(t,n,this)}).on("mouseover.line",function(t,n){e._highlightPath(t,n,this)}).on("mouseout.line",function(){e._removeHightlightPath()}).html(this._formatPathInformation(t.value)),g.exit().on("mouseup.line",null).on("touchend.line",null).on("mouseover.line",null).on("mouseout.line",null).remove()},a._defaultInformation=function(){this._setLineLock(null),this._removeHightlightPath();var t=r.select(this._options.parent).select(".pathing-cv-info-pane"),e=t.selectAll(".pathing-cv-info-title"),n=t.selectAll(".pathing-cv-info-value"),i=t.selectAll(".pathing-cv-info-paths"),a="<p>This chart represents paths taken from one state to another.</p>";a+="<p>Each node, shaped as a box, represents a state in the path.</p>",a+="<p>Tapping or clicking a node will provide additional options to modify the chart:</p>",a+='<p><span class="cv-node-option"><i class="pivot"></i></span><span class="cv-option-title">Focus</span></p>',a+="<p>Shows paths coming into and going out of node</p>",a+='<p><span class="cv-node-option"><i class="expand"></i></span><span class="cv-option-title">Expand</span></p>',a+="<p>Shows additional paths coming or going from the node</p>",a+='<p><span class="cv-node-option"><i class="collapse"></i></span><span class="cv-option-title">Collapse</span></p>',a+="<p>Removes paths coming or going from the node</p>",e.html("Pathing Chart"),n.html('<div class="help">'+a+"</div>"),i.html("")},a._scrollToElem=function(t){function e(t,e){return function(){var n=null!==t?r.interpolateNumber(o.node().scrollLeft,t):null,i=null!==e?r.interpolateNumber(o.node().scrollTop,e):null;return function(t){null!==n&&(o.node().scrollLeft=n(t)),null!==i&&(o.node().scrollTop=i(t))}}}var n=this._options,i=r.select(this._options.parent).select(".pathing-cv-container"),a=i.node(),o=r.select(n.parent).select(".pathing-cv-wrapper"),s=r.select(t),l=s.selectAll(".node-bg").empty()?s.node():s.select(".node-bg").node(),u=a.getBoundingClientRect(),c=l.getBoundingClientRect(),h=c.top-u.top,d=c.left-u.left+n.nodeWidth/2;if(o.classed("is-wider")||o.classed("is-taller")){var p=null,f=null;if(o.classed("is-wider")){var g=parseInt(o.style("width"),10),m=parseInt(i.style("width"),10);p=Math.min(m-g,Math.max(0,d-g/2))}if(o.classed("is-taller")){var v=parseInt(o.style("height"),10),_=parseInt(i.style("height"),10);f=Math.min(_-v,Math.max(0,h+40-v/2))}r.transition().duration(300).tween("scroll",e(p,f))}},a._unlockNode=function(t,e){var n=this;return function(){n._setPathLocked(null),r.select(n._options.parent).select(".pathing-cv-container").on("mouseup.node",null).on("touchend.node",null),n._deactivateNode(r.event,t,e)}},a._deactivateNode=function(t,e,n){var i=r.select(t.target),a=this._options,o=e||{};r.select(n).classed("cv-node-active",!1),this._removeNodeOptions(!1),this._defaultInformation(),this._hideNodePaths(),("mouseup"===t.type||"touchend"===t.type)&&(i.classed("cv-node-option")||(i=r.select(i.node().parentNode)),i.classed("cv-node-expand")&&"function"==typeof a.expandNode&&a.expandNode(o),i.classed("cv-node-collapse")&&"function"==typeof a.collapseNode&&a.collapseNode(o),i.classed("cv-node-pivot")&&"function"==typeof a.pivotNode&&a.pivotNode(o))},a._removeNodeOptions=function(t){var e=r.selectAll(".cv-path-node-options");e.classed("is-open",!1),setTimeout(function(){e.remove()},t?0:300)},a._hideNodePaths=function(){var t=r.select(this._options.parent).select(".pathing-cv-container");t.on("mousemove.node",null),this._pathLocked||this._removePathOverlays(t)},a._activateLink=function(t,e){var n=this;return this._pathLocked&&t===this._pathLocked.data?(n._unlockLink(t,e),void 0):(this._setPathLocked({data:t,elem:e}),r.select(n._options.parent).select(".pathing-cv-container").on("mouseup.node",null).on("touchend.node",null).on("mouseup.link",null).on("touchend.link",null),r.selectAll(".cv-node-active").classed("cv-node-active",!1),r.selectAll(".cv-link-active").classed("cv-link-active",!1),r.select(e).classed("cv-link-active",!0),this._removeNodeOptions(),this._renderLinkPaths(t,e),this._showInformation(t,e),this._scrollToElem(e),setTimeout(function(){r.select(n._options.parent).select(".pathing-cv-container").on("mouseup.link",n._unlockLink(t,e)).on("touchend.link",n._unlockLink(t,e))},10),void 0)},a._showLinkPaths=function(t,e){this._pathLocked||this._renderLinkPaths(t,e)},a._renderLinkPaths=function(t,e,n){if(clearTimeout(this._hidePathOverlaysTimer),!this._pathedObj||this._pathedObj.data!==t||n){this._setPathedObj({data:t,elem:e});var i=this._dataAdapter.data().paths;this._activePaths=t.paths.map(function(t){return i[t]});var a=this._dataAdapter.linkPathData(t);this._createPathOverlays(a);var o=r.select(this._options.parent).select(".pathing-cv-container");setTimeout(function(){o.classed("path-overlays",!0)},1)}},a._unlockLink=function(t,e){var n=this;return function(){n._setPathLocked(null),r.select(n._options.parent).select(".pathing-cv-container").on("mouseup.link",null).on("touchend.link",null),n._deactivateLink(r.event,t,e)}},a._deactivateLink=function(t,e,n){r.select(this._options.parent).select(".pathing-cv-container"),r.select(n).classed("cv-link-active",!1),this._defaultInformation(),this._hideLinkPaths()},a._hideLinkPaths=function(){var t=r.select(this._options.parent).select(".pathing-cv-container");this._pathLocked||this._removePathOverlays(t)},a._createPathOverlays=function(t){var e=this._options,n=this._path,i=r.select(e.parent).select(".path-overlay-container"),a=i.selectAll("path").data(t);a.enter().append("path"),a.exit().remove(),a.attr("class",function(t){var e=t.pivotStart?" pivot-entry":t.pivotEnd?" pivot-exit":"";return"link path"+t.path+e}).attr("d",n.link()).attr("style",function(t){var n=t.path%e.colors.length;return"fill: "+e.colors[n]+";"}).sort(function(t,e){return t||e?t?e?e.dy-t.dy:-1:1:0})},a._removePathOverlays=function(t){clearTimeout(this._hidePathOverlaysTimer),this._setPathedObj(null),this._hidePathOverlaysTimer=setTimeout(function(){t.classed("path-overlays",!1)},20)},a._isDataObjNode=function(t){return t._pid!==void 0},a.setActivePath=function(t){var e=this._options,n=this,i=this._dataAdapter.data();t=t||{};var a,o,s=t.node!==void 0;if(s?a=i.nodesById[t.node]:(a=i.links.filter(function(e){return(!e.source&&!t.source||e.source&&t.source&&e.source._pid+""===t.source)&&(!e.target&&!t.target||e.target&&t.target&&e.target._pid+""===t.target)}),a=a.length&&a[0]||null),o=s?".node":".link",a){var l,u=!1;u=i.paths.some(function(e){return l=e.nodes,""+e.nodes===t.path}),r.select(e.parent).selectAll(o).each(function(t){if(t===a){if(s?n._activateNode(t,this):n._activateLink(t,this),!u)return;r.select(e.parent).selectAll(".pathing-cv-path-info").filter(function(t,e){""+t.nodes==""+l&&n._highlightPath(t,e,this)})}})}},t.cloudViz.pathing=e.util.createConstructor(a)}(this),function(){"use strict";d3.pathing=function(){function t(){d.forEach(function(t){t.sourceLinks=[],t.targetLinks=[],t.entryLinks=[],t.exitLinks=[]}),p.forEach(function(t){var e=t.source,n=t.target;null!==e&&"number"==typeof e&&(e=t.source=d[t.source]),null!==n&&"number"==typeof n&&(n=t.target=d[t.target]),null!==e&&null!==n?(e.sourceLinks.push(t),n.targetLinks.push(t)):null===e?n.entryLinks.push(t):e.exitLinks.push(t)})}function e(){function t(t){return t.sourceLinks&&t.sourceLinks.length||t.targetLinks&&t.targetLinks.length||t.exitLinks&&t.exitLinks.length||t.entryLinks&&t.entryLinks.length}d.forEach(function(t){t.value=t.hasOwnProperty("total")?t.total:Math.max(d3.sum(t.sourceLinks,s)+d3.sum(t.exitLinks,s),d3.sum(t.targetLinks,s)+d3.sum(t.entryLinks,s))}),d.sort(function(e,n){var i=t(e),r=t(n);return i&&!r?-1:r&&!i?1:n.value-e.value})}function n(){var t=[],e=h[0]-u;d.forEach(function(e){e.x=e.column,e.dx=u,0>t.indexOf(e.column)?(t.push(e.column),e.columnIndex=t.length-1):e.columnIndex=t.indexOf(e.column)}),f=t.length,i(f>1?e/(f-1):e)}function i(t){d.forEach(function(e){e.x*=t})}function r(t){function e(){var t=d3.min(l,function(t){var e=d3.sum(t,s)||1;return(h[1]-(t.length-1)*c)/e});l.forEach(function(e){e.forEach(function(e,n){e.y=n,e.dy=Math.max(g,e.value*t)})}),p.forEach(function(e){e.dy=e.value*t})}function n(t){function e(t){return o(t.source)*t.value}l.forEach(function(n){n.forEach(function(n){if(n.targetLinks.length){var i=d3.sum(n.targetLinks,e)/d3.sum(n.targetLinks,s);n.y+=(i-o(n))*t}})})}function i(t){function e(t){return o(t.target)*t.value}l.slice().reverse().forEach(function(n){n.forEach(function(n){if(n.sourceLinks.length){var i=d3.sum(n.sourceLinks,e)/d3.sum(n.sourceLinks,s);n.y+=(i-o(n))*t}})})}function r(){l.forEach(function(t){var e,n,i,r=0,o=t.length;for(t.sort(a),i=0;o>i;++i)e=t[i],n=r-e.y,n>0&&(e.y+=n),r=e.y+e.dy+c;if(n=r-c-h[1],n>0)for(r=e.y-=n,i=o-2;i>=0;--i)e=t[i],n=e.y+e.dy+c-r,n>0&&(e.y-=n),r=e.y})}function a(t,e){return t.y-e.y}var l=d3.nest().key(function(t){return t.x}).sortKeys(d3.ascending).entries(d).map(function(t){return t.values});e(),r();for(var u=1;t>0;--t)i(u*=.99),r(),n(u),r()}function a(){function t(t,e){return t.source.y-e.source.y}function e(t,e){return t.target.y-e.target.y}d.forEach(function(n){n.sourceLinks.sort(e),n.targetLinks.sort(t)}),d.forEach(function(t){var e=0,n=0;t.entryLinks.forEach(function(t){t.ty=n,n+=t.dy}),t.sourceLinks.forEach(function(t){t.sy=e,e+=t.dy}),t.targetLinks.forEach(function(t){t.ty=n,n+=t.dy}),t.exitLinks.forEach(function(t){t.sy=e,e+=t.dy})})}function o(t){return t.y+t.dy/2}function s(t){return t.value}var l={},u=24,c=8,h=[1,1],d=[],p=[],f=0/0,g=0;return l.nodeWidth=function(t){return arguments.length?(u=+t,l):u},l.nodePadding=function(t){return arguments.length?(c=+t,l):c},l.nodes=function(t){return arguments.length?(d=t,l):d},l.links=function(t){return arguments.length?(p=t,l):p},l.size=function(t){return arguments.length?(h=t,l):h},l.numColumns=function(){return f},l.minNodeHeight=function(t){return arguments.length?(g=t,l):g},l.layout=function(i){return t(),e(),n(),r(i),a(),l},l.relayout=function(){return a(),l},l.link=function(){function t(t){var n,i,r,a,o,s,l,u,c,h,d;
return null===t.source?(n=t.target.x-15,i=t.target.x,u=t.target.y-5,c=t.target.y+t.dy,"M"+n+","+u+"h"+(i-n)+"v"+(c-u)+"c-"+(i-n)+",0"+",-"+(i-n)+",-7.5"+",-"+(i-n)+",-15"+"z"):null===t.target?(n=t.source.x+t.source.dx,i=t.source.x+t.source.dx+15,u=t.source.y+t.source.dy-t.dy,c=t.source.y+t.source.dy+5,"M"+i+","+c+"h-"+(i-n)+"v-"+(c-u)+"c"+(i-n)+",0"+","+(i-n)+",7.5"+","+(i-n)+",15"+"V"+c+"z"):(n=t.source.x+t.source.dx,i=t.target.x,r=d3.interpolateNumber(n,i),a=r(e),o=r(1-e),s=o+(15>t.dy?t.source.y<t.target.y?-1*t.dy:t.dy:0),l=a+(15>t.dy?t.source.y<t.target.y?-1*t.dy:t.dy:0),u=t.source.y+t.sy,c=t.target.y+t.ty,h=c+t.dy,d=u+t.dy,"M"+n+","+u+"C"+a+","+u+" "+o+","+c+" "+i+","+c+"v"+t.dy+"C"+s+","+h+" "+l+","+d+" "+n+","+d+"Z")}var e=.5;return t.curvature=function(n){return arguments.length?(e=+n,t):e},t},l}}(this),function(t){"use strict";function e(t){var e=[],n=!0;for(var i in t){for(var r=t[i],a=-1,o=r.length;o>++a;){var s,l=r[a];n?(s={},e.push(s)):s=e[a],s[i]=l}n=!1}return e}var n=t.cloudViz||{},i=n.core||{},r=t.dv||{},a=t.d3||{},o=Object.create(i);o.init=function(t){return this._type="anomaly",t=t||{},this._initDefaultOptions(),this.setOptions(t),this._initializeAnomaly(),this},o._initDefaultOptions=function(){var t={mappings:{x:"date",y:"deviation",category:"metric"},bins:12,xTicks:7,xTickInterval:void 0,xUpperLimit:void 0,xLowerLimit:void 0,normalizePositive:!1,onMouseOverAnomaly:null,onMouseOutAnomaly:null,onSelectAnomalies:null};return Object.getPrototypeOf(o)._initDefaultOptions.call(this,t)},o._render=function(){this._configureAnomaly(),this._anom.layout()},o._initializeAnomaly=function(){var t=this._options,e=t.mappings,n=this;this._anom=a.anomaly().on("mouseover",function(i,r,o){n._anom.nodes(function(t){a.select(this).transition().duration(750).style("opacity",t[e.category]===r[e.category]?.8:.2)}),t.onMouseOverAnomaly&&t.onMouseOverAnomaly.call(i,r,o)}).on("mouseout",function(e,i,r){n._anom.nodes(function(){a.select(this).transition().duration(750).style("opacity",1)}),t.onMouseOutAnomaly&&t.onMouseOutAnomaly.call(e,i,r)}).on("select",function(e){n._anom.nodes(function(){a.select(this).classed("selected",!1)}),e.classed("selected",!0),t.onSelectAnomalies&&t.onSelectAnomalies.call(e)})},o._configureAnomaly=function(){var t=this._options,n=r.util.getPercentValue(t.width,t.parent.offsetWidth),i=r.util.getPercentValue(t.height,t.parent.offsetHeight);this._anom.data(e(t.data)).parent(t.parent).mappings(t.mappings).bins(t.bins).size([n,i]).xUpperLimit(t.xUpperLimit).xLowerLimit(t.xLowerLimit).normalizePositive(t.normalizePositive).xTicks(t.xTicks,t.xTickInterval)},o._onAutoResize=function(){this.render()},o.chart=function(){return this._anom},t.cloudViz.anomaly=n.util.createConstructor(o)}(this),function(){"use strict";d3.choropleth=function(){function t(){this.type="EmptyDataException",this.message="The data is empty or null",this.toString=function(){return this.type+" - "+this.message}}function e(){this.type="ParentNotSpecifiedException",this.message="A parent was not specified for this visualization",this.toString=function(){return this.type+" - "+this.message}}var n,i,r,a,o,s,l,u,c,h,d,p,f,g=["#fae6be","#eb782d","#dc283c","#640046"],m=["#c7b797","#b85e23","#a81e2e","#300022"],v=["#faf0c8","#d2dc73","#5faf69","#00505A"],_=["#c7bf9f","#a0a858","#437d4a","#002226"],y={},x=[],b=[0,1],A=(d-p)*b[0],k=(d-p)*b[1],P={},S=!1,w={top:60,left:20,right:20,bottom:20};return y.layout=function(){if(!y.data())throw new t;if(!y.parent())throw new e;x=y.determineSize(l),y.calcRange(),o=y.createSVGContainer();var n={};n=l.fidelity===void 0||"high"==l.fidelity?{states:"../spec/data/geo/us-states.json",countries:"../spec/data/geo/countries.json"}:{states:"../spec/data/geo/us-states-low.json",countries:"../spec/data/geo/countries-low.json"},void 0!==l.geoJson&&l.geoJson||(l.geoJson=n[l.type]),d3.json(l.geoJson,function(t){f=t,y.drawGeos(),y.drawTooltip(),y.drawLegend(l.color)})},y.determineSize=function(t){var e=t.parent,n=t.width?t.width:e.offsetWidth,i=t.height?t.height:e.offsetHeight;return n=n?n:700,i=i?i:450,[n,i]},y.calcRange=function(){for(var t in l.data.values)d===void 0&&(d=l.data.values[t],p=l.data.values[t]),l.data.values[t]>d&&(d=l.data.values[t]),p>l.data.values[t]&&(p=l.data.values[t])},y.drawLegend=function(t){var e=9,i=9,r=35,o=.4*x[0],u=x[0]-o-w.left,c=u-2*r-2*i,h=[],f=[];t!==void 0&&"salmonRun"==t?(h=g,f=m):(h=v,f=_);var A=s.selectAll(".legend").data([n]);A.enter().append("g").classed("legend",!0),A.attr("transform","translate("+o+",33)");var k=A.selectAll("defs").data([n]);k.enter().append("defs");var P=k.selectAll("#defaultGradient").data([0]);P.enter().append("linearGradient").attr("id","defaultGradient");var M=k.selectAll("#darkGradient").data([0]);M.enter().append("linearGradient").attr("id","darkGradient");var T=["0%","33%","67%","100%"],O=function(t,e,n){var i=t.selectAll("stop").data(e);i.enter().append("stop").attr("class",function(t,e){return"stop"+e}),i.attr("offset",function(t){return t}).attr("stop-color",function(t,e){return n[e]})};O(P,T,h),O(M,T,f);var E=A.selectAll(".grad-bg").data([n]);E.enter().append("rect").classed("grad-bg",!0),E.attr("x",r+i).attr("y",0).attr("rx",e/2).attr("ry",e/2).attr("width",c).attr("height",e);var D=A.selectAll(".grad-rect").data([n]);D.enter().append("rect").classed("grad-rect",!0),D.classed("grad-rect",!0).attr("x",r+i).attr("y",0).attr("width",c).attr("height",e);var L=a.selectAll(".legend-label").data(["min","max"]);L.enter().append("div").attr("class",function(t){return"legend-label "+t}).style("top","30px"),L.style("left",function(t){return("min"===t?o:o+r+2*i+c)+"px"}).style("width",r+"px").text(function(t){return"min"===t?p:d});var F=a.selectAll(".legend-title").data([0]);F.enter().append("div").classed("legend-title",!0).style("top","27px"),F.style("left",w.left+"px").text(l.title);var z=d3.svg.brush().x(d3.scale.linear().range([0,c])).extent(b).on("brushstart",function(){S=!0}).on("brushend",function(){S=!1}).on("brush",function(){b=z.extent(),s.selectAll(".grad-rect").attr("width",(b[1]-b[0])*c).attr("x",c*b[0]+r+i),y.drawGeos()}),V=9,C=26,N=A.selectAll(".brush").data([n]);N.enter().append("g").classed("brush",!0),N.attr("transform","translate("+(r+i)+",0)").call(z);var R=N.selectAll(".resize"),I=R.selectAll(".handle").data(function(t){return t});I.enter().append("rect").classed("handle",!0),I.attr("transform","translate("+-(V/2)+","+-V+")").attr("rx",V/3).attr("ry",V/3).attr("width",V).attr("height",C)},y.drawTooltip=function(t){var e=95,n=85,i=10+w.right;h=a.selectAll(".tooltip").data([0]),h=t===void 0||t.value===void 0?a.selectAll(".tooltip").data([]):a.selectAll(".tooltip").data([t]),h.enter().append("div").classed("tooltip",!0),h.exit().classed("visible",!1),setTimeout(function(){h.classed("visible",!0)},10);var r=h.selectAll(".tooltip-back").data([t]);r.enter().append("div").classed("tooltip-back",!0),r.style("width",e+"px").style("min-height",n+"px").style("left",x[0]-(i+e)+"px").style("bottom",i+3+"px");var o=r.selectAll(".tt-name").data(function(t){return[t.name]});o.enter().append("p").classed("tt-name",!0),o.text(function(t){return t});var s=r.selectAll(".tt-value").data(function(t){return[t.value]});s.enter().append("p").classed("tt-value",!0),s.text(function(t){return t});var u=r.selectAll(".tt-metric").data(l.metric!==void 0?[l.metric]:[]);u.enter().append("p").classed("tt-metric",!0),u.text(function(t){return t}),u.exit().remove()},y.hideTooltip=function(){y.drawTooltip({})},y.showTooltip=function(t){"value"in t&&t.value?y.drawTooltip(t):y.hideTooltip()},y.drawGeos=function(){var t,e=null;A=(d-p)*b[0]+p,k=(d-p)*b[1]+p,t=[A,(k-A)/3+A,2*((k-A)/3)+A,k],r.selectAll(".legend-label.min").text(Math.round(A)),r.selectAll(".legend-label.max").text(Math.round(k)),e="salmonRun"==l.color?d3.scale.linear().domain(t).range(g):d3.scale.linear().domain(t).range(v);var i=function(t){return n.values[t.properties.GEO_ID]===void 0||A>n.values[t.properties.GEO_ID]||n.values[t.properties.GEO_ID]>k?"#ddd":e(n.values[t.properties.GEO_ID])},a=function(t){if(!S){var e=t.properties.GEO_ID,i=s.selectAll("#"+e)[0][0];null!==i.nextSibling&&(P[e]=i.nextSibling.id),i.parentNode.appendChild(i),s.selectAll("#"+e).style("stroke","#565656").style("stroke-width",1.5),y.showTooltip({name:t.properties.name,id:t.properties.GEO_ID,value:n.values[t.properties.GEO_ID]})}},u=function(t){if(!S){var e=t.properties.GEO_ID,n=s.selectAll("#"+e).node();s.selectAll("#"+e).style("stroke","#fff").style("stroke-width",1.1);var i=s.selectAll(".choro-container").node();P[e]!==void 0?i.insertBefore(n,s.selectAll("#"+P[e]).node()):i.appendChild(n),y.hideTooltip()}},h=o.selectAll("path").data(f.features);h.enter().append("path").attr("d",c).classed("geo",!0).attr("id",function(t){return t.properties.GEO_ID}).attr("vector-effect","non-scaling-stroke"),h.on("mouseover",a).on("mouseout",u),h.style("fill",i)},y.createSVGContainer=function(){r=d3.select(i),a=r.selectAll(".cv-choropleth").data([n]),a.enter().append("div").classed("cv-choropleth",!0),a.style("width",x[0]+"px").style("height",x[1]+"px");var t,e,o=1,h=1.4*Math.min(x[0],x[1]);if("states"==l.type||"counties"==l.type)t=x[0]/2*o,e=(x[1]/2+w.left)*o,u=d3.geo.albersUsa().scale(h).translate([t,e]);else{var d=.06*x[1];t=x[0]/2*o,e=(x[1]/2+w.left+d)*o,u=d3.geo.equirectangular().scale(h).translate([t,e])}c=d3.geo.path().projection(u),s=a.selectAll("svg").data([n]),s.enter().append("svg").attr("width","100%").attr("height","100%"),s.exit().remove();var p=s.selectAll("#plotClip").data([0]);p.enter().append("clipPath").attr("id","plotClip").append("rect"),p.select("rect").attr("x",w.left).attr("y",w.top).attr("width",x[0]-w.left-w.right).attr("height",x[1]-w.top-w.bottom);var f=s.selectAll(".zoom-container").data([n]);f.enter().append("g").classed("zoom-container",!0).attr("clip-path","url(#plotClip)");var g=f.selectAll(".zoom-container-bg").data([n]);g.enter().append("rect").classed("zoom-container-bg",!0).attr("width","100%").attr("height","100%");var m=f.selectAll(".zoom-container-plot-bg").data([n]);m.enter().append("rect").classed("zoom-container-plot-bg",!0),m.attr("x",w.left).attr("y",w.top).attr("width",x[0]-w.left-w.right).attr("height",x[1]-w.top-w.bottom);var v=f.selectAll(".choro-container").data([n]);v.enter().append("g").classed("choro-container",!0);var _=d3.behavior.zoom(),y=10;return f.call(_.scaleExtent([x[0],x[0]*y]).translate(u.translate()).scale(u.scale()).on("zoom",function(){if(d3.event){var n=d3.event.translate,i=_.scale()/h,r=n[0]-t-x[0]/2*(i-1),a=n[1]-e-x[1]/2*(i-1),o=.8,l=.8,u=x[0]*i*o,c=-u,d=x[1]*i*l,p=-d;r=Math.min(r,u),r=Math.max(r,c),a=Math.min(a,d),a=Math.max(a,p),s.selectAll(".choro-container").attr("transform","translate("+r+", "+a+") scale("+i+")")}})),v},y.data=function(t){return arguments.length?(n=t,y):n},y.parent=function(t){return arguments.length?(i=t,y):i},y.options=function(t){return arguments.length?(l=t,y):l},y}}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.core||{},i=(t.dv||{},t.d3||{}),r=Object.create(n);r.init=function(t){return this._type="choropleth",t=t||{},this._initDefaultOptions(),this.setOptions(t),this._initChoropleth(),this},r._initDefaultOptions=function(){var t={type:"states",geoJson:null,fidelity:"high",color:"sunnyDay",title:"",metric:""};return Object.getPrototypeOf(r)._initDefaultOptions.call(this,t)},r.render=function(){this._configure(),this._choro.layout()},r._initChoropleth=function(){this._choro=i.choropleth()},r._configure=function(){this._choro.data(this._options.data).parent(this._options.parent).options(this._options)},t.cloudViz.choropleth=e.util.createConstructor(r)}(this),function(t){"use strict";var e=t.cloudViz,n=t.dv,i=e.util.namespace("cloudViz.dataAdapter.standard"),r={};r._isDataValid=!1,r.process=function(t,n){this._options=t,this.l10n=e.util.deepExtend({},e.localeDefinition(t.locale),t.l10n||{}),"data"in n&&(this._isDataValid=this._validateData(t.data))},r.dateGranularity=function(){var t=this._options,e=t.data,n=e[t.mappings.x];if(!n||!n.length)return"*";var i=Math.min.apply(Math,n),r=Math.max.apply(Math,n),a=r-i,o=a/n.length;return this.getTimeGranularity(o).gran},r.getTimeGranularity=function(t){var e,n;return(n=1e3)>=t?e="second":(n=6e4)>=t?e="minute":(n=36e5)>=t?e="hour":(n=864e5)>=t?e="day":(n=6048e5)>=t?e="week":(n=26784e5)>=t?e="month":(e="year",n=31536e6),{gran:e,divisor:n}},r._getYTitleFromLabels=function(t){var e=n.util.uniq(t);return e&&1===e.length?e[0]:null},r.data=function(){return this._options.data},r.mappings=function(){return this._options.mappings},r.formats=function(){return this._options.formats},r.xAxisTitle=function(){return null},r.yAxisTitle=function(){return null},r.isDataValid=function(){return this._isDataValid},r._validateData=function(t){var e;if(!t)return!1;for(e in t)if(!t[e].length)return!1;return!0},i.baseObj=r,i.base=e.util.createConstructor(r)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.baseObj);i.process=function(t,e){Object.getPrototypeOf(i).process.apply(this,arguments),t.mappings&&("data"in e||"mappings"in e)&&this.isDataValid()&&(this._uniqueFillValues=this._processUniqueFillValues(t.data,t.mappings),this._uniqueFillExtents=this._processUniqueFillExtents(t.data,t.mappings,this._uniqueFillValues))},i.isOvertime=function(){return!1},i.formats=function(){return{y:"decimal"}},i.uniqueFillValues=function(){return this._uniqueFillValues},i.uniqueFillExtents=function(){return this._uniqueFillExtents},i.getUniqueFillExtent=function(t){var e=this._uniqueFillValues[t];return e?this._uniqueFillExtents[e]:null},i.getUniqueFillExtentByFill=function(t){return this._uniqueFillExtents[t]},i.dateGranularity=function(){return null},i._processUniqueFillValues=function(t,e){var n=t[e.label];return n?dv.util.uniq(n):[]},i._processUniqueFillExtents=function(t,e){var n=t[e.label],i=t[e.y],r={};return i.map(function(t,e){var i=n[e];isFinite(t)&&null!==t&&(r[i]||(r[i]=[t,t]),r[i][0]=Math.min(t,r[i][0]),r[i][1]=Math.max(t,r[i][1]))}),r},n.barObj=i,n.bar=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.baseObj);i.process=function(t,e){Object.getPrototypeOf(i).process.apply(this,arguments),t.mappings&&("data"in e||"mappings"in e)&&this.isDataValid()&&(this._forceZero=t._forceZero,this._uniqueStrokeValues=this._processUniqueStrokeValues(t.data,t.mappings),this._uniqueStrokeExtents=this._processUniqueStrokeExtents(t.data,t.mappings))},i.yAxisTitle=function(){return this._getYTitleFromLabels(this.data().label)},i.isOvertime=function(){return!0},i.formats=function(){return{x:null,y:{0:null},size:null}},i.uniqueStrokeValues=function(){return this._uniqueStrokeValues},i.uniqueStrokeExtents=function(){return this._uniqueStrokeExtents},i.getUniqueStrokeExtent=function(t){var e=this._uniqueStrokeValues[t];return e?this._uniqueStrokeExtents[e]:null},i.getUniqueStrokeExtentByStroke=function(t){return this._uniqueStrokeExtents[t]},i._processUniqueStrokeValues=function(t,e){var n=t[e.stroke];return n?dv.util.uniq(n):[]},i._processUniqueStrokeExtents=function(t,e){var n=t[e.stroke],i=t[e.y],r={};return i.map(function(t,e){var i=n[e];isFinite(t)&&null!==t&&(r[i]||(r[i]=[t,t]),r[i][0]=Math.min(t,r[i][0]),r[i][1]=Math.max(t,r[i][1]))}),r},n.lineObj=i,n.line=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.baseObj);i.sizeMetricName=function(){return null},i.formats=function(){return{x:null,y:null,size:null}},n.pointObj=i,n.point=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.baseObj);i.process=function(t,e){if(Object.getPrototypeOf(i).process.apply(this,arguments),"data"in e||this.isDataValid()){var n=Object.create(t),r=JSON.parse(JSON.stringify(t.data));r.nodesById=[],r.nodes.map(function(t,e){return t._pid=e,r.nodesById[e]=t,t}),r.links=[],r.linksById=[];var a,o,s,l,u,c=this;r.paths=r.paths.filter(function(t){return t.values instanceof Array||(t.values=Array.apply(null,Array(t.nodes.length-1)).map(function(){return t.values})),t.values.some(function(t){return 0>=t})?!1:(t.nodes.map(function(t){return null!==t?r.nodes[t]._pid:null}),!0)}),r.paths.forEach(function(t,e){t.nodes.forEach(function(n,i){return i?(a=t.nodes[i-1],o=n,i===t.nodes.length-1&&null!==o&&(r.nodesById[o].isPathEnd=!0,r.nodesById[o].isPathStart&&(r.nodesById[o].isPivot=!0)),s=t.values[i-1],l=c._generateLinkId(a,o),(u=r.linksById[l])?(u.value+=s,u.paths.push(e)):(u={source:a,target:o,value:s,paths:[e]},r.linksById[l]=u,r.links.push(u)),void 0):(a=t.nodes[i],null!==a&&(r.nodesById[a].isPathStart=!0,r.nodesById[a].isPathEnd&&(r.nodesById[a].isPivot=!0)),void 0)})}),n.data=r,this._processedOptions=n}},i.data=function(){return this._processedOptions.data},i.nodeKey=function(){return function(t,e){return e}},i.linkKey=function(){return function(t,e){return e}},i.pathingTitle=function(){return""},i.getPathEnd=function(){return null},i.getPathDirection=function(){return 0},i.activePathsTitle=function(t){return t&&t.length?"Paths":""},i._validateData=function(t){return t?t.nodes&&t.paths?t.nodes.length?!0:!1:!1:!1},i._generateLinkId=function(t,e){return t+"-"+e},i._sortPaths=function(t,e){var n=this.data();return function(i,r){function a(t,e,o){var s=t+o,l=e+o,u=i.nodes.length>s&&s>=0?i.nodes[s]:-1,c=r.nodes.length>l&&l>=0?r.nodes[l]:-1;if(-1!==u&&null!==u&&(u=n.nodes.indexOf(n.nodesById[u])),-1!==c&&null!==c&&(c=n.nodes.indexOf(n.nodesById[c])),null===u&&null===c)return 0;if(null===u)return o>0?1:-1;if(null===c)return o>0?-1:1;if(-1===u&&-1===c)return 0;if(-1===u)return 1;if(-1===c)return-1;var h=u-c;return 0!==h?h:a(s,l,o)}var o=i.nodes.indexOf(t._pid),s=r.nodes.indexOf(t._pid),l=a(o,s,e);return 0===l&&(l=a(o,s,-e)),0!==l?l:r.nodes.length-i.nodes.length}},i._generatePathLinks=function(t,e){var n,i,r,a,o,s,l,u,c=this.data(),h=this,d=[];return t&&t.nodes?(t.nodes.forEach(function(p,f,g){f&&(n=t.nodes[f-1],i=p,r=c.nodesById[n]||null,a=c.nodesById[i]||null,o=t.values[f-1],s=null,f>1&&(s=c.linksById[h._generateLinkId(t.nodes[f-2],n)]),l=c.linksById[h._generateLinkId(n,i)],u=o/l.value*l.dy,r&&d.push({dy:u,sy:s?s.ty+s.offset-u:l.sy+l.offset,ty:a?l.sy+l.offset:r.dy-u,source:{x:r.x,y:r.y,dx:0},target:{x:r.x+r.dx,y:r.y},value:o,path:e,pivotStart:r.isPivot}),d.push({dy:u,sy:l.sy+l.offset,ty:l.ty+l.offset,source:r,target:a,value:o,path:e}),f+1===g.length&&a&&d.push({dy:u,sy:l.ty+l.offset,ty:l.ty+l.offset,source:{x:a.x,y:a.y,dx:0},target:{x:a.x+a.dx,y:a.y},value:o,path:e,pivotEnd:a.isPivot}),l.offset+=u)}),d):d},i.nodePaths=function(t){var e=this.data(),n=e.paths.filter(function(e){return-1!==e.nodes.indexOf(t._pid)});return n},i.nodePathData=function(t,e){var n=this.data(),i=this,r=[],a=n.links;return a.forEach(function(t){t.offset=0}),t.sort(i._sortPaths(e,-1)),t.forEach(function(t,n){r=r.concat(i._generatePathLinks(t,n,e))}),r},i.linkPathData=function(t){var e,n=this.data(),i=this,r=n.paths,a=[],o=t.source?t.source:t.target;return n.links.forEach(function(t){t.offset=0}),e=t.paths.map(function(t){return r[t]}),e.sort(i._sortPaths(o,-1)),e.forEach(function(t,e){a=a.concat(i._generatePathLinks(t,e))}),a},i.canExpandNode=function(){return!0},i.canCollapseNode=function(){return!0},i.canPivotNode=function(){return!0},n.pathingObj=i,n.pathing=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs2dv"),i=Object.create(e.dataAdapter.standard.barObj);i.process=function(t,e){if(Object.getPrototypeOf(i).process.apply(this,arguments),"data"in e&&this.isDataValid()){var n=Object.create(t);n.isOvertime=this._isOvertime(n.data),n.yAxisTitle=this._getYAxisTitle(n.data),n.formats={y:this._getYFormats(n.data,n.mappings,this.uniqueFillValues())},n.isOvertime&&(this._mungeData(n),this._mungeMappings(n),n.dateGranularity=this._getTimeGranularity(n.data)),this._processedOptions=n}},i.isOvertime=function(){return this._processedOptions.isOvertime},i.xAxisTitle=function(){return null},i.yAxisTitle=function(){return this._processedOptions.yAxisTitle},i.formats=function(){return this._processedOptions.formats},i.dateGranularity=function(){return this._processedOptions.dateGranularity},i.data=function(){return this._processedOptions.data},i.mappings=function(){return this._processedOptions.mappings},i._isOvertime=function(t){var e=t.date,n=t.metric&&t.metric.some(function(t){return t&&t.date_ref&&t.date_ref.length>1});return e&&e.length&&n},i._getYAxisTitle=function(t){return this._getYTitleFromLabels(t.label)},i._mungeData=function(t){var e,n=Object.create(t.data),i=n.cell.length,r=null,a=null;for(n.group=[],e=0;i>e;++e)a=r,r=n.cell[e],n.group[e]=n.series[e],a&&"incomplete"===r.status&&"incomplete"!==a.status&&(n.group[e]+="::incomplete::");t.data=n},i._mungeMappings=function(t){var e=Object.create(t.mappings);e.x="date",e.group="group",e.label="series",t.mappings=e},i._getTimeGranularity=function(t){return t.metric[0].date_range.gran},i._getYFormats=function(t,e,n){var i={};if(t&&t.metric)for(var r=t.metric.length,a=0;r>a;a++){var o=t.metric[a],s=t[e.label],l=s&&n[1]===s[a]?1:0;i[l]=o.type}return i},n.bar=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs2dv"),i=Object.create(e.dataAdapter.standard.lineObj);i.process=function(t,e){if(Object.getPrototypeOf(i).process.apply(this,arguments),("data"in e||"position"in e)&&this.isDataValid()){var n=Object.create(t);n.formats={x:null,y:null,size:null},this._processTrendOrMultiMetric(n),this._distinguishIncompleteData(n),this._processedOptions=n}},i.data=function(){return this._processedOptions.data},i.mappings=function(){return this._processedOptions.mappings},i.formats=function(){return this._processedOptions.formats},i.xAxisTitle=function(){return this._processedOptions.xAxisTitle},i.yAxisTitle=function(){return this._processedOptions.yAxisTitle},i.isOvertime=function(){return this._processedOptions.isOvertime},i.dateGranularity=function(){return this._processedOptions.dateGranularity},i._multiMetricLine=function(t){var e,n,i=t.data,r=Object.create(t.mappings),a={series:[]},o=[],s=[],l=i.label.length;for(e=0;l>e;++e)n=i.label[e],a[n]||(o.push(n),i.metric&&i.metric.length?s.push(i.metric[e].type):s.push(null),a[n]=[]),a[n].push(i.value[e]),a.series[a[n].length-1]=i.category[e];if(!(2>o.length)){r.x=o[0],r.y=o[1];var u={x:s[0],y:{0:s[1]}};if(r.fill="series",r.stroke="series",o.length>2&&(r.size=o[2],u.size=s[2]),i.groups&&i.groups.length&&i.groups[0].length){var c,h,d=i.groups.length,p=[];for(c=0;d>c;++c)h=i.groups[c],p[c]=h.join("-");a.facet_group=p,r.fill="facet_group",r.stroke="facet_group",r.group="facet_group"}t.mappings=r,t.data=a,t.formats=u,t.xAxisTitle=o[0],t.yAxisTitle=o[1],t.dateGranularity="*"}},i._processTrendOrMultiMetric=function(t){var e=t.data;t.isOvertime=+e.date[0]!==+e.date[e.date.length-1],t.isOvertime?(t.xAxisTitle=void 0,t.yAxisTitle=this._getYTitleFromLabels(e.label),t.formats={y:this._getYFormats(t.data,t.mappings,this.uniqueStrokeValues())},t.dateGranularity=e.metric[0].date_range.gran):(this._multiMetricLine(t),t.formats||(t.formats={y:this._getYFormats(t.data,t.mappings,this.uniqueStrokeValues())}))},i._distinguishIncompleteData=function(t){var e=t.data;if("stack"!==t.position&&"fill"!==t.position&&e&&e.cell&&e.cell.length){var n;t.data=e=Object.create(e),t.mappings=n=Object.create(t.mappings);var i,r,a=e.cell.length,o=null,s=null,l=!1;for(e.rsgroup=e.rsgroup||e.group||[],i=0;a>i;++i){if(s=o,o=e.cell[i],e.rsgroup[i]=e.rsgroup[i]||e.series[i],l=e.rsgroup[i].indexOf("::incomplete::")>=0,s&&"incomplete"===o.status&&"incomplete"!==s.status&&!l){for(r in e)e[r].splice(i,0,e[r][i-1]);e.rsgroup[i]+="::incomplete::",++a,++i}e.rsgroup[i]+="incomplete"!==o.status||l?"":"::incomplete::"}n.group="rsgroup"}},i._getYFormats=function(t,e,n){var i={};if(t&&t.metric)for(var r=t.metric.length,a=0;r>a;a++){var o=t.metric[a],s=t[e.stroke],l=s&&n[1]===s[a]?1:0;i[l]=o.type}return i},n.line=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs2dv"),i=Object.create(e.dataAdapter.standard.pointObj);i.process=function(t,e){if(Object.getPrototypeOf(i).process.apply(this,arguments),"data"in e&&this.isDataValid()){var n,r,a=this._processedOptions=Object.create(t),o=t.data,s={series:[]},l=[],u=[],c=o.label.length;for(n=0;c>n;++n)r=o.label[n],s[r]||(l.push(r),o.metric&&o.metric.length?u.push(o.metric[n].type):u.push(null),s[r]=[]),s[r].push(o.value[n]),s.series[s[r].length-1]=o.category[n];var h={x:l[0],y:l[1]},d={x:u[0],y:u[1]};if(o.groups&&o.groups.length&&o.groups[0].length){var p,f,g=o.groups.length,m=[];for(p=0;g>p;++p)f=o.groups[p],m[p]=f.join("-");s.group=m,h.fill="group"}else h.fill="series";l.length>2&&(h.size=l[2],d.size=u[2],a.sizeMetricName=l[2]),a.data=s,a.mappings=h,a.formats=d,a.xAxisTitle=l[0],a.yAxisTitle=l[1]}},i.data=function(){return this._processedOptions.data},i.mappings=function(){return this._processedOptions.mappings},i.formats=function(){return this._processedOptions.formats},i.xAxisTitle=function(){return this._processedOptions.xAxisTitle},i.yAxisTitle=function(){return this._processedOptions.yAxisTitle},i.sizeMetricName=function(){return this._processedOptions.sizeMetricName},n.point=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs2dv"),i=Object.create(e.dataAdapter.standard.pathingObj),r=4;i.process=function(t,e){function n(t){return"E"===t}function r(t){return"X"===t}if("data"in e||this.isDataValid()){var a,o,s,l,u,c,h,d,p,f,g,m=Object.create(t),v=m.data,_={},y=_.nodes=[],x=_.paths=[],b={},A=0;for(o in v.filters)if(a=v.filters[o],s=this._getFilterId(a)){if(l=a.info&&a.info.name||"",u=this._getFilterChild(a),c=u&&u.op||null,c&&"previous"!==c&&"next"!==c&&(u=c=null),h=u&&u.val?[].concat(u.val):[],f=0,"previous"===c){if(h.some(n)){var k="E_0";b[k]||(d={label:"Entry",id:k,column:f,index:y.length,filters:[]},y[y.length]=d,b[k]=d)}f=h.length}if("next"===c){if(h.some(r)){var P="X_0";b[P]||(d={label:"Exit",id:P,column:f,index:y.length,filters:[]},y[y.length]=d,b[P]=d)}f=0-h.length}if(p=s+"_"+f,b[p]){b[p].filters.push(a);continue}if(g="0"==s+""&&("Exit"==l+""||"Entry"==l+""))continue;if("0"==s+"")continue;d={label:l,id:p,column:f,index:y.length,filters:[a]},y[y.length]=d,A=Math.min(A,f),b[p]=d}if(0!==A)for(var S in y)d=y[S],d.column-=A;var w,M,T,O,E,D,L,F,z,V,C,N,R;for(E=0,D=v.metrics.length;D>E;++E)for(w=v.metrics[E],M=w.filter_ref,T=w.date_ref,L=0,F=M.length;F>L;++L)for(o=M[L],a=v.filters[o],z=0,V=T.length;V>z;++z)O=T[z],C=v.dates[O],N=v.data[o][O][E],"invalid"!==N.status&&((d=this._getSingleNode(a,b))?d.total=+N.val:(R=this._createPath(a,b),R&&R.length&&(x[x.length]={nodes:R,values:+N.val||0})));x.sort(function(t,e){return e.nodes.length-t.nodes.length});var I,B,G,H,j,q;for(I=0,B=x.length;B>I;++I)for(j=x[I],G=0,H=x.length;H>G;++G)I!==G&&(q=x[G],q.nodes.length!==j.nodes.length&&-1!==this._getPathString(j.nodes).indexOf(this._getPathString(q.nodes))&&(q.values-=j.values));_.paths=x=x.filter(function(t){return t.values}),m.data=_;var Y=t.data.metrics;m.pathingTitle=Y&&Y.length&&Y[0].name,Object.getPrototypeOf(i).process.call(this,m,e)}},i.nodeKey=function(){return function(t){return t.id}},i.linkKey=function(){return function(t){return(t.source?t.source.id:"null")+"-"+(t.target?t.target.id:"null")}},i.pathingTitle=function(){return this._processedOptions.pathingTitle},i.getPathEnd=function(t){function e(t){return t&&(t.isPivot||"E_0"===t.id||"X_0"===t.id)}if(!t||!t.nodes||!t.nodes.length)return null;if(1===t.nodes.length)return t.nodes[0];var n=t.nodes,i=this._processedOptions.data,r=i.nodesById,a=r[n[0]],o=r[n[n.length-1]];return e(a)?a:e(o)?o:null},i.getPathDirection=function(t){var e=this.getPathEnd(t);return e?e._pid===t.nodes[0]?1:-1:0},i.activePathsTitle=function(t){if(!t||!t.length)return"";var e=this.getPathEnd(t[0]);if(!e)return"Paths";var n="Path"+(t.length>1?"s":"")+(1===this.getPathDirection(t[0])?" from ":" to ");return n+e.label},i._getSingleNode=function(t,e){var n=this._getFilterId(t),i=t.filter_def&&t.filter_def.length&&t.filter_def[0]||null,r=i&&i.op||null,a=this._getFilterChild(t),o=a&&a.op||null;return"select"!==r&&"equals"!==r&&"id"!==r||"previous"===o||"next"===o?!1:e[n+"_0"]},i._getPathString=function(t){return""+t.map(function(t){return null===t?"null":t})},i._createPath=function(t,e){var n=this._getFilterId(t),i=this._getFilterChild(t),r=i&&i.op||null;if(r&&"previous"!==r&&"next"!==r)return[];var a=i&&i.val?[].concat(i.val):[];if(!a.length)return a;var o,s="previous"===i.op,l="0"===n,u=s?0:l?0-a.length+1:0-a.length;s?a.push(n):a.unshift(n);var c=!1,h=a.map(function(t){return"0"===t?null:(o=t+"_"+u,e[o]?(++u,c=!0,+e[o].index):null)});return c?h:[]},i._getFilterId=function(t){return t.info&&(t.info.id||0===t.info.id)?t.info.id+"":null},i._getFilterChild=function(t){var e=t.filter_def&&t.filter_def.length&&t.filter_def[0]||null;return e&&e.child&&e.child.length&&e.child[0]||null},i.canExpandNode=function(t){var e=t.entryLinks.length+t.targetLinks.length,n=t.exitLinks.length+t.sourceLinks.length,i=Math.abs(parseInt(t.id.split("_")[1],10));return i>=r?!1:n&&"E_0"===t.id?!1:e&&"X_0"===t.id?!1:e&&n?!1:!0},i.canCollapseNode=function(t){var e=t.entryLinks.length+t.targetLinks.length,n=t.exitLinks.length+t.sourceLinks.length,i=parseInt(t.id.split("_")[1],10);return"E_0"===t.id||"X_0"===t.id?!1:0===i&&(n||e)||i>0&&n||0>i&&e},i.canPivotNode=function(t){var e=(t.entryLinks.length+t.targetLinks.length,t.exitLinks.length+t.sourceLinks.length,Math.abs(parseInt(t.id.split("_")[1],10)));if(0!==e)return!0;var n=this.data(),i=n.nodes.map(function(t){return parseInt(t.id.split("_")[1],10)}),r=0;return i.some(function(t){return 0===t&&r++,r>1?!0:!1})?!0:!1},n.pathing=e.util.createConstructor(i)}(this),function(t){"use strict";t.cloudViz.localeDefinition("de_DE",{monthAbbreviations:["Jan","Feb","Mrz","Apr","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],weekdayAbbreviations:["So","Mo","Di","Mi","Do","Fr","Sa"],weekdays:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ampm:["AM","PM"]},"calendar"),t.cloudViz.localeDefinition("de_DE",{normalized:"Normalisiert",legendTime:"{value} {time}",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (in {time})"},"labels"),t.cloudViz.localeDefinition("de_DE",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%H Uhr %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%H Uhr %a %e"},fullFormat:{hour:"%H Uhr %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y"}},"dateFormat"),t.cloudViz.localeDefinition("de_DE",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),t.cloudViz.localeDefinition("de_DE",{second:"Sekunde",seconds:"Sekunden",minute:"Minute",minutes:"Minuten",hour:"Stunde",hours:"Stunden",day:"Tag",days:"Tage",week:"Woche",weeks:"Wochen",month:"Monat",months:"Monate",year:"Jahr",years:"Jahre"},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("en_US",{monthAbbreviations:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdayAbbreviations:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ampm:["AM","PM"]},"calendar"),t.cloudViz.localeDefinition("en_US",{normalized:"Normalized",legendTime:"{value} {time}",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (in {time})"},"labels"),t.cloudViz.localeDefinition("en_US",{shortFormat:{hour:"%I %p",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%I %p",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%I %p %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%I %p %a %e"},fullFormat:{hour:"%I %p %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%b %e, %Y"}},"dateFormat"),t.cloudViz.localeDefinition("en_US",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"$",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),t.cloudViz.localeDefinition("en_US",{second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",week:"week",weeks:"weeks",month:"month",months:"months",year:"year",years:"years"},"time")
}(this),function(t){"use strict";t.cloudViz.localeDefinition("es_ES",{monthAbbreviations:["en.","febr.","mzo.","abr.","my.","jun.","jul.","ag.","sept.","oct.","nov.","dic."],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],weekdayAbbreviations:["dom.","lun.","mart.","mirc.","juev.","vier.","sb."],weekdays:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],ampm:["a. m.","p. m."]},"calendar"),t.cloudViz.localeDefinition("es_ES",{normalized:"Normalizado",legendTime:"{value} {time}",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (en {time})"},"labels"),t.cloudViz.localeDefinition("es_ES",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%Hh %a %e"},fullFormat:{hour:"%Hh %I %p",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y"}},"dateFormat"),t.cloudViz.localeDefinition("es_ES",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),t.cloudViz.localeDefinition("es_ES",{second:"segundo",seconds:"segundos",minute:"minuto",minutes:"minutos",hour:"hora",hours:"horas",day:"da",days:"das",week:"semana",weeks:"semanas",month:"mes",months:"meses",year:"ao",years:"aos"},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("fr_FR",{monthAbbreviations:["Janv.","Fvr.","Mars","Avr.","Mai","Juin","Juill.","Aot","Sept.","Oct.","Nov.","Dc."],months:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],weekdayAbbreviations:["Dim.","Lun.","Mar.","Mer.","Jeu.","Ven.","Sam."],weekdays:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],ampm:["AM","PM"]},"calendar"),t.cloudViz.localeDefinition("fr_FR",{normalized:"Normalis",legendTime:"{value} {time}",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (en {time})"},"labels"),t.cloudViz.localeDefinition("fr_FR",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%H h %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%H h %a %e"},fullFormat:{hour:"%H h %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b %Y"}},"dateFormat"),t.cloudViz.localeDefinition("fr_FR",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),t.cloudViz.localeDefinition("fr_FR",{second:"seconde",seconds:"secondes",minute:"minute",minutes:"minutes",hour:"heure",hours:"heures",day:"jour",days:"jours",week:"semaine",weeks:"semaines",month:"mois",months:"mois",year:"anne",years:"annes"},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("ja_JP",{monthAbbreviations:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],months:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],weekdayAbbreviations:["","","","","","","Sat"],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),t.cloudViz.localeDefinition("ja_JP",{normalized:"",legendTime:"{value} {time}",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} ({time})"},"labels"),t.cloudViz.localeDefinition("ja_JP",{shortFormat:{hour:"%p %I ",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I ",day:"%e  (%a)",week:"%e  (%a)",month:"%b",quarter:"%b",year:"%Y",fallback:"%e  (%a)"},longFormat:{hour:"%e  (%a) %p %I ",day:"%e  (%A)",week:"%e  (%A)",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  (%a) %p %I "},fullFormat:{hour:"%e  (%a) %p %I ",day:"%e  (%A)",week:"%e  (%A)",month:"%Y  %B",quarter:"%Y  %B",year:"%Y",fallback:"%Y  %b %e "}},"dateFormat"),t.cloudViz.localeDefinition("ja_JP",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),t.cloudViz.localeDefinition("ja_JP",{second:"",seconds:"",minute:"",minutes:"",hour:"",hours:"",day:"",days:"",week:"",weeks:"",month:"",months:"",year:"",years:""},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("ko_KR",{monthAbbreviations:["1","2","3","4","5","6","7","8","9","10","11","12"],months:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),t.cloudViz.localeDefinition("ko_KR",{normalized:"",legendTime:"{value} {time}",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} ({time} )"},"labels"),t.cloudViz.localeDefinition("ko_KR",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e %a %p %I"},fullFormat:{hour:"%e %a %p %I",day:"%A %e",week:"%A %e",month:"%Y %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e"}},"dateFormat"),t.cloudViz.localeDefinition("ko_KR",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),t.cloudViz.localeDefinition("ko_KR",{second:"",seconds:"",minute:"",minutes:"",hour:"",hours:"",day:"",days:"",week:"",weeks:"",month:"",months:"",year:"",years:""},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("pt_BR",{monthAbbreviations:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],weekdayAbbreviations:["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],weekdays:["Domingo","Segunda-feira","Tera-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sbado"],ampm:["AM","PM"]},"calendar"),t.cloudViz.localeDefinition("pt_BR",{normalized:"Normalizado",legendTime:"{value} {time}",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (s {time})"},"labels"),t.cloudViz.localeDefinition("pt_BR",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%Hh %a %e"},fullFormat:{hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y"}},"dateFormat"),t.cloudViz.localeDefinition("pt_BR",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"R$",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),t.cloudViz.localeDefinition("pt_BR",{second:"segundo",seconds:"segundos",minute:"minuto",minutes:"minutos",hour:"hora",hours:"horas",day:"dia",days:"dias",week:"semana",weeks:"semanas",month:"ms",months:"meses",year:"ano",years:"anos"},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("zh_CN",{monthAbbreviations:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],months:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),t.cloudViz.localeDefinition("zh_CN",{normalized:"",legendTime:"{value} {time}",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} ( {time})"},"labels"),t.cloudViz.localeDefinition("zh_CN",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e  %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  %a %p %I"},fullFormat:{hour:"%e  %a %p %I",day:"%A %e",week:"%A %e",month:"%Y %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e "}},"dateFormat"),t.cloudViz.localeDefinition("zh_CN",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),t.cloudViz.localeDefinition("zh_CN",{second:"",seconds:"",minute:"",minutes:"",hour:"",hours:"",day:"",days:"",week:"",weeks:"",month:"",months:"",year:"",years:""},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("zh_TW",{monthAbbreviations:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],months:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),t.cloudViz.localeDefinition("zh_TW",{normalized:"",legendTime:"{value} {time}",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} ( {time})"},"labels"),t.cloudViz.localeDefinition("zh_TW",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e  %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  %a %p %I"},fullFormat:{hour:"%e  %a %p %I",day:"%A %e",week:"%A %e",month:"%Y %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e "}},"dateFormat"),t.cloudViz.localeDefinition("zh_TW",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"NT$",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),t.cloudViz.localeDefinition("zh_TW",{second:"",seconds:"",minute:"",minutes:"",hour:"",hours:"",day:"",days:"",week:"",weeks:"",month:"",months:"",year:"",years:""},"time")}(this);